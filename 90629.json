{"path":"solr/core/src/test/org/apache/solr/request/SimpleFacetsTest#testRangeFacetingBadRequest().mjava","commits":[{"id":"e135e47842b3fd6a4797b7e4787241b06817efa2","date":1429817254,"type":0,"author":"Tomas Eduardo Fernandez Lobbe","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/request/SimpleFacetsTest#testRangeFacetingBadRequest().mjava","pathOld":"/dev/null","sourceNew":"  public void testRangeFacetingBadRequest() {\n    String field = \"range_facet_l\";\n    ignoreException(\".\");\n    try {\n      for (FacetRangeMethod method:FacetRangeMethod.values()) {\n        assertQEx(\"Test facet.range bad requests\",\n            \"range facet 'end' comes before 'start'\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"45\"\n                    ,\"facet.range.end\",\"43\"\n                    ,\"facet.range.gap\",\"10\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        \n        assertQEx(\"Test facet.range bad requests\",\n            \"range facet infinite loop (is gap negative? did the math overflow?)\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.end\",\"45\"\n                    ,\"facet.range.gap\",\"-1\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        \n        assertQEx(\"Test facet.range bad requests\",\n            \"range facet infinite loop: gap is either zero, or too small relative start/end and caused underflow\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.end\",\"45\"\n                    ,\"facet.range.gap\",\"0\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        \n        assertQEx(\"Test facet.range bad requests\",\n            \"Missing required parameter\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.end\",\"45\"\n                    ,\"facet.range.gap\",\"5\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        assertQEx(\"Test facet.range bad requests\",\n            \"Missing required parameter\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.gap\",\"5\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        assertQEx(\"Test facet.range bad requests\",\n            \"Missing required parameter\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.end\",\"45\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        assertQEx(\"Test facet.range bad requests\",\n            \"Unable to range facet on field\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", \"contains_s1\"\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.end\",\"45\"\n                    ,\"facet.range.gap\",\"5\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        assertQEx(\"Test facet.range bad requests\",\n            \"foo is not a valid method for range faceting\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", \"foo\"\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.end\",\"45\"\n                    ,\"facet.range.gap\",\"5\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n        \n        assertQEx(\"Test facet.range bad requests\",\n            \"foo is not a valid type of for range 'include' information\",\n            req(\"q\", \"*:*\"\n                    ,\"facet\",\"true\"\n                    ,\"facet.range\", field\n                    ,\"facet.range.method\", method.toString()\n                    ,\"facet.range.start\",\"43\"\n                    ,\"facet.range.end\",\"45\"\n                    ,\"facet.range.gap\",\"5\"\n                    ,\"facet.range.include\", \"foo\"\n            ),\n            ErrorCode.BAD_REQUEST\n        );\n      }\n    } finally {\n      resetExceptionIgnores();\n    }\n    \n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"e135e47842b3fd6a4797b7e4787241b06817efa2":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["e135e47842b3fd6a4797b7e4787241b06817efa2"]},"commit2Childs":{"e135e47842b3fd6a4797b7e4787241b06817efa2":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["e135e47842b3fd6a4797b7e4787241b06817efa2"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}