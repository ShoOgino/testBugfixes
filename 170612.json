{"path":"lucene/core/src/test/org/apache/lucene/util/fst/TestBitTableUtil#testPreviousBitSet().mjava","commits":[{"id":"06086b5bd0f0d57858f0675becc58edf1f6b7c11","date":1586421397,"type":1,"author":"Bruno Roustant","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/util/fst/TestBitTableUtil#testPreviousBitSet().mjava","pathOld":"lucene/core/src/test/org/apache/lucene/util/TestBitUtil#testPreviousBitSet().mjava","sourceNew":"  public void testPreviousBitSet() throws IOException {\n    int numIterations = atLeast(1000);\n    for (int i = 0; i < numIterations; i++) {\n      byte[] bits = buildRandomBits();\n      int numBytes = bits.length - 1;\n      int numBits = numBytes * Byte.SIZE;\n\n      // Verify previousBitSet with countBitsUpTo for all bit indexes.\n      for (int bitIndex = 0; bitIndex <= numBits; bitIndex++) {\n        int previousIndex = BitTableUtil.previousBitSet(bitIndex, reader(bits));\n        if (previousIndex == -1) {\n          assertEquals(\"No previous bit set, so expected bit count 0\"\n                  + \" (i=\" + i + \" bitIndex=\" + bitIndex + \")\",\n              0, BitTableUtil.countBitsUpTo(bitIndex, reader(bits)));\n        } else {\n          assertTrue(\"Expected previous bit set at previousIndex=\" + previousIndex\n                  + \" (i=\" + i + \" bitIndex=\" + bitIndex + \")\",\n              BitTableUtil.isBitSet(previousIndex, reader(bits)));\n          int bitCount = BitTableUtil.countBitsUpTo(Math.min(bitIndex + 1, numBits), reader(bits));\n          int expectedPreviousBitCount = bitIndex < numBits && BitTableUtil.isBitSet(bitIndex, reader(bits)) ?\n              bitCount - 1 : bitCount;\n          assertEquals(\"Previous bit set at previousIndex=\" + previousIndex\n                  + \" with current bitCount=\" + bitCount\n                  + \" so expected previousBitCount=\" + expectedPreviousBitCount\n                  + \" (i=\" + i + \" bitIndex=\" + bitIndex + \")\",\n              expectedPreviousBitCount, BitTableUtil.countBitsUpTo(previousIndex + 1, reader(bits)));\n        }\n      }\n    }\n  }\n\n","sourceOld":"  public void testPreviousBitSet() {\n    int numIterations = atLeast(1000);\n    for (int i = 0; i < numIterations; i++) {\n      long[] bits = buildRandomBits();\n      int numLong = bits.length - 1;\n\n      // Verify previousBitSet with countBitsUpTo for all bit indexes.\n      for (int bitIndex = 0; bitIndex <= 64 * numLong; bitIndex++) {\n        int previousIndex = BitUtil.previousBitSet(bits, numLong, bitIndex);\n        if (previousIndex == -1) {\n          assertEquals(\"No previous bit set, so expected bit count 0\"\n                  + \" (i=\" + i + \" bitIndex=\" + bitIndex + \")\",\n              0, BitUtil.countBitsUpTo(bits, numLong, bitIndex));\n        } else {\n          assertTrue(\"Expected previous bit set at previousIndex=\" + previousIndex\n                  + \" (i=\" + i + \" bitIndex=\" + bitIndex + \")\",\n              BitUtil.isBitSet(bits, numLong, previousIndex));\n          int bitCount = BitUtil.countBitsUpTo(bits, numLong, Math.min(bitIndex + 1, numLong * Long.SIZE));\n          int expectedPreviousBitCount = bitIndex < numLong * Long.SIZE && BitUtil.isBitSet(bits, numLong, bitIndex) ?\n              bitCount - 1 : bitCount;\n          assertEquals(\"Previous bit set at previousIndex=\" + previousIndex\n                  + \" with current bitCount=\" + bitCount\n                  + \" so expected previousBitCount=\" + expectedPreviousBitCount\n                  + \" (i=\" + i + \" bitIndex=\" + bitIndex + \")\",\n              expectedPreviousBitCount, BitUtil.countBitsUpTo(bits, numLong, previousIndex + 1));\n        }\n      }\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"06086b5bd0f0d57858f0675becc58edf1f6b7c11":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["06086b5bd0f0d57858f0675becc58edf1f6b7c11"]},"commit2Childs":{"06086b5bd0f0d57858f0675becc58edf1f6b7c11":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["06086b5bd0f0d57858f0675becc58edf1f6b7c11"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}