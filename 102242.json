{"path":"solr/contrib/jaegertracer-configurator/src/test/org/apache/solr/jaeger/TestJaegerConfigurator#testInjected().mjava","commits":[{"id":"cbaf96cfda5422c42955ce34344f0e01839894ea","date":1559675051,"type":0,"author":"Cao Manh Dat","isMerge":false,"pathNew":"solr/contrib/jaegertracer-configurator/src/test/org/apache/solr/jaeger/TestJaegerConfigurator#testInjected().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void testInjected() throws Exception{\n    MiniSolrCloudCluster cluster = new SolrCloudTestCase.Builder(1, createTempDir())\n        .addConfig(\"config\", TEST_PATH().resolve(\"collection1\").resolve(\"conf\"))\n        .withSolrXml(getFile(\"solr/solr.xml\").toPath())\n        .build();\n    CollectionAdminRequest.setClusterProperty(ZkStateReader.SAMPLE_PERCENTAGE, \"100.0\")\n        .process(cluster.getSolrClient());\n    try {\n      TimeOut timeOut = new TimeOut(2, TimeUnit.MINUTES, TimeSource.NANO_TIME);\n      timeOut.waitFor(\"Waiting for GlobalTracer is registered\", () -> GlobalTracer.getTracer() instanceof io.jaegertracing.internal.JaegerTracer);\n    } finally {\n      cluster.shutdown();\n    }\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ed7f61b09e7e9986474fbe512f32484989900680","date":1582789905,"type":3,"author":"Cao Manh Dat","isMerge":false,"pathNew":"solr/contrib/jaegertracer-configurator/src/test/org/apache/solr/jaeger/TestJaegerConfigurator#testInjected().mjava","pathOld":"solr/contrib/jaegertracer-configurator/src/test/org/apache/solr/jaeger/TestJaegerConfigurator#testInjected().mjava","sourceNew":"  @Test\n  public void testInjected() throws Exception{\n    MiniSolrCloudCluster cluster = new SolrCloudTestCase.Builder(2, createTempDir())\n        .addConfig(\"config\", TEST_PATH().resolve(\"collection1\").resolve(\"conf\"))\n        .withSolrXml(getFile(\"solr/solr.xml\").toPath())\n        .build();\n    CollectionAdminRequest.setClusterProperty(ZkStateReader.SAMPLE_PERCENTAGE, \"100.0\")\n        .process(cluster.getSolrClient());\n    try {\n      TimeOut timeOut = new TimeOut(2, TimeUnit.MINUTES, TimeSource.NANO_TIME);\n      timeOut.waitFor(\"Waiting for GlobalTracer is registered\", () -> GlobalTracer.getTracer() instanceof io.jaegertracing.internal.JaegerTracer);\n\n      //TODO add run Jaeger through Docker and verify spans available after run these commands\n      CollectionAdminRequest.createCollection(\"test\", 2, 1).process(cluster.getSolrClient());\n      new UpdateRequest()\n          .add(\"id\", \"1\")\n          .add(\"id\", \"2\")\n          .process(cluster.getSolrClient(), \"test\");\n      cluster.getSolrClient().query(\"test\", new SolrQuery(\"*:*\"));\n    } finally {\n      cluster.shutdown();\n    }\n\n  }\n\n","sourceOld":"  @Test\n  public void testInjected() throws Exception{\n    MiniSolrCloudCluster cluster = new SolrCloudTestCase.Builder(1, createTempDir())\n        .addConfig(\"config\", TEST_PATH().resolve(\"collection1\").resolve(\"conf\"))\n        .withSolrXml(getFile(\"solr/solr.xml\").toPath())\n        .build();\n    CollectionAdminRequest.setClusterProperty(ZkStateReader.SAMPLE_PERCENTAGE, \"100.0\")\n        .process(cluster.getSolrClient());\n    try {\n      TimeOut timeOut = new TimeOut(2, TimeUnit.MINUTES, TimeSource.NANO_TIME);\n      timeOut.waitFor(\"Waiting for GlobalTracer is registered\", () -> GlobalTracer.getTracer() instanceof io.jaegertracing.internal.JaegerTracer);\n    } finally {\n      cluster.shutdown();\n    }\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"ed7f61b09e7e9986474fbe512f32484989900680":["cbaf96cfda5422c42955ce34344f0e01839894ea"],"cbaf96cfda5422c42955ce34344f0e01839894ea":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["ed7f61b09e7e9986474fbe512f32484989900680"]},"commit2Childs":{"ed7f61b09e7e9986474fbe512f32484989900680":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cbaf96cfda5422c42955ce34344f0e01839894ea":["ed7f61b09e7e9986474fbe512f32484989900680"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cbaf96cfda5422c42955ce34344f0e01839894ea"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}