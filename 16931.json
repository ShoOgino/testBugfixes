{"path":"solr/core/src/test/org/apache/solr/update/SolrCmdDistributorTest#testStuckUpdates().mjava","commits":[{"id":"482ca6c86d7073e3c19096bdc74fe0e73da4554a","date":1576010743,"type":0,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/SolrCmdDistributorTest#testStuckUpdates().mjava","pathOld":"/dev/null","sourceNew":"  private void testStuckUpdates() throws Exception {\n    TestInjection.directUpdateLatch = new CountDownLatch(1);\n    List<Node> nodes = new ArrayList<>();\n    ModifiableSolrParams params;\n    try (SolrCmdDistributor cmdDistrib = new SolrCmdDistributor(updateShardHandler)) {\n      for (int i = 0; i < 3; i++) {\n        nodes.clear();\n        for (SolrClient c : clients) {\n          if (random().nextBoolean()) {\n            continue;\n          }\n          HttpSolrClient httpClient = (HttpSolrClient) c;\n          ZkNodeProps nodeProps = new ZkNodeProps(ZkStateReader.BASE_URL_PROP,\n              httpClient.getBaseURL(), ZkStateReader.CORE_NAME_PROP, \"\");\n          StdNode node = new StdNode(new ZkCoreNodeProps(nodeProps));\n          nodes.add(node);\n        }\n        AddUpdateCommand c = new AddUpdateCommand(null);\n        c.solrDoc = sdoc(\"id\", id.incrementAndGet());\n        if (nodes.size() > 0) {\n          params = new ModifiableSolrParams();\n          cmdDistrib.distribAdd(c, nodes, params, false);\n        }\n      }\n      cmdDistrib.blockAndDoRetries();\n    } catch (IOException e) {\n      assertTrue(e.toString(), e.toString().contains(\"processing has stalled\"));\n    } finally {\n      TestInjection.directUpdateLatch.countDown();\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a229cb50768e988c50a2106bdae3a92154f428bf","date":1576051038,"type":0,"author":"Dawid Weiss","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/SolrCmdDistributorTest#testStuckUpdates().mjava","pathOld":"/dev/null","sourceNew":"  private void testStuckUpdates() throws Exception {\n    TestInjection.directUpdateLatch = new CountDownLatch(1);\n    List<Node> nodes = new ArrayList<>();\n    ModifiableSolrParams params;\n    try (SolrCmdDistributor cmdDistrib = new SolrCmdDistributor(updateShardHandler)) {\n      for (int i = 0; i < 3; i++) {\n        nodes.clear();\n        for (SolrClient c : clients) {\n          if (random().nextBoolean()) {\n            continue;\n          }\n          HttpSolrClient httpClient = (HttpSolrClient) c;\n          ZkNodeProps nodeProps = new ZkNodeProps(ZkStateReader.BASE_URL_PROP,\n              httpClient.getBaseURL(), ZkStateReader.CORE_NAME_PROP, \"\");\n          StdNode node = new StdNode(new ZkCoreNodeProps(nodeProps));\n          nodes.add(node);\n        }\n        AddUpdateCommand c = new AddUpdateCommand(null);\n        c.solrDoc = sdoc(\"id\", id.incrementAndGet());\n        if (nodes.size() > 0) {\n          params = new ModifiableSolrParams();\n          cmdDistrib.distribAdd(c, nodes, params, false);\n        }\n      }\n      cmdDistrib.blockAndDoRetries();\n    } catch (IOException e) {\n      assertTrue(e.toString(), e.toString().contains(\"processing has stalled\"));\n    } finally {\n      TestInjection.directUpdateLatch.countDown();\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"482ca6c86d7073e3c19096bdc74fe0e73da4554a":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a229cb50768e988c50a2106bdae3a92154f428bf":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","482ca6c86d7073e3c19096bdc74fe0e73da4554a"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["482ca6c86d7073e3c19096bdc74fe0e73da4554a"]},"commit2Childs":{"482ca6c86d7073e3c19096bdc74fe0e73da4554a":["a229cb50768e988c50a2106bdae3a92154f428bf","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a229cb50768e988c50a2106bdae3a92154f428bf":[],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["482ca6c86d7073e3c19096bdc74fe0e73da4554a","a229cb50768e988c50a2106bdae3a92154f428bf"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["a229cb50768e988c50a2106bdae3a92154f428bf","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}