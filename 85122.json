{"path":"solr/contrib/dataimporthandler/src/test/org/apache/solr/handler/dataimport/AbstractSqlEntityProcessorTestCase#complexTransform(int,int).mjava","commits":[{"id":"b4804614e0358954d5d9f51128fcf3cd79e6e25b","date":1352831451,"type":1,"author":"James Dyer","isMerge":false,"pathNew":"solr/contrib/dataimporthandler/src/test/org/apache/solr/handler/dataimport/AbstractSqlEntityProcessorTestCase#complexTransform(int,int).mjava","pathOld":"solr/contrib/dataimporthandler/src/test/org/apache/solr/handler/dataimport/AbstractDIHJdbcTestCase#complexTransform(int,int).mjava","sourceNew":"  /**\n   * A delta update will not clean up documents added by a transformer even if\n   * the parent document that the transformer used to base the new documents\n   * were deleted\n   */\n  protected void complexTransform(int numToExpect, int numDeleted)\n      throws Exception {\n    rootTransformerName = \"TripleThreatTransformer\";\n    h.query(\"/dataimport\", generateRequest());\n    int totalDocs = ((totalPeople() * 3) + (numDeleted * 2));\n    int totalAddedDocs = (totalPeople() + numDeleted);\n    assertQ(\n        req(\"q\", \"*:*\", \"rows\", \"\" + (totalPeople() * 3), \"sort\", \"id asc\"),\n        \"//*[@numFound='\" + totalDocs + \"']\");\n    assertQ(req(\"id:TripleThreat-1-*\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    assertQ(req(\"id:TripleThreat-2-*\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    if (personNameExists(\"Michael\") && countryCodeExists(\"NR\")) {\n      assertQ(\n          \"Michael and NR are assured to be in the database.  Therefore the transformer should have added leahciM and RN on the same document as id:TripleThreat-1-3\",\n          req(\"+id:TripleThreat-1-3 +NAME_mult_s:Michael +NAME_mult_s:leahciM  +COUNTRY_CODES_mult_s:NR +COUNTRY_CODES_mult_s:RN\"),\n          \"//*[@numFound='1']\");\n    }\n    assertQ(req(\"AddAColumn_s:Added\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    Assert.assertTrue(\"Expecting \" + numToExpect\n        + \" database calls, but DIH reported \" + totalDatabaseRequests(),\n        totalDatabaseRequests() == numToExpect);\n  }\n\n","sourceOld":"  /**\n   * A delta update will not clean up documents added by a transformer\n   * even if the parent document that the transformer used to base the new documents\n   * were deleted   \n   */\n  protected void complexTransform(int numToExpect, int numDeleted) throws Exception {\n    rootTransformerName = \"TripleThreatTransformer\";\n    h.query(\"/dataimport\", generateRequest());\n    int totalDocs = ((totalPeople() * 3) + (numDeleted * 2));\n    int totalAddedDocs = (totalPeople() + numDeleted);\n    assertQ(req(\"q\", \"*:*\", \"rows\", \"\" + (totalPeople() * 3), \"sort\", \"id asc\"), \"//*[@numFound='\" + totalDocs + \"']\");\n    assertQ(req(\"id:TripleThreat-1-*\"), \"//*[@numFound='\" + totalAddedDocs + \"']\");\n    assertQ(req(\"id:TripleThreat-2-*\"), \"//*[@numFound='\" + totalAddedDocs + \"']\");\n    if(personNameExists(\"Michael\") && countryCodeExists(\"NR\"))\n    {\n      assertQ(\n          \"Michael and NR are assured to be in the database.  Therefore the transformer should have added leahciM and RN on the same document as id:TripleThreat-1-3\",\n          req(\"+id:TripleThreat-1-3 +NAME_mult_s:Michael +NAME_mult_s:leahciM  +COUNTRY_CODES_mult_s:NR +COUNTRY_CODES_mult_s:RN\"),\n          \"//*[@numFound='1']\");\n    }\n    assertQ(req(\"AddAColumn_s:Added\"), \"//*[@numFound='\" + totalAddedDocs + \"']\");\n    Assert.assertTrue(\"Expecting \" + numToExpect\n        + \" database calls, but DIH reported \" + totalDatabaseRequests(),\n        totalDatabaseRequests() == numToExpect);\n  }  \n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"407687e67faf6e1f02a211ca078d8e3eed631027","date":1355157407,"type":0,"author":"Robert Muir","isMerge":true,"pathNew":"solr/contrib/dataimporthandler/src/test/org/apache/solr/handler/dataimport/AbstractSqlEntityProcessorTestCase#complexTransform(int,int).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * A delta update will not clean up documents added by a transformer even if\n   * the parent document that the transformer used to base the new documents\n   * were deleted\n   */\n  protected void complexTransform(int numToExpect, int numDeleted)\n      throws Exception {\n    rootTransformerName = \"TripleThreatTransformer\";\n    h.query(\"/dataimport\", generateRequest());\n    int totalDocs = ((totalPeople() * 3) + (numDeleted * 2));\n    int totalAddedDocs = (totalPeople() + numDeleted);\n    assertQ(\n        req(\"q\", \"*:*\", \"rows\", \"\" + (totalPeople() * 3), \"sort\", \"id asc\"),\n        \"//*[@numFound='\" + totalDocs + \"']\");\n    assertQ(req(\"id:TripleThreat-1-*\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    assertQ(req(\"id:TripleThreat-2-*\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    if (personNameExists(\"Michael\") && countryCodeExists(\"NR\")) {\n      assertQ(\n          \"Michael and NR are assured to be in the database.  Therefore the transformer should have added leahciM and RN on the same document as id:TripleThreat-1-3\",\n          req(\"+id:TripleThreat-1-3 +NAME_mult_s:Michael +NAME_mult_s:leahciM  +COUNTRY_CODES_mult_s:NR +COUNTRY_CODES_mult_s:RN\"),\n          \"//*[@numFound='1']\");\n    }\n    assertQ(req(\"AddAColumn_s:Added\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    Assert.assertTrue(\"Expecting \" + numToExpect\n        + \" database calls, but DIH reported \" + totalDatabaseRequests(),\n        totalDatabaseRequests() == numToExpect);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"d2c8f5c46c2501b61e2f55eb7ee59e6c5372290b","date":1598712724,"type":4,"author":"Alexandre Rafalovitch","isMerge":false,"pathNew":"/dev/null","pathOld":"solr/contrib/dataimporthandler/src/test/org/apache/solr/handler/dataimport/AbstractSqlEntityProcessorTestCase#complexTransform(int,int).mjava","sourceNew":null,"sourceOld":"  /**\n   * A delta update will not clean up documents added by a transformer even if\n   * the parent document that the transformer used to base the new documents\n   * were deleted\n   */\n  protected void complexTransform(int numToExpect, int numDeleted)\n      throws Exception {\n    rootTransformerName = \"TripleThreatTransformer\";\n    h.query(\"/dataimport\", generateRequest());\n    int totalDocs = ((totalPeople() * 3) + (numDeleted * 2));\n    int totalAddedDocs = (totalPeople() + numDeleted);\n    assertQ(\n        req(\"q\", \"*:*\", \"rows\", \"\" + (totalPeople() * 3), \"sort\", \"id asc\"),\n        \"//*[@numFound='\" + totalDocs + \"']\");\n    assertQ(req(\"id:TripleThreat-1-*\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    assertQ(req(\"id:TripleThreat-2-*\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    if (personNameExists(\"Michael\") && countryCodeExists(\"NR\")) {\n      assertQ(\n          \"Michael and NR are assured to be in the database.  Therefore the transformer should have added leahciM and RN on the same document as id:TripleThreat-1-3\",\n          req(\"+id:TripleThreat-1-3 +NAME_mult_s:Michael +NAME_mult_s:leahciM  +COUNTRY_CODES_mult_s:NR +COUNTRY_CODES_mult_s:RN\"),\n          \"//*[@numFound='1']\");\n    }\n    assertQ(req(\"AddAColumn_s:Added\"), \"//*[@numFound='\" + totalAddedDocs\n        + \"']\");\n    Assert.assertTrue(\"Expecting \" + numToExpect\n        + \" database calls, but DIH reported \" + totalDatabaseRequests(),\n        totalDatabaseRequests() == numToExpect);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"b4804614e0358954d5d9f51128fcf3cd79e6e25b":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"d2c8f5c46c2501b61e2f55eb7ee59e6c5372290b":["b4804614e0358954d5d9f51128fcf3cd79e6e25b"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"407687e67faf6e1f02a211ca078d8e3eed631027":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","b4804614e0358954d5d9f51128fcf3cd79e6e25b"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["d2c8f5c46c2501b61e2f55eb7ee59e6c5372290b"]},"commit2Childs":{"b4804614e0358954d5d9f51128fcf3cd79e6e25b":["d2c8f5c46c2501b61e2f55eb7ee59e6c5372290b","407687e67faf6e1f02a211ca078d8e3eed631027"],"d2c8f5c46c2501b61e2f55eb7ee59e6c5372290b":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b4804614e0358954d5d9f51128fcf3cd79e6e25b","407687e67faf6e1f02a211ca078d8e3eed631027"],"407687e67faf6e1f02a211ca078d8e3eed631027":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["407687e67faf6e1f02a211ca078d8e3eed631027","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}