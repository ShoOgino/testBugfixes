{"path":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","commits":[{"id":"7d05e957cb88bdd266409dea8cc4cbffb365204f","date":1588179853,"type":0,"author":"Ishan Chattopadhyaya","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc.getAuthenticationPlugin() != null) info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n    if (cc.getAuthorizationPlugin() != null) info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      AuthorizationPlugin auth = cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPlugin rbap = (RuleBasedAuthorizationPlugin) auth;\n        Set<String> roles = rbap.getRoles(username);\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"cda76c4597958ab6acd34f68ec9ec5900847d002","date":1588260848,"type":3,"author":"Ishan Chattopadhyaya","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","pathOld":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","sourceNew":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc != null) {\n      if (cc.getAuthenticationPlugin() != null) {\n        info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n      }\n      if (cc.getAuthorizationPlugin() != null) {\n        info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n      }\n    }\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      AuthorizationPlugin auth = cc==null? null: cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPlugin rbap = (RuleBasedAuthorizationPlugin) auth;\n        Set<String> roles = rbap.getRoles(username);\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","sourceOld":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc.getAuthenticationPlugin() != null) info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n    if (cc.getAuthorizationPlugin() != null) info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      AuthorizationPlugin auth = cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPlugin rbap = (RuleBasedAuthorizationPlugin) auth;\n        Set<String> roles = rbap.getRoles(username);\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"8076096f334b0665d0a69a63ee98ac09baad402b","date":1589405373,"type":3,"author":"Jan HÃ¸ydahl","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","pathOld":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","sourceNew":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc != null) {\n      if (cc.getAuthenticationPlugin() != null) {\n        info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n      }\n      if (cc.getAuthorizationPlugin() != null) {\n        info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n      }\n    }\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      AuthorizationPlugin auth = cc==null? null: cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPluginBase rbap = (RuleBasedAuthorizationPluginBase) auth;\n        Set<String> roles = rbap.getUserRoles(req.getUserPrincipal());\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","sourceOld":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc != null) {\n      if (cc.getAuthenticationPlugin() != null) {\n        info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n      }\n      if (cc.getAuthorizationPlugin() != null) {\n        info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n      }\n    }\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      AuthorizationPlugin auth = cc==null? null: cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPlugin rbap = (RuleBasedAuthorizationPlugin) auth;\n        Set<String> roles = rbap.getRoles(username);\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ba055e19afc289adcb5bedaf68513793a7254012","date":1591268575,"type":3,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","pathOld":"solr/core/src/java/org/apache/solr/handler/admin/SystemInfoHandler#getSecurityInfo(SolrQueryRequest).mjava","sourceNew":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc != null) {\n      if (cc.getAuthenticationPlugin() != null) {\n        info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n      }\n      if (cc.getAuthorizationPlugin() != null) {\n        info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n      }\n    }\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      @SuppressWarnings(\"resource\")\n      AuthorizationPlugin auth = cc==null? null: cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPluginBase rbap = (RuleBasedAuthorizationPluginBase) auth;\n        Set<String> roles = rbap.getUserRoles(req.getUserPrincipal());\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","sourceOld":"  /**\n   * Get Security Info\n   */\n  public SimpleOrderedMap<Object> getSecurityInfo(SolrQueryRequest req)\n  {\n    SimpleOrderedMap<Object> info = new SimpleOrderedMap<>();\n\n    if (cc != null) {\n      if (cc.getAuthenticationPlugin() != null) {\n        info.add(\"authenticationPlugin\", cc.getAuthenticationPlugin().getName());\n      }\n      if (cc.getAuthorizationPlugin() != null) {\n        info.add(\"authorizationPlugin\", cc.getAuthorizationPlugin().getClass().getName());\n      }\n    }\n\n    // User principal\n    String username = null;\n    if (req.getUserPrincipal() != null) {\n      username = req.getUserPrincipal().getName();\n      info.add(\"username\", username);\n\n      // Mapped roles for this principal\n      AuthorizationPlugin auth = cc==null? null: cc.getAuthorizationPlugin();\n      if (auth != null) {\n        RuleBasedAuthorizationPluginBase rbap = (RuleBasedAuthorizationPluginBase) auth;\n        Set<String> roles = rbap.getUserRoles(req.getUserPrincipal());\n        info.add(\"roles\", roles);\n      }\n    }\n\n    return info;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"cda76c4597958ab6acd34f68ec9ec5900847d002":["7d05e957cb88bdd266409dea8cc4cbffb365204f"],"8076096f334b0665d0a69a63ee98ac09baad402b":["cda76c4597958ab6acd34f68ec9ec5900847d002"],"ba055e19afc289adcb5bedaf68513793a7254012":["8076096f334b0665d0a69a63ee98ac09baad402b"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"7d05e957cb88bdd266409dea8cc4cbffb365204f":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["ba055e19afc289adcb5bedaf68513793a7254012"]},"commit2Childs":{"cda76c4597958ab6acd34f68ec9ec5900847d002":["8076096f334b0665d0a69a63ee98ac09baad402b"],"8076096f334b0665d0a69a63ee98ac09baad402b":["ba055e19afc289adcb5bedaf68513793a7254012"],"ba055e19afc289adcb5bedaf68513793a7254012":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["7d05e957cb88bdd266409dea8cc4cbffb365204f"],"7d05e957cb88bdd266409dea8cc4cbffb365204f":["cda76c4597958ab6acd34f68ec9ec5900847d002"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}