{"path":"sandbox/projects/appex/src/java/search/SearchResultFactory#getDocAsObject(Document).mjava","commits":[{"id":"4276f2034ad339f3cdf68f1a01bf9416993afb9c","date":1020873228,"type":0,"author":"Kelvin Tan","isMerge":false,"pathNew":"sandbox/projects/appex/src/java/search/SearchResultFactory#getDocAsObject(Document).mjava","pathOld":"/dev/null","sourceNew":"    /**\n     * <p>\n     * Materializes the object represented by the\n     * {@link org.apache.lucene.document.Document}.\n     * </p>\n     * <p>\n     * Objects which need to be returned via this method (essentially\n     * any object which implements\n     * {@link com.marketingbright.core.services.search.SearchResult},\n     * must either have an associated broker, or a no-arg ctor and\n     * INIT_OBJECT_METHOD with INIT_OBJECT_METHOD_ARGS.\n     * </p>\n     */\n    public static Object getDocAsObject(Document doc) throws Exception\n    {\n        Class clazz = Class.forName(doc.get(DataSource.OBJECT_CLASS));\n        String id = doc.get(DataSource.OBJECT_IDENTIFIER);\n        Object o = null;\n        try\n        {\n            Broker broker = BrokerFactory.getBroker(clazz);\n            // assume it's a two-part compound pk if there's a comma\n            int indexOfComma = id.indexOf(',');\n            if (indexOfComma != -1)\n            {\n                String[] pks = new String[2];\n                pks[0] = id.substring(0, indexOfComma);\n                pks[1] = id.substring(indexOfComma + 1);\n                o = broker.retrieveByPK(pks);\n            }\n            else\n            {\n                o = broker.retrieveByPK(id);\n            }\n        }\n        catch (NoSuchBrokerException nsbe)\n        {\n            /**\n             * Some objects don't have brokers or peers, this offers an\n             * alternative.\n             */\n            o = clazz.newInstance();\n            invokeMethod(o, INIT_OBJECT_METHOD,\n                         INIT_OBJECT_METHOD_ARGS, new Object[]{id});\n        }\n        String searchResultClassname = null;\n        searchResultClassname = doc.get(DataSource.SEARCH_RESULT_CLASSNAME);\n        return generateObject(searchResultClassname,\n                              SEARCH_RESULT_WRAPPER_CTOR_ARGS,\n                              new Object[]{o});\n    }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"f35ba86e9cc568fdc800d780c620749584b1d5bc","date":1051838861,"type":4,"author":"Kelvin Tan","isMerge":false,"pathNew":"/dev/null","pathOld":"sandbox/projects/appex/src/java/search/SearchResultFactory#getDocAsObject(Document).mjava","sourceNew":null,"sourceOld":"    /**\n     * <p>\n     * Materializes the object represented by the\n     * {@link org.apache.lucene.document.Document}.\n     * </p>\n     * <p>\n     * Objects which need to be returned via this method (essentially\n     * any object which implements\n     * {@link com.marketingbright.core.services.search.SearchResult},\n     * must either have an associated broker, or a no-arg ctor and\n     * INIT_OBJECT_METHOD with INIT_OBJECT_METHOD_ARGS.\n     * </p>\n     */\n    public static Object getDocAsObject(Document doc) throws Exception\n    {\n        Class clazz = Class.forName(doc.get(DataSource.OBJECT_CLASS));\n        String id = doc.get(DataSource.OBJECT_IDENTIFIER);\n        Object o = null;\n        try\n        {\n            Broker broker = BrokerFactory.getBroker(clazz);\n            // assume it's a two-part compound pk if there's a comma\n            int indexOfComma = id.indexOf(',');\n            if (indexOfComma != -1)\n            {\n                String[] pks = new String[2];\n                pks[0] = id.substring(0, indexOfComma);\n                pks[1] = id.substring(indexOfComma + 1);\n                o = broker.retrieveByPK(pks);\n            }\n            else\n            {\n                o = broker.retrieveByPK(id);\n            }\n        }\n        catch (NoSuchBrokerException nsbe)\n        {\n            /**\n             * Some objects don't have brokers or peers, this offers an\n             * alternative.\n             */\n            o = clazz.newInstance();\n            invokeMethod(o, INIT_OBJECT_METHOD,\n                         INIT_OBJECT_METHOD_ARGS, new Object[]{id});\n        }\n        String searchResultClassname = null;\n        searchResultClassname = doc.get(DataSource.SEARCH_RESULT_CLASSNAME);\n        return generateObject(searchResultClassname,\n                              SEARCH_RESULT_WRAPPER_CTOR_ARGS,\n                              new Object[]{o});\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"4276f2034ad339f3cdf68f1a01bf9416993afb9c":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"f35ba86e9cc568fdc800d780c620749584b1d5bc":["4276f2034ad339f3cdf68f1a01bf9416993afb9c"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["f35ba86e9cc568fdc800d780c620749584b1d5bc"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["4276f2034ad339f3cdf68f1a01bf9416993afb9c"],"4276f2034ad339f3cdf68f1a01bf9416993afb9c":["f35ba86e9cc568fdc800d780c620749584b1d5bc"],"f35ba86e9cc568fdc800d780c620749584b1d5bc":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}