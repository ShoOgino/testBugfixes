{"path":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestLargeCluster#benchmarkNodeLost().mjava","commits":[{"id":"a00c801e9678a87ab9d8f373daa9d1955a4c4cee","date":1514982555,"type":0,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestLargeCluster#benchmarkNodeLost().mjava","pathOld":"/dev/null","sourceNew":"  //@Test\n  public void benchmarkNodeLost() throws Exception {\n    List<String> results = new ArrayList<>();\n    for (int wait : renard5) {\n      for (int delay : renard5) {\n        SummaryStatistics stat = new SummaryStatistics();\n        for (int i = 0; i < 5; i++) {\n          if (cluster != null) {\n            cluster.close();\n          }\n          setupCluster();\n          setUp();\n          setupTest();\n          long total = doTestNodeLost(wait, delay * 1000, 0);\n          stat.addValue(total);\n        }\n        results.add(String.format(Locale.ROOT, \"%d\\t%d\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\", wait, delay,\n            stat.getMin(), stat.getMax(), stat.getMean(), stat.getVariance(), stat.getStandardDeviation()));\n      }\n    }\n    log.info(\"===== RESULTS ======\");\n    log.info(\"waitFor\\tkillDelay\\tmin\\tmax\\tmean\\tvar\\tstdev\");\n    results.forEach(s -> log.info(s));\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"278895e10265b1174eef1ab0be0cbeba446484a4","date":1515420497,"type":3,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestLargeCluster#benchmarkNodeLost().mjava","pathOld":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestLargeCluster#benchmarkNodeLost().mjava","sourceNew":"  //@Test\n  public void benchmarkNodeLost() throws Exception {\n    List<String> results = new ArrayList<>();\n    for (int wait : renard5x) {\n      for (int delay : renard5x) {\n        SummaryStatistics totalTime = new SummaryStatistics();\n        SummaryStatistics ignoredOurEvents = new SummaryStatistics();\n        SummaryStatistics ignoredOtherEvents = new SummaryStatistics();\n        SummaryStatistics startedOurEvents = new SummaryStatistics();\n        SummaryStatistics startedOtherEvents = new SummaryStatistics();\n        for (int i = 0; i < 5; i++) {\n          if (cluster != null) {\n            cluster.close();\n          }\n          setupCluster();\n          setUp();\n          setupTest();\n          long total = doTestNodeLost(wait, delay * 1000, 0);\n          totalTime.addValue(total);\n          // get event counts\n          Map<String, Map<String, AtomicInteger>> counts = cluster.simGetEventCounts();\n          Map<String, AtomicInteger> map = counts.remove(\"node_lost_trigger\");\n          startedOurEvents.addValue(map.getOrDefault(\"STARTED\", ZERO).get());\n          ignoredOurEvents.addValue(map.getOrDefault(\"IGNORED\", ZERO).get());\n          int otherStarted = 0;\n          int otherIgnored = 0;\n          for (Map<String, AtomicInteger> m : counts.values()) {\n            otherStarted += m.getOrDefault(\"STARTED\", ZERO).get();\n            otherIgnored += m.getOrDefault(\"IGNORED\", ZERO).get();\n          }\n          startedOtherEvents.addValue(otherStarted);\n          ignoredOtherEvents.addValue(otherIgnored);\n        }\n        results.add(String.format(Locale.ROOT, \"%d\\t%d\\t%4.0f\\t%4.0f\\t%4.0f\\t%4.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\",\n            wait, delay, startedOurEvents.getMean(), ignoredOurEvents.getMean(),\n            startedOtherEvents.getMean(), ignoredOtherEvents.getMean(),\n            totalTime.getMin(), totalTime.getMax(), totalTime.getMean(), totalTime.getStandardDeviation(), totalTime.getVariance()));\n      }\n    }\n    log.info(\"===== RESULTS ======\");\n    log.info(\"waitFor\\tdelay\\tSTRT\\tIGN\\toSTRT\\toIGN\\tmin\\tmax\\tmean\\tstdev\\tvar\");\n    results.forEach(s -> log.info(s));\n  }\n\n","sourceOld":"  //@Test\n  public void benchmarkNodeLost() throws Exception {\n    List<String> results = new ArrayList<>();\n    for (int wait : renard5) {\n      for (int delay : renard5) {\n        SummaryStatistics stat = new SummaryStatistics();\n        for (int i = 0; i < 5; i++) {\n          if (cluster != null) {\n            cluster.close();\n          }\n          setupCluster();\n          setUp();\n          setupTest();\n          long total = doTestNodeLost(wait, delay * 1000, 0);\n          stat.addValue(total);\n        }\n        results.add(String.format(Locale.ROOT, \"%d\\t%d\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\", wait, delay,\n            stat.getMin(), stat.getMax(), stat.getMean(), stat.getVariance(), stat.getStandardDeviation()));\n      }\n    }\n    log.info(\"===== RESULTS ======\");\n    log.info(\"waitFor\\tkillDelay\\tmin\\tmax\\tmean\\tvar\\tstdev\");\n    results.forEach(s -> log.info(s));\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"b94236357aaa22b76c10629851fe4e376e0cea82","date":1516710914,"type":0,"author":"Karl Wright","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestLargeCluster#benchmarkNodeLost().mjava","pathOld":"/dev/null","sourceNew":"  //@Test\n  public void benchmarkNodeLost() throws Exception {\n    List<String> results = new ArrayList<>();\n    for (int wait : renard5x) {\n      for (int delay : renard5x) {\n        SummaryStatistics totalTime = new SummaryStatistics();\n        SummaryStatistics ignoredOurEvents = new SummaryStatistics();\n        SummaryStatistics ignoredOtherEvents = new SummaryStatistics();\n        SummaryStatistics startedOurEvents = new SummaryStatistics();\n        SummaryStatistics startedOtherEvents = new SummaryStatistics();\n        for (int i = 0; i < 5; i++) {\n          if (cluster != null) {\n            cluster.close();\n          }\n          setupCluster();\n          setUp();\n          setupTest();\n          long total = doTestNodeLost(wait, delay * 1000, 0);\n          totalTime.addValue(total);\n          // get event counts\n          Map<String, Map<String, AtomicInteger>> counts = cluster.simGetEventCounts();\n          Map<String, AtomicInteger> map = counts.remove(\"node_lost_trigger\");\n          startedOurEvents.addValue(map.getOrDefault(\"STARTED\", ZERO).get());\n          ignoredOurEvents.addValue(map.getOrDefault(\"IGNORED\", ZERO).get());\n          int otherStarted = 0;\n          int otherIgnored = 0;\n          for (Map<String, AtomicInteger> m : counts.values()) {\n            otherStarted += m.getOrDefault(\"STARTED\", ZERO).get();\n            otherIgnored += m.getOrDefault(\"IGNORED\", ZERO).get();\n          }\n          startedOtherEvents.addValue(otherStarted);\n          ignoredOtherEvents.addValue(otherIgnored);\n        }\n        results.add(String.format(Locale.ROOT, \"%d\\t%d\\t%4.0f\\t%4.0f\\t%4.0f\\t%4.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\",\n            wait, delay, startedOurEvents.getMean(), ignoredOurEvents.getMean(),\n            startedOtherEvents.getMean(), ignoredOtherEvents.getMean(),\n            totalTime.getMin(), totalTime.getMax(), totalTime.getMean(), totalTime.getStandardDeviation(), totalTime.getVariance()));\n      }\n    }\n    log.info(\"===== RESULTS ======\");\n    log.info(\"waitFor\\tdelay\\tSTRT\\tIGN\\toSTRT\\toIGN\\tmin\\tmax\\tmean\\tstdev\\tvar\");\n    results.forEach(s -> log.info(s));\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a6a5c1c40529f15b445e6720dfde1967e139bff1","date":1535375643,"type":5,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestSimLargeCluster#benchmarkNodeLost().mjava","pathOld":"solr/core/src/test/org/apache/solr/cloud/autoscaling/sim/TestLargeCluster#benchmarkNodeLost().mjava","sourceNew":"  //@Test\n  public void benchmarkNodeLost() throws Exception {\n    List<String> results = new ArrayList<>();\n    for (int wait : renard5x) {\n      for (int delay : renard5x) {\n        SummaryStatistics totalTime = new SummaryStatistics();\n        SummaryStatistics ignoredOurEvents = new SummaryStatistics();\n        SummaryStatistics ignoredOtherEvents = new SummaryStatistics();\n        SummaryStatistics startedOurEvents = new SummaryStatistics();\n        SummaryStatistics startedOtherEvents = new SummaryStatistics();\n        for (int i = 0; i < 5; i++) {\n          if (cluster != null) {\n            cluster.close();\n          }\n          setupCluster();\n          setUp();\n          setupTest();\n          long total = doTestNodeLost(wait, delay * 1000, 0);\n          totalTime.addValue(total);\n          // get event counts\n          Map<String, Map<String, AtomicInteger>> counts = cluster.simGetEventCounts();\n          Map<String, AtomicInteger> map = counts.remove(\"node_lost_trigger\");\n          startedOurEvents.addValue(map.getOrDefault(\"STARTED\", ZERO).get());\n          ignoredOurEvents.addValue(map.getOrDefault(\"IGNORED\", ZERO).get());\n          int otherStarted = 0;\n          int otherIgnored = 0;\n          for (Map<String, AtomicInteger> m : counts.values()) {\n            otherStarted += m.getOrDefault(\"STARTED\", ZERO).get();\n            otherIgnored += m.getOrDefault(\"IGNORED\", ZERO).get();\n          }\n          startedOtherEvents.addValue(otherStarted);\n          ignoredOtherEvents.addValue(otherIgnored);\n        }\n        results.add(String.format(Locale.ROOT, \"%d\\t%d\\t%4.0f\\t%4.0f\\t%4.0f\\t%4.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\",\n            wait, delay, startedOurEvents.getMean(), ignoredOurEvents.getMean(),\n            startedOtherEvents.getMean(), ignoredOtherEvents.getMean(),\n            totalTime.getMin(), totalTime.getMax(), totalTime.getMean(), totalTime.getStandardDeviation(), totalTime.getVariance()));\n      }\n    }\n    log.info(\"===== RESULTS ======\");\n    log.info(\"waitFor\\tdelay\\tSTRT\\tIGN\\toSTRT\\toIGN\\tmin\\tmax\\tmean\\tstdev\\tvar\");\n    results.forEach(s -> log.info(s));\n  }\n\n","sourceOld":"  //@Test\n  public void benchmarkNodeLost() throws Exception {\n    List<String> results = new ArrayList<>();\n    for (int wait : renard5x) {\n      for (int delay : renard5x) {\n        SummaryStatistics totalTime = new SummaryStatistics();\n        SummaryStatistics ignoredOurEvents = new SummaryStatistics();\n        SummaryStatistics ignoredOtherEvents = new SummaryStatistics();\n        SummaryStatistics startedOurEvents = new SummaryStatistics();\n        SummaryStatistics startedOtherEvents = new SummaryStatistics();\n        for (int i = 0; i < 5; i++) {\n          if (cluster != null) {\n            cluster.close();\n          }\n          setupCluster();\n          setUp();\n          setupTest();\n          long total = doTestNodeLost(wait, delay * 1000, 0);\n          totalTime.addValue(total);\n          // get event counts\n          Map<String, Map<String, AtomicInteger>> counts = cluster.simGetEventCounts();\n          Map<String, AtomicInteger> map = counts.remove(\"node_lost_trigger\");\n          startedOurEvents.addValue(map.getOrDefault(\"STARTED\", ZERO).get());\n          ignoredOurEvents.addValue(map.getOrDefault(\"IGNORED\", ZERO).get());\n          int otherStarted = 0;\n          int otherIgnored = 0;\n          for (Map<String, AtomicInteger> m : counts.values()) {\n            otherStarted += m.getOrDefault(\"STARTED\", ZERO).get();\n            otherIgnored += m.getOrDefault(\"IGNORED\", ZERO).get();\n          }\n          startedOtherEvents.addValue(otherStarted);\n          ignoredOtherEvents.addValue(otherIgnored);\n        }\n        results.add(String.format(Locale.ROOT, \"%d\\t%d\\t%4.0f\\t%4.0f\\t%4.0f\\t%4.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\\t%6.0f\",\n            wait, delay, startedOurEvents.getMean(), ignoredOurEvents.getMean(),\n            startedOtherEvents.getMean(), ignoredOtherEvents.getMean(),\n            totalTime.getMin(), totalTime.getMax(), totalTime.getMean(), totalTime.getStandardDeviation(), totalTime.getVariance()));\n      }\n    }\n    log.info(\"===== RESULTS ======\");\n    log.info(\"waitFor\\tdelay\\tSTRT\\tIGN\\toSTRT\\toIGN\\tmin\\tmax\\tmean\\tstdev\\tvar\");\n    results.forEach(s -> log.info(s));\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a6a5c1c40529f15b445e6720dfde1967e139bff1":["b94236357aaa22b76c10629851fe4e376e0cea82"],"b94236357aaa22b76c10629851fe4e376e0cea82":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","278895e10265b1174eef1ab0be0cbeba446484a4"],"278895e10265b1174eef1ab0be0cbeba446484a4":["a00c801e9678a87ab9d8f373daa9d1955a4c4cee"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a6a5c1c40529f15b445e6720dfde1967e139bff1"],"a00c801e9678a87ab9d8f373daa9d1955a4c4cee":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"]},"commit2Childs":{"a6a5c1c40529f15b445e6720dfde1967e139bff1":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"b94236357aaa22b76c10629851fe4e376e0cea82":["a6a5c1c40529f15b445e6720dfde1967e139bff1"],"278895e10265b1174eef1ab0be0cbeba446484a4":["b94236357aaa22b76c10629851fe4e376e0cea82"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b94236357aaa22b76c10629851fe4e376e0cea82","a00c801e9678a87ab9d8f373daa9d1955a4c4cee"],"a00c801e9678a87ab9d8f373daa9d1955a4c4cee":["278895e10265b1174eef1ab0be0cbeba446484a4"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}