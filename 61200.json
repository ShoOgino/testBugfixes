{"path":"lucene/core/src/test/org/apache/lucene/search/TestMatchAllDocsQuery#testEarlyTermination().mjava","commits":[{"id":"ea2b4f7d8eea46fb10842f432db521b9d7aa5402","date":1544691709,"type":0,"author":"Alan Woodward","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/search/TestMatchAllDocsQuery#testEarlyTermination().mjava","pathOld":"/dev/null","sourceNew":"  public void testEarlyTermination() throws IOException {\n\n    Directory dir = newDirectory();\n    IndexWriter iw = new IndexWriter(dir, newIndexWriterConfig(analyzer).setMaxBufferedDocs(2).setMergePolicy(newLogMergePolicy()));\n    for (int i = 0; i < 500; i++) {\n      addDoc(\"doc\" + i, iw);\n    }\n    IndexReader ir = DirectoryReader.open(iw);\n\n    IndexSearcher is = newSearcher(ir);\n\n    final int totalHitsThreshold = 200;\n    TopScoreDocCollector c = TopScoreDocCollector.create(10, null, totalHitsThreshold);\n\n    is.search(new MatchAllDocsQuery(), c);\n    assertEquals(totalHitsThreshold, c.totalHits);\n\n    iw.close();\n    ir.close();\n    dir.close();\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":["5374ec368ef9441d694af8df95b2ffbae3d7f03b"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"5374ec368ef9441d694af8df95b2ffbae3d7f03b","date":1548748689,"type":3,"author":"jimczi","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/search/TestMatchAllDocsQuery#testEarlyTermination().mjava","pathOld":"lucene/core/src/test/org/apache/lucene/search/TestMatchAllDocsQuery#testEarlyTermination().mjava","sourceNew":"  public void testEarlyTermination() throws IOException {\n\n    Directory dir = newDirectory();\n    IndexWriter iw = new IndexWriter(dir, newIndexWriterConfig(analyzer).setMaxBufferedDocs(2).setMergePolicy(newLogMergePolicy()));\n    final int numDocs = 500;\n    for (int i = 0; i < numDocs; i++) {\n      addDoc(\"doc\" + i, iw);\n    }\n    IndexReader ir = DirectoryReader.open(iw);\n\n    IndexSearcher is = newSearcher(ir);\n\n    final int totalHitsThreshold = 200;\n    TopScoreDocCollector c = TopScoreDocCollector.create(10, null, totalHitsThreshold);\n\n    is.search(new MatchAllDocsQuery(), c);\n    assertEquals(totalHitsThreshold+1, c.totalHits);\n    assertEquals(TotalHits.Relation.GREATER_THAN_OR_EQUAL_TO, c.totalHitsRelation);\n\n    TopScoreDocCollector c1 = TopScoreDocCollector.create(10, null, numDocs);\n\n    is.search(new MatchAllDocsQuery(), c1);\n    assertEquals(numDocs, c1.totalHits);\n    assertEquals(TotalHits.Relation.EQUAL_TO, c1.totalHitsRelation);\n\n    iw.close();\n    ir.close();\n    dir.close();\n\n  }\n\n","sourceOld":"  public void testEarlyTermination() throws IOException {\n\n    Directory dir = newDirectory();\n    IndexWriter iw = new IndexWriter(dir, newIndexWriterConfig(analyzer).setMaxBufferedDocs(2).setMergePolicy(newLogMergePolicy()));\n    for (int i = 0; i < 500; i++) {\n      addDoc(\"doc\" + i, iw);\n    }\n    IndexReader ir = DirectoryReader.open(iw);\n\n    IndexSearcher is = newSearcher(ir);\n\n    final int totalHitsThreshold = 200;\n    TopScoreDocCollector c = TopScoreDocCollector.create(10, null, totalHitsThreshold);\n\n    is.search(new MatchAllDocsQuery(), c);\n    assertEquals(totalHitsThreshold, c.totalHits);\n\n    iw.close();\n    ir.close();\n    dir.close();\n\n  }\n\n","bugFix":["ea2b4f7d8eea46fb10842f432db521b9d7aa5402"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"ea2b4f7d8eea46fb10842f432db521b9d7aa5402":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"5374ec368ef9441d694af8df95b2ffbae3d7f03b":["ea2b4f7d8eea46fb10842f432db521b9d7aa5402"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["5374ec368ef9441d694af8df95b2ffbae3d7f03b"]},"commit2Childs":{"ea2b4f7d8eea46fb10842f432db521b9d7aa5402":["5374ec368ef9441d694af8df95b2ffbae3d7f03b"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["ea2b4f7d8eea46fb10842f432db521b9d7aa5402"],"5374ec368ef9441d694af8df95b2ffbae3d7f03b":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}