{"path":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","commits":[{"id":"5c2336584348b3646859b03caea74ba6c89f49ab","date":1332511944,"type":0,"author":"Martijn van Groningen","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    Directory directory = newFSDirectory(new File(dataDir, \"index\"), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } catch(Throwable t) {\n      assertTrue(t instanceof RuntimeException);\n      assertNotNull(t.getCause());\n      assertTrue(t.getCause() instanceof RuntimeException);\n      assertNotNull(t.getCause().getCause());\n      assertTrue(t.getCause().getCause() instanceof  LockObtainFailedException);\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":["0bf41419d452997826ec5f17684993377be77f49"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"d264f386d864b5751209060e8886ca9845f70469","date":1372172126,"type":3,"author":"Alan Woodward","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    Directory directory = newFSDirectory(new File(dataDir, \"index\"), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } catch(Throwable t) {\n      assertTrue(t instanceof RuntimeException);\n      assertNotNull(t.getCause());\n      assertTrue(t.getCause() instanceof RuntimeException);\n      assertNotNull(t.getCause().getCause());\n      assertTrue(t.getCause().getCause() instanceof  LockObtainFailedException);\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"354983dcdf70c800bf2573d10b54a7391b1dc167","date":1372183171,"type":3,"author":"Alan Woodward","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    Directory directory = newFSDirectory(new File(dataDir, \"index\"), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } catch(Throwable t) {\n      assertTrue(t instanceof RuntimeException);\n      assertNotNull(t.getCause());\n      assertTrue(t.getCause() instanceof RuntimeException);\n      assertNotNull(t.getCause().getCause());\n      assertTrue(t.getCause().getCause() instanceof  LockObtainFailedException);\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"7116474e2e390259937401cf928323e0cbc75e60","date":1372780249,"type":3,"author":"Alan Woodward","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    Directory directory = newFSDirectory(new File(dataDir, \"index\"), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } catch(Throwable t) {\n      assertTrue(t instanceof RuntimeException);\n      assertNotNull(t.getCause());\n      assertTrue(t.getCause() instanceof RuntimeException);\n      assertNotNull(t.getCause().getCause());\n      assertTrue(t.getCause().getCause() instanceof  LockObtainFailedException);\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"d68a98e12ed7f2a3128d5e05aed9bcee2c4bb6da","date":1373489021,"type":3,"author":"Yonik Seeley","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"37a0f60745e53927c4c876cfe5b5a58170f0646c","date":1373994005,"type":3,"author":"Han Jiang","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    Directory directory = newFSDirectory(new File(dataDir, \"index\"), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } catch(Throwable t) {\n      assertTrue(t instanceof RuntimeException);\n      assertNotNull(t.getCause());\n      assertTrue(t.getCause() instanceof RuntimeException);\n      assertNotNull(t.getCause().getCause());\n      assertTrue(t.getCause().getCause() instanceof  LockObtainFailedException);\n    } finally {\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"4e935fd43731596dd67a8b4d61e577682464d8e7","date":1375827220,"type":3,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"716d18f3a9b0993bc679d7fa7abdc9bfb03411ec","date":1376375609,"type":3,"author":"Han Jiang","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      //opening a new core on the same index\n      initCore(\"solrconfig-nativelock.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"0bf41419d452997826ec5f17684993377be77f49","date":1386629618,"type":3,"author":"Steven Rowe","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":["5c2336584348b3646859b03caea74ba6c89f49ab"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"74f45af4339b0daf7a95c820ab88c1aea74fbce0","date":1387475327,"type":3,"author":"Michael McCandless","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(Version.LUCENE_40, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"bb1f22cfa77230b5f05b7784feae5367f6bbb488","date":1395968145,"type":3,"author":"Mark Robert Miller","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":["9799ebcab48102552d92f7807965a91fb6e116f7"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"2a0f5bb79c600763ffe7b8141df59a3169d31e48","date":1396689440,"type":3,"author":"Dawid Weiss","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(dataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"ae14298f4eec6d5faee6a149f88ba57d14a6f21a","date":1396971290,"type":3,"author":"Michael McCandless","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.shutdown();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"d0ef034a4f10871667ae75181537775ddcf8ade4","date":1407610475,"type":3,"author":"Ryan Ernst","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(TEST_VERSION_CURRENT, null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.shutdown();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"f4abec28b874149a7223e32cc7a01704c27790de","date":1410644789,"type":3,"author":"Robert Muir","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir, new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"285cdc737de75b7cc7c284a156b20214deb67bca","date":1415535483,"type":3,"author":"Uwe Schindler","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), new NativeFSLockFactory());\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"2b3091e174423680e7d6cce5f858d48cd5410bcf","date":1452177279,"type":3,"author":"Christine Poerschke","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",\"native\");\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"9799ebcab48102552d92f7807965a91fb6e116f7","date":1564676118,"type":3,"author":"Chris Hostetter","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initAndGetDataDir(), \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":["bb1f22cfa77230b5f05b7784feae5367f6bbb488"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"f8061ddd97f3352007d927dae445884a6f3d857b","date":1564988276,"type":3,"author":"Atri Sharma","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initAndGetDataDir(), \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initCoreDataDir, \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a966532d92cf9ba2856f15a8140151bb6b518e4b","date":1588290631,"type":3,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","pathOld":"solr/core/src/test/org/apache/solr/core/SolrCoreCheckLockOnStartupTest#testNativeLockErrorOnStartup().mjava","sourceNew":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initAndGetDataDir(), \"index\");\n    if (log.isInfoEnabled()) {\n      log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    }\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","sourceOld":"  @Test\n  public void testNativeLockErrorOnStartup() throws Exception {\n\n    File indexDir = new File(initAndGetDataDir(), \"index\");\n    log.info(\"Acquiring lock on {}\", indexDir.getAbsolutePath());\n    Directory directory = newFSDirectory(indexDir.toPath(), NativeFSLockFactory.INSTANCE);\n    //creates a new IndexWriter without releasing the lock yet\n    IndexWriter indexWriter = new IndexWriter(directory, new IndexWriterConfig(null));\n\n    ignoreException(\"locked\");\n    try {\n      System.setProperty(\"solr.tests.lockType\",DirectoryFactory.LOCK_TYPE_NATIVE);\n      //opening a new core on the same index\n      initCore(\"solrconfig-basic.xml\", \"schema.xml\");\n      CoreContainer cc = h.getCoreContainer();\n      if (checkForCoreInitException(LockObtainFailedException.class))\n        return;\n      fail(\"Expected \" + LockObtainFailedException.class.getSimpleName());\n    } finally {\n      System.clearProperty(\"solr.tests.lockType\");\n      unIgnoreException(\"locked\");\n      indexWriter.close();\n      directory.close();\n      deleteCore();\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"d68a98e12ed7f2a3128d5e05aed9bcee2c4bb6da":["7116474e2e390259937401cf928323e0cbc75e60"],"4e935fd43731596dd67a8b4d61e577682464d8e7":["d68a98e12ed7f2a3128d5e05aed9bcee2c4bb6da"],"7116474e2e390259937401cf928323e0cbc75e60":["354983dcdf70c800bf2573d10b54a7391b1dc167"],"716d18f3a9b0993bc679d7fa7abdc9bfb03411ec":["37a0f60745e53927c4c876cfe5b5a58170f0646c","4e935fd43731596dd67a8b4d61e577682464d8e7"],"bb1f22cfa77230b5f05b7784feae5367f6bbb488":["0bf41419d452997826ec5f17684993377be77f49"],"2a0f5bb79c600763ffe7b8141df59a3169d31e48":["0bf41419d452997826ec5f17684993377be77f49","bb1f22cfa77230b5f05b7784feae5367f6bbb488"],"37a0f60745e53927c4c876cfe5b5a58170f0646c":["5c2336584348b3646859b03caea74ba6c89f49ab","d68a98e12ed7f2a3128d5e05aed9bcee2c4bb6da"],"285cdc737de75b7cc7c284a156b20214deb67bca":["f4abec28b874149a7223e32cc7a01704c27790de"],"354983dcdf70c800bf2573d10b54a7391b1dc167":["d264f386d864b5751209060e8886ca9845f70469"],"d264f386d864b5751209060e8886ca9845f70469":["5c2336584348b3646859b03caea74ba6c89f49ab"],"f4abec28b874149a7223e32cc7a01704c27790de":["d0ef034a4f10871667ae75181537775ddcf8ade4"],"a966532d92cf9ba2856f15a8140151bb6b518e4b":["9799ebcab48102552d92f7807965a91fb6e116f7"],"2b3091e174423680e7d6cce5f858d48cd5410bcf":["285cdc737de75b7cc7c284a156b20214deb67bca"],"f8061ddd97f3352007d927dae445884a6f3d857b":["2b3091e174423680e7d6cce5f858d48cd5410bcf","9799ebcab48102552d92f7807965a91fb6e116f7"],"0bf41419d452997826ec5f17684993377be77f49":["4e935fd43731596dd67a8b4d61e577682464d8e7"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"d0ef034a4f10871667ae75181537775ddcf8ade4":["ae14298f4eec6d5faee6a149f88ba57d14a6f21a"],"9799ebcab48102552d92f7807965a91fb6e116f7":["2b3091e174423680e7d6cce5f858d48cd5410bcf"],"74f45af4339b0daf7a95c820ab88c1aea74fbce0":["4e935fd43731596dd67a8b4d61e577682464d8e7","0bf41419d452997826ec5f17684993377be77f49"],"ae14298f4eec6d5faee6a149f88ba57d14a6f21a":["2a0f5bb79c600763ffe7b8141df59a3169d31e48"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a966532d92cf9ba2856f15a8140151bb6b518e4b"],"5c2336584348b3646859b03caea74ba6c89f49ab":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"]},"commit2Childs":{"d68a98e12ed7f2a3128d5e05aed9bcee2c4bb6da":["4e935fd43731596dd67a8b4d61e577682464d8e7","37a0f60745e53927c4c876cfe5b5a58170f0646c"],"4e935fd43731596dd67a8b4d61e577682464d8e7":["716d18f3a9b0993bc679d7fa7abdc9bfb03411ec","0bf41419d452997826ec5f17684993377be77f49","74f45af4339b0daf7a95c820ab88c1aea74fbce0"],"7116474e2e390259937401cf928323e0cbc75e60":["d68a98e12ed7f2a3128d5e05aed9bcee2c4bb6da"],"716d18f3a9b0993bc679d7fa7abdc9bfb03411ec":[],"bb1f22cfa77230b5f05b7784feae5367f6bbb488":["2a0f5bb79c600763ffe7b8141df59a3169d31e48"],"37a0f60745e53927c4c876cfe5b5a58170f0646c":["716d18f3a9b0993bc679d7fa7abdc9bfb03411ec"],"2a0f5bb79c600763ffe7b8141df59a3169d31e48":["ae14298f4eec6d5faee6a149f88ba57d14a6f21a"],"285cdc737de75b7cc7c284a156b20214deb67bca":["2b3091e174423680e7d6cce5f858d48cd5410bcf"],"354983dcdf70c800bf2573d10b54a7391b1dc167":["7116474e2e390259937401cf928323e0cbc75e60"],"d264f386d864b5751209060e8886ca9845f70469":["354983dcdf70c800bf2573d10b54a7391b1dc167"],"f4abec28b874149a7223e32cc7a01704c27790de":["285cdc737de75b7cc7c284a156b20214deb67bca"],"a966532d92cf9ba2856f15a8140151bb6b518e4b":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"2b3091e174423680e7d6cce5f858d48cd5410bcf":["f8061ddd97f3352007d927dae445884a6f3d857b","9799ebcab48102552d92f7807965a91fb6e116f7"],"f8061ddd97f3352007d927dae445884a6f3d857b":[],"0bf41419d452997826ec5f17684993377be77f49":["bb1f22cfa77230b5f05b7784feae5367f6bbb488","2a0f5bb79c600763ffe7b8141df59a3169d31e48","74f45af4339b0daf7a95c820ab88c1aea74fbce0"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["5c2336584348b3646859b03caea74ba6c89f49ab"],"d0ef034a4f10871667ae75181537775ddcf8ade4":["f4abec28b874149a7223e32cc7a01704c27790de"],"9799ebcab48102552d92f7807965a91fb6e116f7":["a966532d92cf9ba2856f15a8140151bb6b518e4b","f8061ddd97f3352007d927dae445884a6f3d857b"],"74f45af4339b0daf7a95c820ab88c1aea74fbce0":[],"ae14298f4eec6d5faee6a149f88ba57d14a6f21a":["d0ef034a4f10871667ae75181537775ddcf8ade4"],"5c2336584348b3646859b03caea74ba6c89f49ab":["37a0f60745e53927c4c876cfe5b5a58170f0646c","d264f386d864b5751209060e8886ca9845f70469"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["716d18f3a9b0993bc679d7fa7abdc9bfb03411ec","f8061ddd97f3352007d927dae445884a6f3d857b","74f45af4339b0daf7a95c820ab88c1aea74fbce0","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}