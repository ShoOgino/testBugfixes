{"path":"lucene/highlighter/src/test/org/apache/lucene/search/uhighlight/TestUnifiedHighlighter#testNestedBooleanQueryAccuracy().mjava","commits":[{"id":"795822cce6616d4035b5a4bdbb6c113ea2f715ba","date":1535599765,"type":0,"author":"David Smiley","isMerge":false,"pathNew":"lucene/highlighter/src/test/org/apache/lucene/search/uhighlight/TestUnifiedHighlighter#testNestedBooleanQueryAccuracy().mjava","pathOld":"/dev/null","sourceNew":"  // LUCENE-7909\n  public void testNestedBooleanQueryAccuracy() throws IOException {\n    IndexReader ir = indexSomeFields();\n    IndexSearcher searcher = newSearcher(ir);\n    UnifiedHighlighter highlighter = randomUnifiedHighlighter(searcher, indexAnalyzer,\n        EnumSet.of(HighlightFlag.WEIGHT_MATCHES), true);\n\n    // This query contains an inner Boolean of two MUST clauses (== \"AND\").  Only one of them is\n    //  actually in the data, the other is not.  We should highlight neither.  We can highlight the outer\n    //  SHOULD clauses though.\n    Query query = new BooleanQuery.Builder()\n        .add(new PhraseQuery(\"title\", \"title\", \"field\"), BooleanClause.Occur.SHOULD)\n        .add(new BooleanQuery.Builder()\n            .add(new TermQuery(new Term(\"category\", \"category\")), BooleanClause.Occur.MUST)\n            .add(new TermQuery(new Term(\"category\", \"nonexistent\")), BooleanClause.Occur.MUST)\n            .build(), BooleanClause.Occur.SHOULD)\n        .build();\n\n    TopDocs topDocs = searcher.search(query, 10, Sort.INDEXORDER);\n\n    String[] snippets = highlighter.highlight(\"title\", query, topDocs);\n    assertArrayEquals(new String[]{\"This is the <b>title field</b>.\"}, snippets);\n\n    // no highlights, not of \"category\" since \"nonexistent\" wasn't there\n    snippets = highlighter.highlight(\"category\", query, topDocs);\n    assertArrayEquals(new String[]{\"This is the category field.\"}, snippets);\n\n    ir.close();\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"795822cce6616d4035b5a4bdbb6c113ea2f715ba":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["795822cce6616d4035b5a4bdbb6c113ea2f715ba"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["795822cce6616d4035b5a4bdbb6c113ea2f715ba"],"795822cce6616d4035b5a4bdbb6c113ea2f715ba":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}