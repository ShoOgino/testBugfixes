{"path":"solr/core/src/test/org/apache/solr/util/SolrLogPostToolTest#testErrorRecord().mjava","commits":[{"id":"2e38054de362483189e0fdd850b779ed766aa7aa","date":1578059239,"type":0,"author":"Joel Bernstein","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/util/SolrLogPostToolTest#testErrorRecord().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void testErrorRecord() throws Exception{\n    String record = \"2019-12-31 01:49:53.251 ERROR (qtp2103763750-240) [c:logs6 s:shard1 r:core_node2 x:logs6_shard1_replica_n1] o.a.s.h.RequestHandlerBase org.apache.solr.common.SolrException: org.apache.solr.search.SyntaxError: Cannot parse 'id:[* TO *': Encountered \\\"<EOF>\\\" at line 1, column 10.\\n\" +\n        \"Was expecting one of:\\n\" +\n        \"    \\\"]\\\" ...\\n\" +\n        \"    \\\"}\\\" ...\\n\" +\n        \"    \\n\" +\n        \"\\tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:218)\\n\" +\n        \"\\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:302)\\n\" +\n        \"\\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:197)\\n\" +\n        \"\\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2582)\\n\" +\n        \"\\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:799)\\n\" +\n        \"\\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:578)\\n\" +\n        \"\\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:419)\\n\" +\n        \"\\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:351)\\n\" +\n        \"\\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1602)\\n\" +\n        \"\\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:540)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:146)\\n\" +\n        \"\\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)\\n\" +\n        \"\\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1711)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:255)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1347)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:203)\\n\" +\n        \"\\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:480)\\n\" +\n        \"\\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1678)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:201)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1249)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:220)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:152)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\\n\" +\n        \"\\tat org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\\n\" +\n        \"\\tat org.eclipse.jetty.server.Server.handle(Server.java:505)\\n\" +\n        \"\\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:370)\\n\" +\n        \"\\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:267)\\n\" +\n        \"\\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:305)\\n\" +\n        \"\\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:103)\\n\" +\n        \"\\tat org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:117)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:781)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:917)\\n\" +\n        \"\\tat java.base/java.lang.Thread.run(Thread.java:834)\\n\" +\n        \"Caused by: org.apache.solr.search.SyntaxError: Cannot parse 'id:[* TO *': Encountered \\\"<EOF>\\\" at line 1, column 10.\\n\" +\n        \"Was expecting one of:\\n\" +\n        \"    \\\"]\\\" ...\\n\" +\n        \"    \\\"}\\\" ...\\n\" +\n        \"    \\n\" +\n        \"\\tat org.apache.solr.parser.SolrQueryParserBase.parse(SolrQueryParserBase.java:266)\\n\" +\n        \"\\tat org.apache.solr.search.LuceneQParser.parse(LuceneQParser.java:49)\\n\" +\n        \"\\tat org.apache.solr.search.QParser.getQuery(QParser.java:174)\\n\" +\n        \"\\tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:160)\\n\" +\n        \"\\t... 41 more\\n\" +\n        \"Caused by: org.apache.solr.parser.ParseException: Encountered \\\"<EOF>\\\" at line 1, column 10.\\n\" +\n        \"Was expecting one of:\\n\" +\n        \"    \\\"]\\\" ...\\n\" +\n        \"    \\\"}\\\" ...\\n\" +\n        \"    \\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.generateParseException(QueryParser.java:885)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.jj_consume_token(QueryParser.java:767)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.Term(QueryParser.java:479)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.Clause(QueryParser.java:278)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.Query(QueryParser.java:162)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.TopLevelQuery(QueryParser.java:131)\\n\" +\n        \"\\tat org.apache.solr.parser.SolrQueryParserBase.parse(SolrQueryParserBase.java:262)\\n\" +\n        \"\\t... 44 more\\n\" +\n        \"\\n\"+\n        \"2019-12-09 15:05:01.931 INFO  (qtp2103763750-21) [c:logs4 s:shard1 r:core_node2 x:logs4_shard1_replica_n1] o.a.s.c.S.Request [logs4_shard1_replica_n1]  webapp=/solr path=/select params={q=*:*&_=1575835181759&isShard=true&wt=javabin&distrib=false} hits=234868 status=0 QTime=8\\n\";\n    List<SolrInputDocument> docs = readDocs(record);\n    assertEquals(docs.size(), 2);\n    SolrInputDocument doc = docs.get(0);\n    SolrInputField date = doc.getField(\"date_dt\");\n    SolrInputField type = doc.getField(\"type_s\");\n    SolrInputField shard = doc.getField(\"shard_s\");\n    SolrInputField replica = doc.getField(\"replica_s\");\n    SolrInputField core = doc.getField(\"core_s\");\n    SolrInputField stack = doc.getField(\"stack_t\");\n    SolrInputField root = doc.getField(\"root_cause_t\");\n    SolrInputField collection = doc.getField(\"collection_s\");\n\n\n    assertEquals(date.getValue(), \"2019-12-31T01:49:53.251\");\n    assertEquals(type.getValue(), \"error\");\n    assertEquals(collection.getValue(), \"logs6\");\n\n\n    assertEquals(shard.getValue(), \"shard1\");\n    assertEquals(replica.getValue(), \"core_node2\");\n    assertEquals(core.getValue(), \"logs6_shard1_replica_n1\");\n    assertTrue(stack.getValue().toString().contains(root.getValue().toString()));\n\n    SolrInputDocument doc1 = docs.get(1);\n    SolrInputField date1 = doc1.getField(\"date_dt\");\n    SolrInputField type1 = doc1.getField(\"type_s\");\n    assertEquals(date1.getValue(), \"2019-12-09T15:05:01.931\");\n    assertEquals(type1.getValue(), \"query\");\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ca62564055241632cd20d65b5ecb8c8e93bd60c4","date":1578383112,"type":0,"author":"Dawid Weiss","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/util/SolrLogPostToolTest#testErrorRecord().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void testErrorRecord() throws Exception{\n    String record = \"2019-12-31 01:49:53.251 ERROR (qtp2103763750-240) [c:logs6 s:shard1 r:core_node2 x:logs6_shard1_replica_n1] o.a.s.h.RequestHandlerBase org.apache.solr.common.SolrException: org.apache.solr.search.SyntaxError: Cannot parse 'id:[* TO *': Encountered \\\"<EOF>\\\" at line 1, column 10.\\n\" +\n        \"Was expecting one of:\\n\" +\n        \"    \\\"]\\\" ...\\n\" +\n        \"    \\\"}\\\" ...\\n\" +\n        \"    \\n\" +\n        \"\\tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:218)\\n\" +\n        \"\\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:302)\\n\" +\n        \"\\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:197)\\n\" +\n        \"\\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2582)\\n\" +\n        \"\\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:799)\\n\" +\n        \"\\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:578)\\n\" +\n        \"\\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:419)\\n\" +\n        \"\\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:351)\\n\" +\n        \"\\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1602)\\n\" +\n        \"\\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:540)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:146)\\n\" +\n        \"\\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:257)\\n\" +\n        \"\\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1711)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:255)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1347)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:203)\\n\" +\n        \"\\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:480)\\n\" +\n        \"\\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1678)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:201)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1249)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:220)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:152)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\\n\" +\n        \"\\tat org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:335)\\n\" +\n        \"\\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\\n\" +\n        \"\\tat org.eclipse.jetty.server.Server.handle(Server.java:505)\\n\" +\n        \"\\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:370)\\n\" +\n        \"\\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:267)\\n\" +\n        \"\\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:305)\\n\" +\n        \"\\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:103)\\n\" +\n        \"\\tat org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:117)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:781)\\n\" +\n        \"\\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:917)\\n\" +\n        \"\\tat java.base/java.lang.Thread.run(Thread.java:834)\\n\" +\n        \"Caused by: org.apache.solr.search.SyntaxError: Cannot parse 'id:[* TO *': Encountered \\\"<EOF>\\\" at line 1, column 10.\\n\" +\n        \"Was expecting one of:\\n\" +\n        \"    \\\"]\\\" ...\\n\" +\n        \"    \\\"}\\\" ...\\n\" +\n        \"    \\n\" +\n        \"\\tat org.apache.solr.parser.SolrQueryParserBase.parse(SolrQueryParserBase.java:266)\\n\" +\n        \"\\tat org.apache.solr.search.LuceneQParser.parse(LuceneQParser.java:49)\\n\" +\n        \"\\tat org.apache.solr.search.QParser.getQuery(QParser.java:174)\\n\" +\n        \"\\tat org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:160)\\n\" +\n        \"\\t... 41 more\\n\" +\n        \"Caused by: org.apache.solr.parser.ParseException: Encountered \\\"<EOF>\\\" at line 1, column 10.\\n\" +\n        \"Was expecting one of:\\n\" +\n        \"    \\\"]\\\" ...\\n\" +\n        \"    \\\"}\\\" ...\\n\" +\n        \"    \\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.generateParseException(QueryParser.java:885)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.jj_consume_token(QueryParser.java:767)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.Term(QueryParser.java:479)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.Clause(QueryParser.java:278)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.Query(QueryParser.java:162)\\n\" +\n        \"\\tat org.apache.solr.parser.QueryParser.TopLevelQuery(QueryParser.java:131)\\n\" +\n        \"\\tat org.apache.solr.parser.SolrQueryParserBase.parse(SolrQueryParserBase.java:262)\\n\" +\n        \"\\t... 44 more\\n\" +\n        \"\\n\"+\n        \"2019-12-09 15:05:01.931 INFO  (qtp2103763750-21) [c:logs4 s:shard1 r:core_node2 x:logs4_shard1_replica_n1] o.a.s.c.S.Request [logs4_shard1_replica_n1]  webapp=/solr path=/select params={q=*:*&_=1575835181759&isShard=true&wt=javabin&distrib=false} hits=234868 status=0 QTime=8\\n\";\n    List<SolrInputDocument> docs = readDocs(record);\n    assertEquals(docs.size(), 2);\n    SolrInputDocument doc = docs.get(0);\n    SolrInputField date = doc.getField(\"date_dt\");\n    SolrInputField type = doc.getField(\"type_s\");\n    SolrInputField shard = doc.getField(\"shard_s\");\n    SolrInputField replica = doc.getField(\"replica_s\");\n    SolrInputField core = doc.getField(\"core_s\");\n    SolrInputField stack = doc.getField(\"stack_t\");\n    SolrInputField root = doc.getField(\"root_cause_t\");\n    SolrInputField collection = doc.getField(\"collection_s\");\n\n\n    assertEquals(date.getValue(), \"2019-12-31T01:49:53.251\");\n    assertEquals(type.getValue(), \"error\");\n    assertEquals(collection.getValue(), \"logs6\");\n\n\n    assertEquals(shard.getValue(), \"shard1\");\n    assertEquals(replica.getValue(), \"core_node2\");\n    assertEquals(core.getValue(), \"logs6_shard1_replica_n1\");\n    assertTrue(stack.getValue().toString().contains(root.getValue().toString()));\n\n    SolrInputDocument doc1 = docs.get(1);\n    SolrInputField date1 = doc1.getField(\"date_dt\");\n    SolrInputField type1 = doc1.getField(\"type_s\");\n    assertEquals(date1.getValue(), \"2019-12-09T15:05:01.931\");\n    assertEquals(type1.getValue(), \"query\");\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"2e38054de362483189e0fdd850b779ed766aa7aa":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"ca62564055241632cd20d65b5ecb8c8e93bd60c4":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","2e38054de362483189e0fdd850b779ed766aa7aa"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["2e38054de362483189e0fdd850b779ed766aa7aa"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["2e38054de362483189e0fdd850b779ed766aa7aa","ca62564055241632cd20d65b5ecb8c8e93bd60c4"],"2e38054de362483189e0fdd850b779ed766aa7aa":["ca62564055241632cd20d65b5ecb8c8e93bd60c4","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"ca62564055241632cd20d65b5ecb8c8e93bd60c4":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["ca62564055241632cd20d65b5ecb8c8e93bd60c4","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}