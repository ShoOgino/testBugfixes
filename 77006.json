{"path":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","commits":[{"id":"eeba0a4d0845889a402dd225793d62f009d029c9","date":1527938093,"type":0,"author":"Simon Willnauer","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","pathOld":"/dev/null","sourceNew":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.segmentInfos) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ab548c8f96022b4780f7500a30b19b4f4a5feeb6","date":1527940044,"type":4,"author":"Simon Willnauer","isMerge":false,"pathNew":"/dev/null","pathOld":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","sourceNew":null,"sourceOld":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.segmentInfos) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"b7e4ca6dc9612ff741d8713743e2bccfae5eadac","date":1528093718,"type":0,"author":"Simon Willnauer","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","pathOld":"/dev/null","sourceNew":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.segmentInfos) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":["631ea3d1607299c59f33edef140ffc19a81f07a0"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"f592209545c71895260367152601e9200399776d","date":1528238935,"type":0,"author":"Michael Braun","isMerge":true,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","pathOld":"/dev/null","sourceNew":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.segmentInfos) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"b70042a8a492f7054d480ccdd2be9796510d4327","date":1528386658,"type":0,"author":"Alessandro Benedetti","isMerge":true,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","pathOld":"/dev/null","sourceNew":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.segmentInfos) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"631ea3d1607299c59f33edef140ffc19a81f07a0","date":1532450367,"type":3,"author":"Nhat Nguyen","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","pathOld":"lucene/core/src/test/org/apache/lucene/index/TestIndexWriter#testPreventAddingIndexesWithDifferentSoftDeletesField().mjava","sourceNew":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.cloneSegmentInfos()) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","sourceOld":"  public void testPreventAddingIndexesWithDifferentSoftDeletesField() throws Exception {\n    Directory dir1 = newDirectory();\n    IndexWriter w1 = new IndexWriter(dir1, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\"));\n    for (int i = 0; i < 2; i++) {\n      Document d = new Document();\n      d.add(new StringField(\"id\", \"1\", Field.Store.YES));\n      d.add(new StringField(\"version\", Integer.toString(i), Field.Store.YES));\n      w1.softUpdateDocument(new Term(\"id\", \"1\"), d, new NumericDocValuesField(\"soft_deletes_1\", 1));\n    }\n    w1.commit();\n    w1.close();\n\n    Directory dir2 = newDirectory();\n    IndexWriter w2 = new IndexWriter(dir2, newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_2\"));\n    IllegalArgumentException error = expectThrows(IllegalArgumentException.class, () -> w2.addIndexes(dir1));\n    assertEquals(\"cannot configure [soft_deletes_2] as soft-deletes; this index uses [soft_deletes_1] as soft-deletes already\",\n        error.getMessage());\n    w2.close();\n\n    Directory dir3 = newDirectory();\n    IndexWriterConfig config = newIndexWriterConfig().setSoftDeletesField(\"soft_deletes_1\");\n    IndexWriter w3 = new IndexWriter(dir3, config);\n    w3.addIndexes(dir1);\n    for (SegmentCommitInfo si : w3.segmentInfos) {\n      FieldInfo softDeleteField = IndexWriter.readFieldInfos(si).fieldInfo(\"soft_deletes_1\");\n      assertTrue(softDeleteField.isSoftDeletesField());\n    }\n    w3.close();\n    IOUtils.close(dir1, dir2, dir3);\n  }\n\n","bugFix":["b7e4ca6dc9612ff741d8713743e2bccfae5eadac"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"631ea3d1607299c59f33edef140ffc19a81f07a0":["b7e4ca6dc9612ff741d8713743e2bccfae5eadac"],"ab548c8f96022b4780f7500a30b19b4f4a5feeb6":["eeba0a4d0845889a402dd225793d62f009d029c9"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"b70042a8a492f7054d480ccdd2be9796510d4327":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","b7e4ca6dc9612ff741d8713743e2bccfae5eadac"],"b7e4ca6dc9612ff741d8713743e2bccfae5eadac":["ab548c8f96022b4780f7500a30b19b4f4a5feeb6"],"eeba0a4d0845889a402dd225793d62f009d029c9":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"f592209545c71895260367152601e9200399776d":["ab548c8f96022b4780f7500a30b19b4f4a5feeb6","b7e4ca6dc9612ff741d8713743e2bccfae5eadac"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["631ea3d1607299c59f33edef140ffc19a81f07a0"]},"commit2Childs":{"631ea3d1607299c59f33edef140ffc19a81f07a0":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"ab548c8f96022b4780f7500a30b19b4f4a5feeb6":["b7e4ca6dc9612ff741d8713743e2bccfae5eadac","f592209545c71895260367152601e9200399776d"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b70042a8a492f7054d480ccdd2be9796510d4327","eeba0a4d0845889a402dd225793d62f009d029c9"],"b70042a8a492f7054d480ccdd2be9796510d4327":[],"b7e4ca6dc9612ff741d8713743e2bccfae5eadac":["631ea3d1607299c59f33edef140ffc19a81f07a0","b70042a8a492f7054d480ccdd2be9796510d4327","f592209545c71895260367152601e9200399776d"],"eeba0a4d0845889a402dd225793d62f009d029c9":["ab548c8f96022b4780f7500a30b19b4f4a5feeb6"],"f592209545c71895260367152601e9200399776d":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["b70042a8a492f7054d480ccdd2be9796510d4327","f592209545c71895260367152601e9200399776d","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}