{"path":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","commits":[{"id":"29887daf839649150d96855b142b76f5c45d60d2","date":1482160504,"type":0,"author":"Ishan Chattopadhyaya","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","pathOld":"/dev/null","sourceNew":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"5acd68c5f07f7ee604c2eeffe801f4a2d7a1a5bf","date":1482251961,"type":0,"author":"Kevin Risden","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","pathOld":"/dev/null","sourceNew":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"8a0ea515a31bb6b0279f3bbcc2bf88ed17eb0c0c","date":1551210752,"type":3,"author":"Kevin Risden","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","pathOld":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","sourceNew":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    // Needed to work around HADOOP-13346\n    params.put(DelegationTokenAuthenticationHandler.JSON_MAPPER_PREFIX + JsonGenerator.Feature.AUTO_CLOSE_TARGET,\n        \"false\");\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","sourceOld":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"accbc347dd28993a84ae51e9e6f01e31a26a7184","date":1551252530,"type":3,"author":"Karl Wright","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","pathOld":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","sourceNew":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    // Needed to work around HADOOP-13346\n    params.put(DelegationTokenAuthenticationHandler.JSON_MAPPER_PREFIX + JsonGenerator.Feature.AUTO_CLOSE_TARGET,\n        \"false\");\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","sourceOld":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"54faedfb0e03479a38f5ee82f2dfaeea536e9404","date":1587251295,"type":3,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","pathOld":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","sourceNew":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    // Needed to work around HADOOP-13346\n    params.put(DelegationTokenAuthenticationHandler.JSON_MAPPER_PREFIX + JsonGenerator.Feature.AUTO_CLOSE_TARGET,\n        \"false\");\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    if (log.isInfoEnabled()) {\n      log.info(\"Params: {}\", params);\n    }\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","sourceOld":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    // Needed to work around HADOOP-13346\n    params.put(DelegationTokenAuthenticationHandler.JSON_MAPPER_PREFIX + JsonGenerator.Feature.AUTO_CLOSE_TARGET,\n        \"false\");\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    log.info(\"Params: \"+params);\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"23b436ffee26b67f87efef6a3bab24697332b6b2","date":1587575178,"type":3,"author":"Mike Drob","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","pathOld":"solr/core/src/java/org/apache/solr/security/HadoopAuthPlugin#getInitFilterConfig(Map[String,Object]).mjava","sourceNew":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    // Needed to work around HADOOP-13346\n    params.put(DelegationTokenAuthenticationHandler.JSON_MAPPER_PREFIX + JsonGenerator.Feature.AUTO_CLOSE_TARGET,\n        \"false\");\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    if (log.isInfoEnabled()) {\n      log.info(\"Params: {}\", params);\n    }\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return Collections.enumeration(params.keySet());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","sourceOld":"  @SuppressWarnings(\"unchecked\")\n  protected FilterConfig getInitFilterConfig(Map<String, Object> pluginConfig) {\n    Map<String, String> params = new HashMap<>();\n\n    String type = (String) Objects.requireNonNull(pluginConfig.get(HADOOP_AUTH_TYPE));\n    params.put(HADOOP_AUTH_TYPE, type);\n\n    String sysPropPrefix = (String) pluginConfig.getOrDefault(SYSPROP_PREFIX_PROPERTY, \"solr.\");\n    Collection<String> authConfigNames = (Collection<String>) pluginConfig.\n        getOrDefault(AUTH_CONFIG_NAMES_PROPERTY, Collections.emptyList());\n    Map<String,String> authConfigDefaults = (Map<String,String>) pluginConfig\n        .getOrDefault(DEFAULT_AUTH_CONFIGS_PROPERTY, Collections.emptyMap());\n    Map<String,String> proxyUserConfigs = (Map<String,String>) pluginConfig\n        .getOrDefault(PROXY_USER_CONFIGS, Collections.emptyMap());\n\n    for ( String configName : authConfigNames) {\n      String systemProperty = sysPropPrefix + configName;\n      String defaultConfigVal = authConfigDefaults.get(configName);\n      String configVal = System.getProperty(systemProperty, defaultConfigVal);\n      if (configVal != null) {\n        params.put(configName, configVal);\n      }\n    }\n\n    // Configure proxy user settings.\n    params.putAll(proxyUserConfigs);\n\n    // Needed to work around HADOOP-13346\n    params.put(DelegationTokenAuthenticationHandler.JSON_MAPPER_PREFIX + JsonGenerator.Feature.AUTO_CLOSE_TARGET,\n        \"false\");\n\n    final ServletContext servletContext = new AttributeOnlyServletContext();\n    if (log.isInfoEnabled()) {\n      log.info(\"Params: {}\", params);\n    }\n\n    ZkController controller = coreContainer.getZkController();\n    if (controller != null) {\n      servletContext.setAttribute(DELEGATION_TOKEN_ZK_CLIENT, controller.getZkClient());\n    }\n\n    FilterConfig conf = new FilterConfig() {\n      @Override\n      public ServletContext getServletContext() {\n        return servletContext;\n      }\n\n      @Override\n      public Enumeration<String> getInitParameterNames() {\n        return new IteratorEnumeration(params.keySet().iterator());\n      }\n\n      @Override\n      public String getInitParameter(String param) {\n        return params.get(param);\n      }\n\n      @Override\n      public String getFilterName() {\n        return \"HadoopAuthFilter\";\n      }\n    };\n\n    return conf;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"54faedfb0e03479a38f5ee82f2dfaeea536e9404":["accbc347dd28993a84ae51e9e6f01e31a26a7184"],"29887daf839649150d96855b142b76f5c45d60d2":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"5acd68c5f07f7ee604c2eeffe801f4a2d7a1a5bf":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","29887daf839649150d96855b142b76f5c45d60d2"],"23b436ffee26b67f87efef6a3bab24697332b6b2":["54faedfb0e03479a38f5ee82f2dfaeea536e9404"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"accbc347dd28993a84ae51e9e6f01e31a26a7184":["29887daf839649150d96855b142b76f5c45d60d2","8a0ea515a31bb6b0279f3bbcc2bf88ed17eb0c0c"],"8a0ea515a31bb6b0279f3bbcc2bf88ed17eb0c0c":["29887daf839649150d96855b142b76f5c45d60d2"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["23b436ffee26b67f87efef6a3bab24697332b6b2"]},"commit2Childs":{"54faedfb0e03479a38f5ee82f2dfaeea536e9404":["23b436ffee26b67f87efef6a3bab24697332b6b2"],"29887daf839649150d96855b142b76f5c45d60d2":["5acd68c5f07f7ee604c2eeffe801f4a2d7a1a5bf","accbc347dd28993a84ae51e9e6f01e31a26a7184","8a0ea515a31bb6b0279f3bbcc2bf88ed17eb0c0c"],"5acd68c5f07f7ee604c2eeffe801f4a2d7a1a5bf":[],"23b436ffee26b67f87efef6a3bab24697332b6b2":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["29887daf839649150d96855b142b76f5c45d60d2","5acd68c5f07f7ee604c2eeffe801f4a2d7a1a5bf"],"accbc347dd28993a84ae51e9e6f01e31a26a7184":["54faedfb0e03479a38f5ee82f2dfaeea536e9404"],"8a0ea515a31bb6b0279f3bbcc2bf88ed17eb0c0c":["accbc347dd28993a84ae51e9e6f01e31a26a7184"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["5acd68c5f07f7ee604c2eeffe801f4a2d7a1a5bf","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}