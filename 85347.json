{"path":"solr/core/src/java/org/apache/solr/update/processor/FieldMutatingUpdateProcessor.ConfigurableFieldNameSelectorHelper#shouldMutateBasedOnSchema(String,IndexSchema).mjava","commits":[{"id":"f13b9d4c228e77327b284419c8cafd16913a7a19","date":1405437837,"type":1,"author":"Steven Rowe","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/update/processor/FieldMutatingUpdateProcessor.ConfigurableFieldNameSelectorHelper#shouldMutateBasedOnSchema(String,IndexSchema).mjava","pathOld":"solr/core/src/java/org/apache/solr/update/processor/FieldMutatingUpdateProcessor.ConfigurableFieldNameSelector#shouldMutate(String).mjava","sourceNew":"    public boolean shouldMutateBasedOnSchema(final String fieldName, IndexSchema schema) {\n      // order of checks is based on what should be quicker\n      // (ie: set lookups faster the looping over instanceOf / matches tests\n      \n      if ( ! (params.fieldName.isEmpty() || params.fieldName.contains(fieldName)) ) {\n        return false;\n      }\n      \n      // do not consider it an error if the fieldName has no type\n      // there might be another processor dealing with it later\n      FieldType t =  schema.getFieldTypeNoEx(fieldName);\n      final boolean fieldExists = (null != t);\n\n      if ( (null != params.fieldNameMatchesSchemaField) &&\n           (fieldExists != params.fieldNameMatchesSchemaField) ) {\n        return false;\n      }\n\n      if (fieldExists) { \n\n        if (! (params.typeName.isEmpty() || params.typeName.contains(t.getTypeName())) ) {\n          return false;\n        }\n        \n        if (! (classes.isEmpty() || instanceOfAny(t, classes)) ) {\n          return false;\n        }\n      } \n      \n      if (! (params.fieldRegex.isEmpty() || matchesAny(fieldName, params.fieldRegex)) ) {\n        return false;\n      }\n      \n      return true;\n    }\n\n","sourceOld":"    @Override\n    public boolean shouldMutate(final String fieldName) {\n      \n      // order of checks is based on what should be quicker\n      // (ie: set lookups faster the looping over instanceOf / matches tests\n      \n      if ( ! (params.fieldName.isEmpty() || params.fieldName.contains(fieldName)) ) {\n        return false;\n      }\n      \n      // do not consider it an error if the fieldName has no type\n      // there might be another processor dealing with it later\n      FieldType t =  core.getLatestSchema().getFieldTypeNoEx(fieldName);\n      final boolean fieldExists = (null != t);\n\n      if ( (null != params.fieldNameMatchesSchemaField) &&\n           (fieldExists != params.fieldNameMatchesSchemaField) ) {\n        return false;\n      }\n\n      if (fieldExists) { \n\n        if (! (params.typeName.isEmpty() || params.typeName.contains(t.getTypeName())) ) {\n          return false;\n        }\n        \n        if (! (classes.isEmpty() || instanceOfAny(t, classes)) ) {\n          return false;\n        }\n      } \n      \n      if (! (params.fieldRegex.isEmpty() || matchesAny(fieldName, params.fieldRegex)) ) {\n        return false;\n      }\n      \n      return true;\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"f13b9d4c228e77327b284419c8cafd16913a7a19":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["f13b9d4c228e77327b284419c8cafd16913a7a19"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["f13b9d4c228e77327b284419c8cafd16913a7a19"],"f13b9d4c228e77327b284419c8cafd16913a7a19":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}