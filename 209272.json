{"path":"lucene/core/src/java/org/apache/lucene/search/ReqExclScorer#matchCost(DocIdSetIterator,TwoPhaseIterator,DocIdSetIterator,TwoPhaseIterator).mjava","commits":[{"id":"507fb221fedb6f40fd72e9764803053dd3a2ba15","date":1450357860,"type":0,"author":"Adrien Grand","isMerge":false,"pathNew":"lucene/core/src/java/org/apache/lucene/search/ReqExclScorer#matchCost(DocIdSetIterator,TwoPhaseIterator,DocIdSetIterator,TwoPhaseIterator).mjava","pathOld":"/dev/null","sourceNew":"  private static float matchCost(\n      DocIdSetIterator reqApproximation,\n      TwoPhaseIterator reqTwoPhaseIterator,\n      DocIdSetIterator exclApproximation,\n      TwoPhaseIterator exclTwoPhaseIterator) {\n    float matchCost = 2; // we perform 2 comparisons to advance exclApproximation\n    if (reqTwoPhaseIterator != null) {\n      // this two-phase iterator must always be matched\n      matchCost += reqTwoPhaseIterator.matchCost();\n    }\n\n    // match cost of the prohibited clause: we need to advance the approximation\n    // and match the two-phased iterator\n    final float exclMatchCost = ADVANCE_COST\n        + (exclTwoPhaseIterator == null ? 0 : exclTwoPhaseIterator.matchCost());\n\n    // upper value for the ratio of documents that reqApproximation matches that\n    // exclApproximation also matches\n    float ratio;\n    if (reqApproximation.cost() <= 0) {\n      ratio = 1f;\n    } else if (exclApproximation.cost() <= 0) {\n      ratio = 0f;\n    } else {\n      ratio = (float) Math.min(reqApproximation.cost(), exclApproximation.cost()) / reqApproximation.cost();\n    }\n    matchCost += ratio * exclMatchCost;\n\n    return matchCost;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"507fb221fedb6f40fd72e9764803053dd3a2ba15":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["507fb221fedb6f40fd72e9764803053dd3a2ba15"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["507fb221fedb6f40fd72e9764803053dd3a2ba15"],"507fb221fedb6f40fd72e9764803053dd3a2ba15":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}