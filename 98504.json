{"path":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","commits":[{"id":"f1de703f36b1071144037c80ca5fe118aa5e96fd","date":1493947151,"type":0,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"/dev/null","sourceNew":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"set\")\n            .add(\"Atomic.name_s\", \"set\")\n            .add(\"Atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"inc\")\n            .add(\"Atomic.name_s\", \"remove\")\n            .add(\"Atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":["c03701e1c4c7f814c3e4fb75289fb8e0380f1303"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"e9017cf144952056066919f1ebc7897ff9bd71b1","date":1496757600,"type":0,"author":"Shalin Shekhar Mangar","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"/dev/null","sourceNew":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"set\")\n            .add(\"Atomic.name_s\", \"set\")\n            .add(\"Atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"inc\")\n            .add(\"Atomic.name_s\", \"remove\")\n            .add(\"Atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"526bbf21a282a0aeaa55d4963d2646fd87ea5722","date":1497595167,"type":3,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"set\")\n            .add(\"atomic.name_s\", \"set\")\n            .add(\"atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"inc\")\n            .add(\"atomic.name_s\", \"remove\")\n            .add(\"atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"set\")\n            .add(\"Atomic.name_s\", \"set\")\n            .add(\"Atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"inc\")\n            .add(\"Atomic.name_s\", \"remove\")\n            .add(\"Atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":["c03701e1c4c7f814c3e4fb75289fb8e0380f1303"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"2a3ed3f77cdd034e789d00d1ca8bb7054c9fb8e9","date":1498028748,"type":3,"author":"Shalin Shekhar Mangar","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"set\")\n            .add(\"atomic.name_s\", \"set\")\n            .add(\"atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"inc\")\n            .add(\"atomic.name_s\", \"remove\")\n            .add(\"atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"set\")\n            .add(\"Atomic.name_s\", \"set\")\n            .add(\"Atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"inc\")\n            .add(\"Atomic.name_s\", \"remove\")\n            .add(\"Atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"28288370235ed02234a64753cdbf0c6ec096304a","date":1498726817,"type":3,"author":"Karl Wright","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"set\")\n            .add(\"atomic.name_s\", \"set\")\n            .add(\"atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"inc\")\n            .add(\"atomic.name_s\", \"remove\")\n            .add(\"atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"set\")\n            .add(\"Atomic.name_s\", \"set\")\n            .add(\"Atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"Atomic\")\n            .add(\"Atomic.cat\", \"add\")\n            .add(\"Atomic.title\", \"set\")\n            .add(\"Atomic.count_i\", \"inc\")\n            .add(\"Atomic.name_s\", \"remove\")\n            .add(\"Atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"a92ffe0d2961113e5588e614f8dc22b42bf10a95","date":1503304229,"type":3,"author":"Cao Manh Dat","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"set\")\n            .add(\"atomic.name_s\", \"set\")\n            .add(\"atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"inc\")\n            .add(\"atomic.name_s\", \"remove\")\n            .add(\"atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"c03701e1c4c7f814c3e4fb75289fb8e0380f1303","date":1503296485,"type":3,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"set\")\n            .add(\"atomic.name_s\", \"set\")\n            .add(\"atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"inc\")\n            .add(\"atomic.name_s\", \"remove\")\n            .add(\"atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":["f1de703f36b1071144037c80ca5fe118aa5e96fd","526bbf21a282a0aeaa55d4963d2646fd87ea5722"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"3051d6122751c8f6cc1e9cf24592658b59843ec2","date":1503298024,"type":3,"author":"Shalin Shekhar Mangar","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"set\")\n            .add(\"atomic.name_s\", \"set\")\n            .add(\"atomic.multiDefault\", \"set\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    AtomicUpdateProcessorFactory factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        new ModifiableSolrParams()\n            .add(\"processor\", \"atomic\")\n            .add(\"atomic.cat\", \"add\")\n            .add(\"atomic.title\", \"set\")\n            .add(\"atomic.count_i\", \"inc\")\n            .add(\"atomic.name_s\", \"remove\")\n            .add(\"atomic.multiDefault\", \"removeregex\")\n            .add(\"commit\",\"true\")\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n\n    factory = new AtomicUpdateProcessorFactory();\n    factory.inform(h.getCore());\n    factory.getInstance(cmd.getReq(), new SolrQueryResponse(),\n        new DistributedUpdateProcessor(cmd.getReq(), new SolrQueryResponse(),\n            new RunUpdateProcessor(cmd.getReq(), null))).processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"29cfba4d094f887719559c63c9018157a6d41462","date":1521773308,"type":3,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add-distinct\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", Arrays.asList(new String[] {\"human\",\"human\",\"animal\",\"animal\"}));\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(req(\"q\", \"id:1\", \"indent\", \"true\"),\n        \"//doc/arr[@name='cat'][count(str)=2]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"3fa95fb629298e03fe5e3d71a0ce792f1256f711","date":1521903809,"type":3,"author":"Karl Wright","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add-distinct\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", Arrays.asList(new String[] {\"human\",\"human\",\"animal\",\"animal\"}));\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(req(\"q\", \"id:1\", \"indent\", \"true\"),\n        \"//doc/arr[@name='cat'][count(str)=2]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"animal\");\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"bf62a41dee1ac5d780c26dc793cab09e2a755b6d","date":1567792557,"type":3,"author":"David Smiley","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/AtomicUpdateProcessorFactoryTest#testBasics().mjava","sourceNew":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    try (SolrQueryRequest req = new LocalSolrQueryRequest(h.getCore(), params)) {\n      AddUpdateCommand cmd = new AddUpdateCommand(req);\n\n      cmd.solrDoc = new SolrInputDocument();\n      cmd.solrDoc.addField(\"id\", 1);\n      cmd.solrDoc.addField(\"cat\", \"human\");\n      cmd.solrDoc.addField(\"title\", \"Mr\");\n      cmd.solrDoc.addField(\"count_i\", 20);\n      cmd.solrDoc.addField(\"name_s\", \"Virat\");\n      cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n      h.getCore()\n          .getUpdateProcessorChain(params)\n          .createProcessor(cmd.getReq(), new SolrQueryResponse())\n          .processAdd(cmd);\n    }\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add-distinct\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    try (SolrQueryRequest req = new LocalSolrQueryRequest(h.getCore(), params)) {\n      AddUpdateCommand cmd = new AddUpdateCommand(req);\n\n      cmd.solrDoc = new SolrInputDocument();\n      cmd.solrDoc.addField(\"id\", 1);\n      cmd.solrDoc.addField(\"cat\", Arrays.asList(new String[]{\"human\", \"human\", \"animal\", \"animal\"}));\n      cmd.solrDoc.addField(\"title\", \"Dr\");\n      cmd.solrDoc.addField(\"count_i\", 20);\n      cmd.solrDoc.addField(\"name_s\", \"Virat\");\n      cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n      h.getCore()\n          .getUpdateProcessorChain(params)\n          .createProcessor(cmd.getReq(), new SolrQueryResponse())\n          .processAdd(cmd);\n    }\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(req(\"q\", \"id:1\", \"indent\", \"true\"),\n        \"//doc/arr[@name='cat'][count(str)=2]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","sourceOld":"  public void testBasics() throws Exception {\n\n    ModifiableSolrParams params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"set\")\n        .add(\"atomic.name_s\", \"set\")\n        .add(\"atomic.multiDefault\", \"set\")\n        .add(\"commit\", \"true\");\n    AddUpdateCommand cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(),\n        params\n    ));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", \"human\");\n    cmd.solrDoc.addField(\"title\", \"Mr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \"Delhi\");\n\n    UpdateRequestProcessor chain = h.getCore()\n        .getUpdateProcessorChain(params)\n        .createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=1]\");\n\n    params = new ModifiableSolrParams()\n        .add(\"processor\", \"atomic\")\n        .add(\"atomic.cat\", \"add-distinct\")\n        .add(\"atomic.title\", \"set\")\n        .add(\"atomic.count_i\", \"inc\")\n        .add(\"atomic.name_s\", \"remove\")\n        .add(\"atomic.multiDefault\", \"removeregex\")\n        .add(\"commit\", \"true\");\n    cmd = new AddUpdateCommand(new LocalSolrQueryRequest(h.getCore(), params));\n\n    cmd.solrDoc = new SolrInputDocument();\n    cmd.solrDoc.addField(\"id\", 1);\n    cmd.solrDoc.addField(\"cat\", Arrays.asList(new String[] {\"human\",\"human\",\"animal\",\"animal\"}));\n    cmd.solrDoc.addField(\"title\", \"Dr\");\n    cmd.solrDoc.addField(\"count_i\", 20);\n    cmd.solrDoc.addField(\"name_s\", \"Virat\");\n    cmd.solrDoc.addField(\"multiDefault\", \".elh.\");\n    chain = h.getCore().getUpdateProcessorChain(params).createProcessor(cmd.getReq(), new SolrQueryResponse());\n    chain.processAdd(cmd);\n\n    assertU(commit());\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"id:1\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:human\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"cat:animal\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(req(\"q\", \"id:1\", \"indent\", \"true\"),\n        \"//doc/arr[@name='cat'][count(str)=2]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Mr\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"title:Dr\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:20\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"count_i:40\")\n        , \"//result[@numFound=1]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"name_s:Virat\")\n        , \"//result[@numFound=0]\");\n\n    assertQ(\"Check the total number of docs\",\n        req(\"q\", \"multiDefault:Delhi\")\n        , \"//result[@numFound=0]\");\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"c03701e1c4c7f814c3e4fb75289fb8e0380f1303":["28288370235ed02234a64753cdbf0c6ec096304a"],"bf62a41dee1ac5d780c26dc793cab09e2a755b6d":["3fa95fb629298e03fe5e3d71a0ce792f1256f711"],"3051d6122751c8f6cc1e9cf24592658b59843ec2":["2a3ed3f77cdd034e789d00d1ca8bb7054c9fb8e9","c03701e1c4c7f814c3e4fb75289fb8e0380f1303"],"a92ffe0d2961113e5588e614f8dc22b42bf10a95":["28288370235ed02234a64753cdbf0c6ec096304a","c03701e1c4c7f814c3e4fb75289fb8e0380f1303"],"28288370235ed02234a64753cdbf0c6ec096304a":["f1de703f36b1071144037c80ca5fe118aa5e96fd","526bbf21a282a0aeaa55d4963d2646fd87ea5722"],"526bbf21a282a0aeaa55d4963d2646fd87ea5722":["f1de703f36b1071144037c80ca5fe118aa5e96fd"],"e9017cf144952056066919f1ebc7897ff9bd71b1":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","f1de703f36b1071144037c80ca5fe118aa5e96fd"],"3fa95fb629298e03fe5e3d71a0ce792f1256f711":["a92ffe0d2961113e5588e614f8dc22b42bf10a95","29cfba4d094f887719559c63c9018157a6d41462"],"29cfba4d094f887719559c63c9018157a6d41462":["a92ffe0d2961113e5588e614f8dc22b42bf10a95"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"f1de703f36b1071144037c80ca5fe118aa5e96fd":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"2a3ed3f77cdd034e789d00d1ca8bb7054c9fb8e9":["e9017cf144952056066919f1ebc7897ff9bd71b1","526bbf21a282a0aeaa55d4963d2646fd87ea5722"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["bf62a41dee1ac5d780c26dc793cab09e2a755b6d"]},"commit2Childs":{"c03701e1c4c7f814c3e4fb75289fb8e0380f1303":["3051d6122751c8f6cc1e9cf24592658b59843ec2","a92ffe0d2961113e5588e614f8dc22b42bf10a95"],"bf62a41dee1ac5d780c26dc793cab09e2a755b6d":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"3051d6122751c8f6cc1e9cf24592658b59843ec2":[],"a92ffe0d2961113e5588e614f8dc22b42bf10a95":["3fa95fb629298e03fe5e3d71a0ce792f1256f711","29cfba4d094f887719559c63c9018157a6d41462"],"28288370235ed02234a64753cdbf0c6ec096304a":["c03701e1c4c7f814c3e4fb75289fb8e0380f1303","a92ffe0d2961113e5588e614f8dc22b42bf10a95"],"526bbf21a282a0aeaa55d4963d2646fd87ea5722":["28288370235ed02234a64753cdbf0c6ec096304a","2a3ed3f77cdd034e789d00d1ca8bb7054c9fb8e9"],"e9017cf144952056066919f1ebc7897ff9bd71b1":["2a3ed3f77cdd034e789d00d1ca8bb7054c9fb8e9"],"3fa95fb629298e03fe5e3d71a0ce792f1256f711":["bf62a41dee1ac5d780c26dc793cab09e2a755b6d"],"29cfba4d094f887719559c63c9018157a6d41462":["3fa95fb629298e03fe5e3d71a0ce792f1256f711"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["e9017cf144952056066919f1ebc7897ff9bd71b1","f1de703f36b1071144037c80ca5fe118aa5e96fd"],"f1de703f36b1071144037c80ca5fe118aa5e96fd":["28288370235ed02234a64753cdbf0c6ec096304a","526bbf21a282a0aeaa55d4963d2646fd87ea5722","e9017cf144952056066919f1ebc7897ff9bd71b1"],"2a3ed3f77cdd034e789d00d1ca8bb7054c9fb8e9":["3051d6122751c8f6cc1e9cf24592658b59843ec2"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["3051d6122751c8f6cc1e9cf24592658b59843ec2","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}