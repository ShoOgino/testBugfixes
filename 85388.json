{"path":"solr/core/src/test/org/apache/solr/update/PeerSyncWithIndexFingerprintCachingTest#test().mjava","commits":[{"id":"b11122ff28c20e6e4e02cb1366eaa029a92f69ce","date":1477307742,"type":0,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/PeerSyncWithIndexFingerprintCachingTest#test().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  @ShardsFixed(num = 3)\n  public void test() throws Exception {\n    handle.clear();\n    handle.put(\"timestamp\", SKIPVAL);\n    handle.put(\"score\", SKIPVAL);\n    handle.put(\"maxScore\", SKIPVAL);\n\n    SolrClient client0 = clients.get(0);\n    SolrClient client1 = clients.get(1);\n\n    long v =1;\n    for(; v < 8; ++v) {\n      add(client0, seenLeader, sdoc(\"id\", \"\"+v,\"_version_\",v));\n      add(client1, seenLeader, sdoc(\"id\",\"\"+v,\"_version_\",v));\n      \n    }\n    client0.commit(); client1.commit();\n    \n    IndexFingerprint before = getFingerprint(client0, Long.MAX_VALUE);\n    \n    del(client0, params(DISTRIB_UPDATE_PARAM,FROM_LEADER,\"_version_\",Long.toString(-++v)), \"2\");\n    client0.commit(); \n    \n    IndexFingerprint after = getFingerprint(client0, Long.MAX_VALUE);\n   \n    // make sure fingerprint before and after deleting are not the same\n    Assert.assertTrue(IndexFingerprint.compare(before, after) != 0);\n    \n    // replica which missed the delete should be able to sync\n    assertSync(client1, numVersions, true, shardsArr[0]);\n    client0.commit(); client1.commit();  \n\n    queryAndCompare(params(\"q\", \"*:*\", \"sort\",\"_version_ desc\"), client0, client1);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"80d0e6d59ae23f4a6f30eaf40bfb40742300287f","date":1477598926,"type":0,"author":"Kevin Risden","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/PeerSyncWithIndexFingerprintCachingTest#test().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  @ShardsFixed(num = 3)\n  public void test() throws Exception {\n    handle.clear();\n    handle.put(\"timestamp\", SKIPVAL);\n    handle.put(\"score\", SKIPVAL);\n    handle.put(\"maxScore\", SKIPVAL);\n\n    SolrClient client0 = clients.get(0);\n    SolrClient client1 = clients.get(1);\n\n    long v =1;\n    for(; v < 8; ++v) {\n      add(client0, seenLeader, sdoc(\"id\", \"\"+v,\"_version_\",v));\n      add(client1, seenLeader, sdoc(\"id\",\"\"+v,\"_version_\",v));\n      \n    }\n    client0.commit(); client1.commit();\n    \n    IndexFingerprint before = getFingerprint(client0, Long.MAX_VALUE);\n    \n    del(client0, params(DISTRIB_UPDATE_PARAM,FROM_LEADER,\"_version_\",Long.toString(-++v)), \"2\");\n    client0.commit(); \n    \n    IndexFingerprint after = getFingerprint(client0, Long.MAX_VALUE);\n   \n    // make sure fingerprint before and after deleting are not the same\n    Assert.assertTrue(IndexFingerprint.compare(before, after) != 0);\n    \n    // replica which missed the delete should be able to sync\n    assertSync(client1, numVersions, true, shardsArr[0]);\n    client0.commit(); client1.commit();  \n\n    queryAndCompare(params(\"q\", \"*:*\", \"sort\",\"_version_ desc\"), client0, client1);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"b11122ff28c20e6e4e02cb1366eaa029a92f69ce":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"80d0e6d59ae23f4a6f30eaf40bfb40742300287f":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","b11122ff28c20e6e4e02cb1366eaa029a92f69ce"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["b11122ff28c20e6e4e02cb1366eaa029a92f69ce"]},"commit2Childs":{"b11122ff28c20e6e4e02cb1366eaa029a92f69ce":["80d0e6d59ae23f4a6f30eaf40bfb40742300287f","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b11122ff28c20e6e4e02cb1366eaa029a92f69ce","80d0e6d59ae23f4a6f30eaf40bfb40742300287f"],"80d0e6d59ae23f4a6f30eaf40bfb40742300287f":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["80d0e6d59ae23f4a6f30eaf40bfb40742300287f","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}