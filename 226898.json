{"path":"lucene/core/src/test/org/apache/lucene/index/TestIndexSorting#testBadDVUpdate().mjava","commits":[{"id":"65233715955663909ad948e05aa3fed614f4a57b","date":1481324713,"type":0,"author":"Mike McCandless","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexSorting#testBadDVUpdate().mjava","pathOld":"/dev/null","sourceNew":"  // docvalues fields involved in the index sort cannot be updated\n  public void testBadDVUpdate() throws Exception {\n    Directory dir = newDirectory();\n    IndexWriterConfig iwc = new IndexWriterConfig(new MockAnalyzer(random()));\n    Sort indexSort = new Sort(new SortField(\"foo\", SortField.Type.LONG));\n    iwc.setIndexSort(indexSort);\n    IndexWriter w = new IndexWriter(dir, iwc);\n    Document doc = new Document();\n    doc.add(new StringField(\"id\", new BytesRef(\"0\"), Store.NO));\n    doc.add(new NumericDocValuesField(\"foo\", random().nextInt()));\n    w.addDocument(doc);\n    w.commit();\n    IllegalArgumentException exc = expectThrows(IllegalArgumentException.class,\n        () -> w.updateDocValues(new Term(\"id\", \"0\"), new NumericDocValuesField(\"foo\", -1)));\n    assertEquals(exc.getMessage(), \"cannot update docvalues field involved in the index sort, field=foo, sort=<long: \\\"foo\\\">\");\n    exc = expectThrows(IllegalArgumentException.class,\n        () -> w.updateNumericDocValue(new Term(\"id\", \"0\"), \"foo\", -1));\n    assertEquals(exc.getMessage(), \"cannot update docvalues field involved in the index sort, field=foo, sort=<long: \\\"foo\\\">\");\n    w.close();\n    dir.close();\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"9856095f7afb5a607bf5e65077615ed91273508c","date":1481837697,"type":0,"author":"Kevin Risden","isMerge":true,"pathNew":"lucene/core/src/test/org/apache/lucene/index/TestIndexSorting#testBadDVUpdate().mjava","pathOld":"/dev/null","sourceNew":"  // docvalues fields involved in the index sort cannot be updated\n  public void testBadDVUpdate() throws Exception {\n    Directory dir = newDirectory();\n    IndexWriterConfig iwc = new IndexWriterConfig(new MockAnalyzer(random()));\n    Sort indexSort = new Sort(new SortField(\"foo\", SortField.Type.LONG));\n    iwc.setIndexSort(indexSort);\n    IndexWriter w = new IndexWriter(dir, iwc);\n    Document doc = new Document();\n    doc.add(new StringField(\"id\", new BytesRef(\"0\"), Store.NO));\n    doc.add(new NumericDocValuesField(\"foo\", random().nextInt()));\n    w.addDocument(doc);\n    w.commit();\n    IllegalArgumentException exc = expectThrows(IllegalArgumentException.class,\n        () -> w.updateDocValues(new Term(\"id\", \"0\"), new NumericDocValuesField(\"foo\", -1)));\n    assertEquals(exc.getMessage(), \"cannot update docvalues field involved in the index sort, field=foo, sort=<long: \\\"foo\\\">\");\n    exc = expectThrows(IllegalArgumentException.class,\n        () -> w.updateNumericDocValue(new Term(\"id\", \"0\"), \"foo\", -1));\n    assertEquals(exc.getMessage(), \"cannot update docvalues field involved in the index sort, field=foo, sort=<long: \\\"foo\\\">\");\n    w.close();\n    dir.close();\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"65233715955663909ad948e05aa3fed614f4a57b":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"9856095f7afb5a607bf5e65077615ed91273508c":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","65233715955663909ad948e05aa3fed614f4a57b"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["65233715955663909ad948e05aa3fed614f4a57b"]},"commit2Childs":{"65233715955663909ad948e05aa3fed614f4a57b":["9856095f7afb5a607bf5e65077615ed91273508c","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["65233715955663909ad948e05aa3fed614f4a57b","9856095f7afb5a607bf5e65077615ed91273508c"],"9856095f7afb5a607bf5e65077615ed91273508c":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["9856095f7afb5a607bf5e65077615ed91273508c","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}