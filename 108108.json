{"path":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnAdd().mjava","commits":[{"id":"818d704eaaf0fba0561d0d2752832e1015053482","date":1327419676,"type":1,"author":"Jan HÃ¸ydahl","isMerge":false,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnAdd().mjava","pathOld":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithin().mjava","sourceNew":"  /**\n   * query the example\n   */\n @Test\n public void testCommitWithinOnAdd() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now try a timed commit...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    UpdateRequest up = new UpdateRequest();\n    up.add( doc3 );\n    up.setCommitWithin( 500 );  // a smaller commitWithin caused failures on the following assert\n    up.process( server );\n    \n    rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n    \n    // TODO: not a great way to test this - timing is easily out\n    // of whack due to parallel tests and various computer specs/load\n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    \n    int cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // Now test the new convenience parameter on the add() for commitWithin\n    SolrInputDocument doc4 = new SolrInputDocument();\n    doc4.addField( \"id\", \"id4\", 1.0f );\n    doc4.addField( \"name\", \"doc4\", 1.0f );\n    doc4.addField( \"price\", 10 );\n    server.add(doc4, 500);\n    \n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id4\") );\n\n    cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n  }\n\n","sourceOld":"  /**\n   * query the example\n   */\n @Test\n public void testCommitWithin() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now try a timed commit...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    UpdateRequest up = new UpdateRequest();\n    up.add( doc3 );\n    up.setCommitWithin( 500 );  // a smaller commitWithin caused failures on the following assert\n    up.process( server );\n    \n    rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n    \n    // TODO: not a great way to test this - timing is easily out\n    // of whack due to parallel tests and various computer specs/load\n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    \n    int cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n\n    // Now test the new convenience parameter on the add() for commitWithin\n    SolrInputDocument doc4 = new SolrInputDocument();\n    doc4.addField( \"id\", \"id4\", 1.0f );\n    doc4.addField( \"name\", \"doc4\", 1.0f );\n    doc4.addField( \"price\", 10 );\n    server.add(doc4, 500);\n    \n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id4\") );\n\n    cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d","date":1327523564,"type":0,"author":"Robert Muir","isMerge":true,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnAdd().mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * query the example\n   */\n @Test\n public void testCommitWithinOnAdd() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now try a timed commit...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    UpdateRequest up = new UpdateRequest();\n    up.add( doc3 );\n    up.setCommitWithin( 500 );  // a smaller commitWithin caused failures on the following assert\n    up.process( server );\n    \n    rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n    \n    // TODO: not a great way to test this - timing is easily out\n    // of whack due to parallel tests and various computer specs/load\n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    \n    int cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // Now test the new convenience parameter on the add() for commitWithin\n    SolrInputDocument doc4 = new SolrInputDocument();\n    doc4.addField( \"id\", \"id4\", 1.0f );\n    doc4.addField( \"name\", \"doc4\", 1.0f );\n    doc4.addField( \"price\", 10 );\n    server.add(doc4, 500);\n    \n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id4\") );\n\n    cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"0d22ac6a4146774c1bc8400160fc0b6150294e92","date":1327528604,"type":0,"author":"Uwe Schindler","isMerge":true,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnAdd().mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * query the example\n   */\n @Test\n public void testCommitWithinOnAdd() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now try a timed commit...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    UpdateRequest up = new UpdateRequest();\n    up.add( doc3 );\n    up.setCommitWithin( 500 );  // a smaller commitWithin caused failures on the following assert\n    up.process( server );\n    \n    rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n    \n    // TODO: not a great way to test this - timing is easily out\n    // of whack due to parallel tests and various computer specs/load\n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    \n    int cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // Now test the new convenience parameter on the add() for commitWithin\n    SolrInputDocument doc4 = new SolrInputDocument();\n    doc4.addField( \"id\", \"id4\", 1.0f );\n    doc4.addField( \"name\", \"doc4\", 1.0f );\n    doc4.addField( \"price\", 10 );\n    server.add(doc4, 500);\n    \n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id4\") );\n\n    cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"98a20a1a0f02e19e5121d1b5d95f5af857d609ef","date":1382205865,"type":5,"author":"Mark Robert Miller","isMerge":false,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTestsBase#testCommitWithinOnAdd().mjava","pathOld":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnAdd().mjava","sourceNew":"  /**\n   * query the example\n   */\n  @Test\n  public void testCommitWithinOnAdd() throws Exception {\n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery(\"*:*\");// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query(new SolrQuery(\"*:*\"));\n    Assert.assertEquals(0, rsp.getResults().getNumFound());\n    \n    // Now try a timed commit...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField(\"id\", \"id3\", 1.0f);\n    doc3.addField(\"name\", \"doc3\", 1.0f);\n    doc3.addField(\"price\", 10);\n    UpdateRequest up = new UpdateRequest();\n    up.add(doc3);\n    up.setCommitWithin(500); // a smaller commitWithin caused failures on the\n                             // following assert\n    up.process(server);\n    \n    rsp = server.query(new SolrQuery(\"*:*\"));\n    Assert.assertEquals(0, rsp.getResults().getNumFound());\n    \n    // TODO: not a great way to test this - timing is easily out\n    // of whack due to parallel tests and various computer specs/load\n    Thread.sleep(1000); // wait 1 sec\n    \n    // now check that it comes out...\n    rsp = server.query(new SolrQuery(\"id:id3\"));\n    \n    int cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep(2000); // wait 2 seconds...\n      \n      rsp = server.query(new SolrQuery(\"id:id3\"));\n    }\n    \n    Assert.assertEquals(1, rsp.getResults().getNumFound());\n    \n    // Now test the new convenience parameter on the add() for commitWithin\n    SolrInputDocument doc4 = new SolrInputDocument();\n    doc4.addField(\"id\", \"id4\", 1.0f);\n    doc4.addField(\"name\", \"doc4\", 1.0f);\n    doc4.addField(\"price\", 10);\n    server.add(doc4, 500);\n    \n    Thread.sleep(1000); // wait 1 sec\n    \n    // now check that it comes out...\n    rsp = server.query(new SolrQuery(\"id:id4\"));\n    \n    cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep(2000); // wait 2 seconds...\n      \n      rsp = server.query(new SolrQuery(\"id:id3\"));\n    }\n    \n    Assert.assertEquals(1, rsp.getResults().getNumFound());\n  }\n\n","sourceOld":"  /**\n   * query the example\n   */\n @Test\n public void testCommitWithinOnAdd() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now try a timed commit...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    UpdateRequest up = new UpdateRequest();\n    up.add( doc3 );\n    up.setCommitWithin( 500 );  // a smaller commitWithin caused failures on the following assert\n    up.process( server );\n    \n    rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n    \n    // TODO: not a great way to test this - timing is easily out\n    // of whack due to parallel tests and various computer specs/load\n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    \n    int cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // Now test the new convenience parameter on the add() for commitWithin\n    SolrInputDocument doc4 = new SolrInputDocument();\n    doc4.addField( \"id\", \"id4\", 1.0f );\n    doc4.addField( \"name\", \"doc4\", 1.0f );\n    doc4.addField( \"price\", 10 );\n    server.add(doc4, 500);\n    \n    Thread.sleep( 1000 ); // wait 1 sec\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id4\") );\n\n    cnt = 0;\n    while (rsp.getResults().getNumFound() == 0) {\n      // wait and try again for slower/busier machines\n      // and/or parallel test effects.\n      \n      if (cnt++ == 10) {\n        break;\n      }\n      \n      Thread.sleep( 2000 ); // wait 2 seconds...\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n    }\n    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"98a20a1a0f02e19e5121d1b5d95f5af857d609ef":["818d704eaaf0fba0561d0d2752832e1015053482"],"0d22ac6a4146774c1bc8400160fc0b6150294e92":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","818d704eaaf0fba0561d0d2752832e1015053482"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","818d704eaaf0fba0561d0d2752832e1015053482"],"818d704eaaf0fba0561d0d2752832e1015053482":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["98a20a1a0f02e19e5121d1b5d95f5af857d609ef"]},"commit2Childs":{"98a20a1a0f02e19e5121d1b5d95f5af857d609ef":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"0d22ac6a4146774c1bc8400160fc0b6150294e92":[],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["0d22ac6a4146774c1bc8400160fc0b6150294e92","a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d","818d704eaaf0fba0561d0d2752832e1015053482"],"a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d":[],"818d704eaaf0fba0561d0d2752832e1015053482":["98a20a1a0f02e19e5121d1b5d95f5af857d609ef","0d22ac6a4146774c1bc8400160fc0b6150294e92","a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["0d22ac6a4146774c1bc8400160fc0b6150294e92","a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}