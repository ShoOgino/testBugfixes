{"path":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","commits":[{"id":"89205ca052ebf6aadc59a88698d262c718c616ed","date":1465540166,"type":0,"author":"Steve Rowe","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","pathOld":"/dev/null","sourceNew":"  /* SOLR-8812 */\n  @Test\n  public void testDefaultMM() throws Exception {\n    // Ensure MM is off when explicit operators (+/-/OR/NOT) are used and no explicit mm spec is specified.\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit 'or' in query with lowercaseOperators=true, no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil or stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair and ties barbie\",\n            \"qf\", \"text_sw\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n\n    assertQ(\"Explicit '+' operator in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair ties +barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"4cce5816ef15a48a0bc11e5d400497ee4301dd3b","date":1476991456,"type":0,"author":"Kevin Risden","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","pathOld":"/dev/null","sourceNew":"  /* SOLR-8812 */\n  @Test\n  public void testDefaultMM() throws Exception {\n    // Ensure MM is off when explicit operators (+/-/OR/NOT) are used and no explicit mm spec is specified.\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit 'or' in query with lowercaseOperators=true, no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil or stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair and ties barbie\",\n            \"qf\", \"text_sw\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n\n    assertQ(\"Explicit '+' operator in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair ties +barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"e55782fb51a6e9789542818eb2161a3247f39ace","date":1489707707,"type":3,"author":"Steve Rowe","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","pathOld":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","sourceNew":"  /* SOLR-8812 */\n  @Test\n  public void testDefaultMM() throws Exception {\n    // Ensure MM is off when explicit operators (+/-/OR/NOT) are used and no explicit mm spec is specified.\n    for (String sow : Arrays.asList(\"true\", \"false\")) {\n      assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"oil OR stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"Explicit 'or' in query with lowercaseOperators=true, no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"oil or stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"lowercaseOperators\", \"true\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"oil OR stocks\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"oil stocks\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"No operator in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"oil stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"oil stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair ties NOT barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair ties NOT barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair AND ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair AND ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair AND ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=2]\");\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"hair AND ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair AND ties barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=2]\");\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair and ties barbie\",\n              \"qf\", \"text_sw\",\n              \"lowercaseOperators\", \"true\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=2]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"hair ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"hair ties NOT barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n\n      assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"hair OR ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n      assertQ(\"Explicit OR in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair OR ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=6]\");\n      assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair OR ties barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=6]\");\n\n      assertQ(\"Explicit '+' operator in query with no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"hair ties +barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n    }\n  }\n\n","sourceOld":"  /* SOLR-8812 */\n  @Test\n  public void testDefaultMM() throws Exception {\n    // Ensure MM is off when explicit operators (+/-/OR/NOT) are used and no explicit mm spec is specified.\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit 'or' in query with lowercaseOperators=true, no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil or stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair and ties barbie\",\n            \"qf\", \"text_sw\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n\n    assertQ(\"Explicit '+' operator in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair ties +barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"c03778630c4604270d88c148afb8c7de35b51d3c","date":1490280010,"type":3,"author":"Steve Rowe","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","pathOld":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser#testDefaultMM().mjava","sourceNew":"  /* SOLR-8812 */\n  @Test\n  public void testDefaultMM() throws Exception {\n    // Ensure MM is off when explicit operators (+/-/OR/NOT) are used and no explicit mm spec is specified.\n    for (String sow : Arrays.asList(\"true\", \"false\")) {\n      assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"oil OR stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"Explicit 'or' in query with lowercaseOperators=true, no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"oil or stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"lowercaseOperators\", \"true\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"oil OR stocks\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"oil stocks\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n      assertQ(\"No operator in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"oil stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"oil stocks\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=4]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair ties NOT barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair ties NOT barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair AND ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair AND ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair AND ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=2]\");\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"hair AND ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair AND ties barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=2]\");\n      assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair and ties barbie\",\n              \"qf\", \"text_sw\",\n              \"lowercaseOperators\", \"true\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=2]\");\n\n      assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"hair ties -barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n      assertQ(\"Explicit NOT in query with no explicit mm and q.op=AND => mm = 100%\",\n          req(\"q\", \"hair ties NOT barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n\n      assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"hair OR ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=3]\");\n      assertQ(\"Explicit OR in query with no explicit mm and q.op=OR => mm = 0%\",\n          req(\"q\", \"hair OR ties barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"OR\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=6]\");\n      assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n          req(\"q\", \"hair OR ties barbie\",\n              \"qf\", \"text_sw\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=6]\");\n\n      assertQ(\"Explicit '+' operator in query with no explicit mm and q.op=AND => mm = 0%\",\n          req(\"q\", \"hair ties +barbie\",\n              \"qf\", \"text_sw\",\n              \"q.op\", \"AND\",\n              \"sow\", sow,\n              \"defType\", \"edismax\")\n          , \"*[count(//doc)=1]\");\n    }\n  }\n\n","sourceOld":"  /* SOLR-8812 */\n  @Test\n  public void testDefaultMM() throws Exception {\n    // Ensure MM is off when explicit operators (+/-/OR/NOT) are used and no explicit mm spec is specified.\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit 'or' in query with lowercaseOperators=true, no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"oil or stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"oil OR stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"oil stocks\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=4]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair AND ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n    assertQ(\"No explicit non-AND operator in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair and ties barbie\",\n            \"qf\", \"text_sw\",\n            \"lowercaseOperators\", \"true\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=2]\");\n\n    assertQ(\"Explicit '-' operator in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties -barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n    assertQ(\"Explicit NOT in query with no explicit mm and q.op=AND => mm = 100%\",\n        req(\"q\", \"hair ties NOT barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=3]\");\n    assertQ(\"Explicit OR in query with no explicit mm and q.op=OR => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"OR\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n    assertQ(\"Explicit OR in query with no explicit mm and no explicit q.op => mm = 0%\",\n        req(\"q\", \"hair OR ties barbie\",\n            \"qf\", \"text_sw\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=6]\");\n\n    assertQ(\"Explicit '+' operator in query with no explicit mm and q.op=AND => mm = 0%\",\n        req(\"q\", \"hair ties +barbie\",\n            \"qf\", \"text_sw\",\n            \"q.op\", \"AND\",\n            \"defType\", \"edismax\")\n        , \"*[count(//doc)=1]\");\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"89205ca052ebf6aadc59a88698d262c718c616ed":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"c03778630c4604270d88c148afb8c7de35b51d3c":["89205ca052ebf6aadc59a88698d262c718c616ed"],"e55782fb51a6e9789542818eb2161a3247f39ace":["89205ca052ebf6aadc59a88698d262c718c616ed"],"4cce5816ef15a48a0bc11e5d400497ee4301dd3b":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","89205ca052ebf6aadc59a88698d262c718c616ed"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["e55782fb51a6e9789542818eb2161a3247f39ace"]},"commit2Childs":{"89205ca052ebf6aadc59a88698d262c718c616ed":["c03778630c4604270d88c148afb8c7de35b51d3c","e55782fb51a6e9789542818eb2161a3247f39ace","4cce5816ef15a48a0bc11e5d400497ee4301dd3b"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["89205ca052ebf6aadc59a88698d262c718c616ed","4cce5816ef15a48a0bc11e5d400497ee4301dd3b"],"c03778630c4604270d88c148afb8c7de35b51d3c":[],"e55782fb51a6e9789542818eb2161a3247f39ace":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"4cce5816ef15a48a0bc11e5d400497ee4301dd3b":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["c03778630c4604270d88c148afb8c7de35b51d3c","4cce5816ef15a48a0bc11e5d400497ee4301dd3b","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}