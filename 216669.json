{"path":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","commits":[{"id":"17f9c12074f42db9f3cff34b42f9c4a60368a97d","date":1216926137,"type":1,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","pathOld":"src/test/org/apache/solr/BasicFunctionalityTest#testSimpleFacetCounts().mjava","sourceNew":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n \n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","sourceOld":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n \n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"9cb179b2fab2183d2f6041e450ff8022c592ecf0","date":1229553695,"type":3,"author":"Yonik Seeley","isMerge":false,"pathNew":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","pathOld":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","sourceNew":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check multi-select facets with naming\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"{!ex=1}trait_s:Obnoxious\"\n                ,\"facet.query\", \"{!ex=2 key=foo}id:[42 TO 45]\"    // tag=2 same as 1\n                ,\"facet.query\", \"{!ex=3,4 key=bar}id:[43 TO 47]\"  // tag=3,4 don't exist\n                ,\"facet.field\", \"{!ex=3,1}trait_s\"                // 3,1 same as 1\n                ,\"fq\", \"{!tag=1,2}id:47\"                          // tagged as 1 and 2\n                )\n            ,\"*[count(//doc)=1]\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='{!ex=1}trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='foo'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='bar'][.='1']\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","sourceOld":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n \n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"3c008338f79bd89b144d1fc8a57a39060df14b67","date":1243431296,"type":3,"author":"Yonik Seeley","isMerge":false,"pathNew":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","pathOld":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","sourceNew":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(commit());\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(commit());\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check multi-select facets with naming\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"{!ex=1}trait_s:Obnoxious\"\n                ,\"facet.query\", \"{!ex=2 key=foo}id:[42 TO 45]\"    // tag=2 same as 1\n                ,\"facet.query\", \"{!ex=3,4 key=bar}id:[43 TO 47]\"  // tag=3,4 don't exist\n                ,\"facet.field\", \"{!ex=3,1}trait_s\"                // 3,1 same as 1\n                ,\"fq\", \"{!tag=1,2}id:47\"                          // tagged as 1 and 2\n                )\n            ,\"*[count(//doc)=1]\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='{!ex=1}trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='foo'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='bar'][.='1']\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","sourceOld":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check multi-select facets with naming\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"{!ex=1}trait_s:Obnoxious\"\n                ,\"facet.query\", \"{!ex=2 key=foo}id:[42 TO 45]\"    // tag=2 same as 1\n                ,\"facet.query\", \"{!ex=3,4 key=bar}id:[43 TO 47]\"  // tag=3,4 don't exist\n                ,\"facet.field\", \"{!ex=3,1}trait_s\"                // 3,1 same as 1\n                ,\"fq\", \"{!tag=1,2}id:47\"                          // tagged as 1 and 2\n                )\n            ,\"*[count(//doc)=1]\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='{!ex=1}trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='foo'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='bar'][.='1']\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ad94625fb8d088209f46650c8097196fec67f00c","date":1453508319,"type":5,"author":"Dawid Weiss","isMerge":false,"pathNew":"solr/src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","pathOld":"src/test/org/apache/solr/request/SimpleFacetsTest#testSimpleFacetCounts().mjava","sourceNew":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(commit());\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(commit());\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check multi-select facets with naming\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"{!ex=1}trait_s:Obnoxious\"\n                ,\"facet.query\", \"{!ex=2 key=foo}id:[42 TO 45]\"    // tag=2 same as 1\n                ,\"facet.query\", \"{!ex=3,4 key=bar}id:[43 TO 47]\"  // tag=3,4 don't exist\n                ,\"facet.field\", \"{!ex=3,1}trait_s\"                // 3,1 same as 1\n                ,\"fq\", \"{!tag=1,2}id:47\"                          // tagged as 1 and 2\n                )\n            ,\"*[count(//doc)=1]\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='{!ex=1}trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='foo'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='bar'][.='1']\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","sourceOld":"  public void testSimpleFacetCounts() {\n    assertU(adoc(\"id\", \"42\", \"trait_s\", \"Tool\", \"trait_s\", \"Obnoxious\",\n                 \"name\", \"Zapp Brannigan\"));\n    assertU(adoc(\"id\", \"43\" ,\n                 \"title\", \"Democratic Order of Planets\"));\n    assertU(commit());\n    assertU(adoc(\"id\", \"44\", \"trait_s\", \"Tool\",\n                 \"name\", \"The Zapper\"));\n    assertU(adoc(\"id\", \"45\", \"trait_s\", \"Chauvinist\",\n                 \"title\", \"25 star General\"));\n    assertU(adoc(\"id\", \"46\", \"trait_s\", \"Obnoxious\",\n                 \"subject\", \"Defeated the pacifists of the Gandhi nebula\"));\n    assertU(commit());\n    assertU(adoc(\"id\", \"47\", \"trait_s\", \"Pig\",\n                 \"text\", \"line up and fly directly at the enemy death cannons, clogging them with wreckage!\"));\n    assertU(commit());\n \n    assertQ(\"standard request handler returns all matches\",\n            req(\"id:[42 TO 47]\"),\n            \"*[count(//doc)=6]\"\n            );\n \n    assertQ(\"filter results using fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=4]\"\n            );\n    \n    assertQ(\"don't filter results using blank fq\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \" \"),\n            \"*[count(//doc)=5]\"\n            );\n     \n    assertQ(\"filter results using multiple fq params\",\n            req(\"q\",\"id:[42 TO 46]\",\n                \"fq\", \"trait_s:Obnoxious\",\n                \"fq\", \"id:[43 TO 47]\"),\n            \"*[count(//doc)=1]\"\n            );\n \n    assertQ(\"check counts for facet queries\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"trait_s:Obnoxious\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=6]\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='5']\"\n \n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check multi-select facets with naming\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.query\", \"{!ex=1}trait_s:Obnoxious\"\n                ,\"facet.query\", \"{!ex=2 key=foo}id:[42 TO 45]\"    // tag=2 same as 1\n                ,\"facet.query\", \"{!ex=3,4 key=bar}id:[43 TO 47]\"  // tag=3,4 don't exist\n                ,\"facet.field\", \"{!ex=3,1}trait_s\"                // 3,1 same as 1\n                ,\"fq\", \"{!tag=1,2}id:47\"                          // tagged as 1 and 2\n                )\n            ,\"*[count(//doc)=1]\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='{!ex=1}trait_s:Obnoxious'][.='2']\"\n            ,\"//lst[@name='facet_queries']/int[@name='foo'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='bar'][.='1']\"\n\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_fields']\"\n            ,\"//lst[@name='facet_fields']/lst[@name='trait_s']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='1']\"\n            );\n\n    assertQ(\"check counts for applied facet queries using filtering (fq)\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.query\", \"id:[42 TO 45]\"\n                ,\"facet.query\", \"id:[43 TO 47]\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"//lst[@name='facet_counts']/lst[@name='facet_queries']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[42 TO 45]'][.='4']\"\n            ,\"//lst[@name='facet_queries']/int[@name='id:[43 TO 47]'][.='3']\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n \n    assertQ(\"check counts with facet.zero=false&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.zeros\", \"false\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=1&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"1\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"\n            );\n\n    assertQ(\"check counts with facet.mincount=2&facet.missing=true using fq\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"facet.mincount\", \"2\"\n                ,\"f.trait_s.facet.missing\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                )\n            ,\"*[count(//doc)=4]\"\n            ,\"*[count(//lst[@name='trait_s']/int)=2]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[not(@name)][.='1']\"               \n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"4\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=4]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Pig'][.='0']\"\n            );\n\n    assertQ(\"check sorted paging\",\n            req(\"q\", \"id:[42 TO 47]\"\n                ,\"facet\", \"true\"\n                ,\"fq\", \"id:[42 TO 45]\"\n                ,\"facet.field\", \"trait_s\"\n                ,\"facet.mincount\",\"0\"\n                ,\"facet.offset\",\"0\"\n                ,\"facet.limit\",\"3\"\n                )\n            ,\"*[count(//lst[@name='trait_s']/int)=3]\"\n            ,\"//lst[@name='trait_s']/int[@name='Tool'][.='2']\"\n            ,\"//lst[@name='trait_s']/int[@name='Obnoxious'][.='1']\"\n            ,\"//lst[@name='trait_s']/int[@name='Chauvinist'][.='1']\"\n            );\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"3c008338f79bd89b144d1fc8a57a39060df14b67":["9cb179b2fab2183d2f6041e450ff8022c592ecf0"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":[],"9cb179b2fab2183d2f6041e450ff8022c592ecf0":["17f9c12074f42db9f3cff34b42f9c4a60368a97d"],"17f9c12074f42db9f3cff34b42f9c4a60368a97d":["3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b"],"ad94625fb8d088209f46650c8097196fec67f00c":["3c008338f79bd89b144d1fc8a57a39060df14b67"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"]},"commit2Childs":{"3c008338f79bd89b144d1fc8a57a39060df14b67":["ad94625fb8d088209f46650c8097196fec67f00c"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":["17f9c12074f42db9f3cff34b42f9c4a60368a97d"],"9cb179b2fab2183d2f6041e450ff8022c592ecf0":["3c008338f79bd89b144d1fc8a57a39060df14b67"],"17f9c12074f42db9f3cff34b42f9c4a60368a97d":["9cb179b2fab2183d2f6041e450ff8022c592ecf0"],"ad94625fb8d088209f46650c8097196fec67f00c":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["ad94625fb8d088209f46650c8097196fec67f00c","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b"],"pathCommit":null}