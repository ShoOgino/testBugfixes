{"path":"src/java/org/apache/solr/core/SolrCore#readDoc(DocumentBuilder,XmlPullParser).mjava","commits":[{"id":"0c3e228bf650e96f3002a8fb73dd0c13d55af077","date":1138253849,"type":0,"author":"Yonik Seeley","isMerge":false,"pathNew":"src/java/org/apache/solr/core/SolrCore#readDoc(DocumentBuilder,XmlPullParser).mjava","pathOld":"/dev/null","sourceNew":"  private void readDoc(DocumentBuilder builder, XmlPullParser xpp) throws IOException, XmlPullParserException {\n    // xpp should be at <doc> at this point\n\n    builder.startDoc();\n\n    int attrcount = xpp.getAttributeCount();\n    float docBoost = 1.0f;\n\n    for (int i=0; i<attrcount; i++) {\n      String attrName = xpp.getAttributeName(i);\n      String attrVal = xpp.getAttributeValue(i);\n      if (\"boost\".equals(attrName)) {\n        docBoost = Float.parseFloat(attrVal);\n      } else {\n        log.warning(\"Unknown attribute doc/@\" + attrName);\n      }\n    }\n    if (docBoost != 1.0f) builder.setBoost(docBoost);\n\n    // while (findNextTag(xpp,\"field\") != XmlPullParser.END_DOCUMENT) {\n\n    while(true) {\n      int eventType = xpp.nextTag();\n      if (eventType == XmlPullParser.END_TAG) break;  // </doc>\n\n      String tname=xpp.getName();\n      // System.out.println(\"FIELD READER AT TAG \" + tname);\n\n      if (!\"field\".equals(tname)) {\n        log.warning(\"unexpected XML tag doc/\"+tname);\n        throw new SolrException(400,\"unexpected XML tag doc/\"+tname);\n      }\n\n      //\n      // get field name and parse field attributes\n      //\n      attrcount = xpp.getAttributeCount();\n      String name=null;\n      float boost=1.0f;\n      boolean isNull=false;\n\n      for (int i=0; i<attrcount; i++) {\n        String attrName = xpp.getAttributeName(i);\n        String attrVal = xpp.getAttributeValue(i);\n        if (\"name\".equals(attrName)) {\n          name=attrVal;\n        } else if (\"boost\".equals(attrName)) {\n          boost=Float.parseFloat(attrVal);\n        } else if (\"null\".equals(attrName)) {\n          isNull=StrUtils.parseBoolean(attrVal);\n        } else {\n          log.warning(\"Unknown attribute doc/field/@\" + attrName);\n        }\n      }\n\n      // now get the field value\n      String val = xpp.nextText();      // todo... text event for <field></field>???\n                                        // need this line for isNull???\n      // Don't add fields marked as null (for now at least)\n      if (!isNull) {\n        if (docBoost != 1.0f) {\n          builder.addField(name,val,docBoost);\n        } else {\n          builder.addField(name,val);\n        }\n      }\n\n      // do I have to do a nextTag here to read the end_tag?\n\n    } // end field loop\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"f086342d88c71c53801570c03106eee911e995d2","date":1162597451,"type":3,"author":"Mike Klaas","isMerge":false,"pathNew":"src/java/org/apache/solr/core/SolrCore#readDoc(DocumentBuilder,XmlPullParser).mjava","pathOld":"src/java/org/apache/solr/core/SolrCore#readDoc(DocumentBuilder,XmlPullParser).mjava","sourceNew":"  private void readDoc(DocumentBuilder builder, XmlPullParser xpp) throws IOException, XmlPullParserException {\n    // xpp should be at <doc> at this point\n\n    builder.startDoc();\n\n    int attrcount = xpp.getAttributeCount();\n    float docBoost = 1.0f;\n\n    for (int i=0; i<attrcount; i++) {\n      String attrName = xpp.getAttributeName(i);\n      String attrVal = xpp.getAttributeValue(i);\n      if (\"boost\".equals(attrName)) {\n        docBoost = Float.parseFloat(attrVal);\n        builder.setBoost(docBoost);\n      } else {\n        log.warning(\"Unknown attribute doc/@\" + attrName);\n      }\n    }\n    if (docBoost != 1.0f) builder.setBoost(docBoost);\n\n    // while (findNextTag(xpp,\"field\") != XmlPullParser.END_DOCUMENT) {\n\n    while(true) {\n      int eventType = xpp.nextTag();\n      if (eventType == XmlPullParser.END_TAG) break;  // </doc>\n\n      String tname=xpp.getName();\n      // System.out.println(\"FIELD READER AT TAG \" + tname);\n\n      if (!\"field\".equals(tname)) {\n        log.warning(\"unexpected XML tag doc/\"+tname);\n        throw new SolrException(400,\"unexpected XML tag doc/\"+tname);\n      }\n\n      //\n      // get field name and parse field attributes\n      //\n      attrcount = xpp.getAttributeCount();\n      String name=null;\n      float boost=1.0f;\n      boolean isNull=false;\n\n      for (int i=0; i<attrcount; i++) {\n        String attrName = xpp.getAttributeName(i);\n        String attrVal = xpp.getAttributeValue(i);\n        if (\"name\".equals(attrName)) {\n          name=attrVal;\n        } else if (\"boost\".equals(attrName)) {\n          boost=Float.parseFloat(attrVal);\n        } else if (\"null\".equals(attrName)) {\n          isNull=StrUtils.parseBoolean(attrVal);\n        } else {\n          log.warning(\"Unknown attribute doc/field/@\" + attrName);\n        }\n      }\n\n      // now get the field value\n      String val = xpp.nextText();      // todo... text event for <field></field>???\n                                        // need this line for isNull???\n      // Don't add fields marked as null (for now at least)\n      if (!isNull) {\n        if (boost != 1.0f) {\n          builder.addField(name,val,boost);\n        } else {\n          builder.addField(name,val);\n        }\n      }\n\n      // do I have to do a nextTag here to read the end_tag?\n\n    } // end field loop\n\n  }\n\n","sourceOld":"  private void readDoc(DocumentBuilder builder, XmlPullParser xpp) throws IOException, XmlPullParserException {\n    // xpp should be at <doc> at this point\n\n    builder.startDoc();\n\n    int attrcount = xpp.getAttributeCount();\n    float docBoost = 1.0f;\n\n    for (int i=0; i<attrcount; i++) {\n      String attrName = xpp.getAttributeName(i);\n      String attrVal = xpp.getAttributeValue(i);\n      if (\"boost\".equals(attrName)) {\n        docBoost = Float.parseFloat(attrVal);\n      } else {\n        log.warning(\"Unknown attribute doc/@\" + attrName);\n      }\n    }\n    if (docBoost != 1.0f) builder.setBoost(docBoost);\n\n    // while (findNextTag(xpp,\"field\") != XmlPullParser.END_DOCUMENT) {\n\n    while(true) {\n      int eventType = xpp.nextTag();\n      if (eventType == XmlPullParser.END_TAG) break;  // </doc>\n\n      String tname=xpp.getName();\n      // System.out.println(\"FIELD READER AT TAG \" + tname);\n\n      if (!\"field\".equals(tname)) {\n        log.warning(\"unexpected XML tag doc/\"+tname);\n        throw new SolrException(400,\"unexpected XML tag doc/\"+tname);\n      }\n\n      //\n      // get field name and parse field attributes\n      //\n      attrcount = xpp.getAttributeCount();\n      String name=null;\n      float boost=1.0f;\n      boolean isNull=false;\n\n      for (int i=0; i<attrcount; i++) {\n        String attrName = xpp.getAttributeName(i);\n        String attrVal = xpp.getAttributeValue(i);\n        if (\"name\".equals(attrName)) {\n          name=attrVal;\n        } else if (\"boost\".equals(attrName)) {\n          boost=Float.parseFloat(attrVal);\n        } else if (\"null\".equals(attrName)) {\n          isNull=StrUtils.parseBoolean(attrVal);\n        } else {\n          log.warning(\"Unknown attribute doc/field/@\" + attrName);\n        }\n      }\n\n      // now get the field value\n      String val = xpp.nextText();      // todo... text event for <field></field>???\n                                        // need this line for isNull???\n      // Don't add fields marked as null (for now at least)\n      if (!isNull) {\n        if (docBoost != 1.0f) {\n          builder.addField(name,val,docBoost);\n        } else {\n          builder.addField(name,val);\n        }\n      }\n\n      // do I have to do a nextTag here to read the end_tag?\n\n    } // end field loop\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"d80013b5e260def972025c93a0b08524f9c38f49","date":1170102801,"type":5,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"src/java/org/apache/solr/handler/XmlUpdateRequestHandler#readDoc(DocumentBuilder,XmlPullParser).mjava","pathOld":"src/java/org/apache/solr/core/SolrCore#readDoc(DocumentBuilder,XmlPullParser).mjava","sourceNew":"  private void readDoc(DocumentBuilder builder, XmlPullParser xpp) throws IOException, XmlPullParserException {\n    // xpp should be at <doc> at this point\n\n    builder.startDoc();\n\n    int attrcount = xpp.getAttributeCount();\n    float docBoost = 1.0f;\n\n    for (int i=0; i<attrcount; i++) {\n      String attrName = xpp.getAttributeName(i);\n      String attrVal = xpp.getAttributeValue(i);\n      if (\"boost\".equals(attrName)) {\n        docBoost = Float.parseFloat(attrVal);\n        builder.setBoost(docBoost);\n      } else {\n        log.warning(\"Unknown attribute doc/@\" + attrName);\n      }\n    }\n    if (docBoost != 1.0f) builder.setBoost(docBoost);\n\n    // while (findNextTag(xpp,\"field\") != XmlPullParser.END_DOCUMENT) {\n\n    while(true) {\n      int eventType = xpp.nextTag();\n      if (eventType == XmlPullParser.END_TAG) break;  // </doc>\n\n      String tname=xpp.getName();\n      // System.out.println(\"FIELD READER AT TAG \" + tname);\n\n      if (!\"field\".equals(tname)) {\n        log.warning(\"unexpected XML tag doc/\"+tname);\n        throw new SolrException(400,\"unexpected XML tag doc/\"+tname);\n      }\n\n      //\n      // get field name and parse field attributes\n      //\n      attrcount = xpp.getAttributeCount();\n      String name=null;\n      float boost=1.0f;\n      boolean isNull=false;\n\n      for (int i=0; i<attrcount; i++) {\n        String attrName = xpp.getAttributeName(i);\n        String attrVal = xpp.getAttributeValue(i);\n        if (\"name\".equals(attrName)) {\n          name=attrVal;\n        } else if (\"boost\".equals(attrName)) {\n          boost=Float.parseFloat(attrVal);\n        } else if (\"null\".equals(attrName)) {\n          isNull=StrUtils.parseBoolean(attrVal);\n        } else {\n          log.warning(\"Unknown attribute doc/field/@\" + attrName);\n        }\n      }\n\n      // now get the field value\n      String val = xpp.nextText();      // todo... text event for <field></field>???\n                                        // need this line for isNull???\n      // Don't add fields marked as null (for now at least)\n      if (!isNull) {\n        if (boost != 1.0f) {\n          builder.addField(name,val,boost);\n        } else {\n          builder.addField(name,val);\n        }\n      }\n\n      // do I have to do a nextTag here to read the end_tag?\n\n    } // end field loop\n  }\n\n","sourceOld":"  private void readDoc(DocumentBuilder builder, XmlPullParser xpp) throws IOException, XmlPullParserException {\n    // xpp should be at <doc> at this point\n\n    builder.startDoc();\n\n    int attrcount = xpp.getAttributeCount();\n    float docBoost = 1.0f;\n\n    for (int i=0; i<attrcount; i++) {\n      String attrName = xpp.getAttributeName(i);\n      String attrVal = xpp.getAttributeValue(i);\n      if (\"boost\".equals(attrName)) {\n        docBoost = Float.parseFloat(attrVal);\n        builder.setBoost(docBoost);\n      } else {\n        log.warning(\"Unknown attribute doc/@\" + attrName);\n      }\n    }\n    if (docBoost != 1.0f) builder.setBoost(docBoost);\n\n    // while (findNextTag(xpp,\"field\") != XmlPullParser.END_DOCUMENT) {\n\n    while(true) {\n      int eventType = xpp.nextTag();\n      if (eventType == XmlPullParser.END_TAG) break;  // </doc>\n\n      String tname=xpp.getName();\n      // System.out.println(\"FIELD READER AT TAG \" + tname);\n\n      if (!\"field\".equals(tname)) {\n        log.warning(\"unexpected XML tag doc/\"+tname);\n        throw new SolrException(400,\"unexpected XML tag doc/\"+tname);\n      }\n\n      //\n      // get field name and parse field attributes\n      //\n      attrcount = xpp.getAttributeCount();\n      String name=null;\n      float boost=1.0f;\n      boolean isNull=false;\n\n      for (int i=0; i<attrcount; i++) {\n        String attrName = xpp.getAttributeName(i);\n        String attrVal = xpp.getAttributeValue(i);\n        if (\"name\".equals(attrName)) {\n          name=attrVal;\n        } else if (\"boost\".equals(attrName)) {\n          boost=Float.parseFloat(attrVal);\n        } else if (\"null\".equals(attrName)) {\n          isNull=StrUtils.parseBoolean(attrVal);\n        } else {\n          log.warning(\"Unknown attribute doc/field/@\" + attrName);\n        }\n      }\n\n      // now get the field value\n      String val = xpp.nextText();      // todo... text event for <field></field>???\n                                        // need this line for isNull???\n      // Don't add fields marked as null (for now at least)\n      if (!isNull) {\n        if (boost != 1.0f) {\n          builder.addField(name,val,boost);\n        } else {\n          builder.addField(name,val);\n        }\n      }\n\n      // do I have to do a nextTag here to read the end_tag?\n\n    } // end field loop\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"f086342d88c71c53801570c03106eee911e995d2":["0c3e228bf650e96f3002a8fb73dd0c13d55af077"],"0c3e228bf650e96f3002a8fb73dd0c13d55af077":["3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"d80013b5e260def972025c93a0b08524f9c38f49":["f086342d88c71c53801570c03106eee911e995d2"]},"commit2Childs":{"f086342d88c71c53801570c03106eee911e995d2":["d80013b5e260def972025c93a0b08524f9c38f49"],"0c3e228bf650e96f3002a8fb73dd0c13d55af077":["f086342d88c71c53801570c03106eee911e995d2"],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":["0c3e228bf650e96f3002a8fb73dd0c13d55af077"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[],"d80013b5e260def972025c93a0b08524f9c38f49":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817","d80013b5e260def972025c93a0b08524f9c38f49"],"roots":["3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b","a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}