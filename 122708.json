{"path":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser.FuzzyDismaxQParser.FuzzyQueryParser#newFieldQuery(Analyzer,String,String,boolean,boolean,boolean,SynonymQueryStyle).mjava","commits":[{"id":"47d74fab5d64854ddafa81b65ed399b192f2d947","date":1512411916,"type":1,"author":"David Smiley","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser.FuzzyDismaxQParser.FuzzyQueryParser#newFieldQuery(Analyzer,String,String,boolean,boolean,boolean,SynonymQueryStyle).mjava","pathOld":"solr/core/src/test/org/apache/solr/search/TestExtendedDismaxParser.FuzzyDismaxQParser.FuzzyQueryParser#newFieldQuery(Analyzer,String,String,boolean,boolean,boolean).mjava","sourceNew":"      /** \n       * Handle multi-term queries by repacking boolean queries with frequently misspelled term\n       * queries rewritten as fuzzy queries.\n       **/\n      @Override\n      protected Query newFieldQuery(Analyzer analyzer, String field, String queryText,\n                                    boolean quoted, boolean fieldAutoGenPhraseQueries,\n                                    boolean fieldEnableGraphQueries, SynonymQueryStyle synonymQueryStyle)\n          throws SyntaxError {\n        Query q = super.newFieldQuery\n            (analyzer, field, queryText, quoted, fieldAutoGenPhraseQueries, fieldEnableGraphQueries, synonymQueryStyle);\n        if (q instanceof BooleanQuery) {\n          boolean rewrittenSubQ = false; // dirty flag: rebuild the repacked query?\n          BooleanQuery.Builder builder = newBooleanQuery();\n          for (BooleanClause clause : ((BooleanQuery)q).clauses()) {\n            Query subQ = clause.getQuery();\n            if (subQ instanceof TermQuery) {\n              Term subTerm = ((TermQuery)subQ).getTerm(); \n              if (frequentlyMisspelledWords.contains(subTerm.text())) {\n                rewrittenSubQ = true;\n                Query fuzzySubQ = newFuzzyQuery(subTerm, MIN_SIMILARITY, getFuzzyPrefixLength());\n                clause = newBooleanClause(fuzzySubQ, clause.getOccur());\n              } \n            } \n            builder.add(clause);\n          }\n          if (rewrittenSubQ) {\n            builder.setMinimumNumberShouldMatch(((BooleanQuery)q).getMinimumNumberShouldMatch());\n            q = builder.build();\n          }\n        }\n        return q;\n      }\n\n","sourceOld":"      /** \n       * Handle multi-term queries by repacking boolean queries with frequently misspelled term\n       * queries rewritten as fuzzy queries.\n       **/\n      @Override\n      protected Query newFieldQuery(Analyzer analyzer, String field, String queryText,\n                                    boolean quoted, boolean fieldAutoGenPhraseQueries, boolean fieldEnableGraphQueries)\n          throws SyntaxError {\n        Query q = super.newFieldQuery\n            (analyzer, field, queryText, quoted, fieldAutoGenPhraseQueries, fieldEnableGraphQueries);\n        if (q instanceof BooleanQuery) {\n          boolean rewrittenSubQ = false; // dirty flag: rebuild the repacked query?\n          BooleanQuery.Builder builder = newBooleanQuery();\n          for (BooleanClause clause : ((BooleanQuery)q).clauses()) {\n            Query subQ = clause.getQuery();\n            if (subQ instanceof TermQuery) {\n              Term subTerm = ((TermQuery)subQ).getTerm(); \n              if (frequentlyMisspelledWords.contains(subTerm.text())) {\n                rewrittenSubQ = true;\n                Query fuzzySubQ = newFuzzyQuery(subTerm, MIN_SIMILARITY, getFuzzyPrefixLength());\n                clause = newBooleanClause(fuzzySubQ, clause.getOccur());\n              } \n            } \n            builder.add(clause);\n          }\n          if (rewrittenSubQ) {\n            builder.setMinimumNumberShouldMatch(((BooleanQuery)q).getMinimumNumberShouldMatch());\n            q = builder.build();\n          }\n        }\n        return q;\n      }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"47d74fab5d64854ddafa81b65ed399b192f2d947":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["47d74fab5d64854ddafa81b65ed399b192f2d947"]},"commit2Childs":{"47d74fab5d64854ddafa81b65ed399b192f2d947":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["47d74fab5d64854ddafa81b65ed399b192f2d947"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}