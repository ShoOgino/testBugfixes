{"path":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/Facet2DStream#appendJson(StringBuilder,Bucket,Bucket,Metric,FieldComparator[],int,int).mjava","commits":[{"id":"8192418e56fee1a061317028a35f7f288824c856","date":1557514938,"type":0,"author":"Joel Bernstein","isMerge":false,"pathNew":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/Facet2DStream#appendJson(StringBuilder,Bucket,Bucket,Metric,FieldComparator[],int,int).mjava","pathOld":"/dev/null","sourceNew":"  private void appendJson(StringBuilder buf, Bucket x, Bucket y, Metric metric, FieldComparator[] adjustedSorts, int dimensionX, int dimensionY) {\n\n    buf.append('\"');\n    buf.append(\"x\");\n    buf.append('\"');\n    buf.append(\":{\");\n    buf.append(\"\\\"type\\\":\\\"terms\\\"\");\n    buf.append(\",\\\"field\\\":\\\"\" + x.toString() + \"\\\"\");\n    buf.append(\",\\\"limit\\\":\" + dimensionX );\n    buf.append(\",\\\"overrequest\\\":1000\");\n    String fsort = getFacetSort(adjustedSorts[0].getLeftFieldName(), metric);\n    buf.append(\",\\\"sort\\\":\\\"\"+ fsort + \" desc\\\"\");\n    buf.append(\",\\\"facet\\\":{\");\n\n    String identifier = metric.getIdentifier();\n    if (!identifier.startsWith(\"count(\")) {\n      buf.append(\"\\\"agg\\\":\\\"\" + identifier + \"\\\"\");\n      buf.append(\",\");\n    }\n    buf.append('\"');\n    buf.append(\"y\");\n    buf.append('\"');\n    buf.append(\":{\");\n    buf.append(\"\\\"type\\\":\\\"terms\\\"\");\n    buf.append(\",\\\"field\\\":\\\"\" + y.toString() + \"\\\"\");\n    buf.append(\",\\\"limit\\\":\" + dimensionY );\n    buf.append(\",\\\"overrequest\\\":1000\");\n    String fsortY = getFacetSort(adjustedSorts[1].getLeftFieldName(), metric);\n    buf.append(\",\\\"sort\\\":\\\"\"+ fsortY + \" desc\\\"\");\n    buf.append(\",\\\"facet\\\":{\");\n    if (!identifier.startsWith(\"count(\")) {\n      buf.append(\"\\\"agg\\\":\\\"\" + identifier + \"\\\"\");\n    }\n    buf.append(\"}}}}\");\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"2ffe681f212e5073c69955b4ad22946794c84940","date":1560182863,"type":3,"author":"Koen De Groote","isMerge":false,"pathNew":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/Facet2DStream#appendJson(StringBuilder,Bucket,Bucket,Metric,FieldComparator[],int,int).mjava","pathOld":"solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/Facet2DStream#appendJson(StringBuilder,Bucket,Bucket,Metric,FieldComparator[],int,int).mjava","sourceNew":"  private void appendJson(StringBuilder buf, Bucket x, Bucket y, Metric metric, FieldComparator[] adjustedSorts, int dimensionX, int dimensionY) {\n\n    buf.append('\"');\n    buf.append(\"x\");\n    buf.append('\"');\n    buf.append(\":{\");\n    buf.append(\"\\\"type\\\":\\\"terms\\\"\");\n    buf.append(\",\\\"field\\\":\\\"\").append(x.toString()).append('\"');\n    buf.append(\",\\\"limit\\\":\").append(dimensionX);\n    buf.append(\",\\\"overrequest\\\":1000\");\n    String fsort = getFacetSort(adjustedSorts[0].getLeftFieldName(), metric);\n    buf.append(\",\\\"sort\\\":\\\"\").append(fsort).append(\" desc\\\"\");\n    buf.append(\",\\\"facet\\\":{\");\n\n    String identifier = metric.getIdentifier();\n    if (!identifier.startsWith(\"count(\")) {\n      buf.append(\"\\\"agg\\\":\\\"\").append(identifier).append('\"');\n      buf.append(\",\");\n    }\n    buf.append('\"');\n    buf.append(\"y\");\n    buf.append('\"');\n    buf.append(\":{\");\n    buf.append(\"\\\"type\\\":\\\"terms\\\"\");\n    buf.append(\",\\\"field\\\":\\\"\").append(y.toString()).append('\"');\n    buf.append(\",\\\"limit\\\":\").append(dimensionY);\n    buf.append(\",\\\"overrequest\\\":1000\");\n    String fsortY = getFacetSort(adjustedSorts[1].getLeftFieldName(), metric);\n    buf.append(\",\\\"sort\\\":\\\"\").append(fsortY).append(\" desc\\\"\");\n    buf.append(\",\\\"facet\\\":{\");\n    if (!identifier.startsWith(\"count(\")) {\n      buf.append(\"\\\"agg\\\":\\\"\").append(identifier).append('\"');\n    }\n    buf.append(\"}}}}\");\n  }\n\n","sourceOld":"  private void appendJson(StringBuilder buf, Bucket x, Bucket y, Metric metric, FieldComparator[] adjustedSorts, int dimensionX, int dimensionY) {\n\n    buf.append('\"');\n    buf.append(\"x\");\n    buf.append('\"');\n    buf.append(\":{\");\n    buf.append(\"\\\"type\\\":\\\"terms\\\"\");\n    buf.append(\",\\\"field\\\":\\\"\" + x.toString() + \"\\\"\");\n    buf.append(\",\\\"limit\\\":\" + dimensionX );\n    buf.append(\",\\\"overrequest\\\":1000\");\n    String fsort = getFacetSort(adjustedSorts[0].getLeftFieldName(), metric);\n    buf.append(\",\\\"sort\\\":\\\"\"+ fsort + \" desc\\\"\");\n    buf.append(\",\\\"facet\\\":{\");\n\n    String identifier = metric.getIdentifier();\n    if (!identifier.startsWith(\"count(\")) {\n      buf.append(\"\\\"agg\\\":\\\"\" + identifier + \"\\\"\");\n      buf.append(\",\");\n    }\n    buf.append('\"');\n    buf.append(\"y\");\n    buf.append('\"');\n    buf.append(\":{\");\n    buf.append(\"\\\"type\\\":\\\"terms\\\"\");\n    buf.append(\",\\\"field\\\":\\\"\" + y.toString() + \"\\\"\");\n    buf.append(\",\\\"limit\\\":\" + dimensionY );\n    buf.append(\",\\\"overrequest\\\":1000\");\n    String fsortY = getFacetSort(adjustedSorts[1].getLeftFieldName(), metric);\n    buf.append(\",\\\"sort\\\":\\\"\"+ fsortY + \" desc\\\"\");\n    buf.append(\",\\\"facet\\\":{\");\n    if (!identifier.startsWith(\"count(\")) {\n      buf.append(\"\\\"agg\\\":\\\"\" + identifier + \"\\\"\");\n    }\n    buf.append(\"}}}}\");\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"2ffe681f212e5073c69955b4ad22946794c84940":["8192418e56fee1a061317028a35f7f288824c856"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"8192418e56fee1a061317028a35f7f288824c856":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["2ffe681f212e5073c69955b4ad22946794c84940"]},"commit2Childs":{"2ffe681f212e5073c69955b4ad22946794c84940":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["8192418e56fee1a061317028a35f7f288824c856"],"8192418e56fee1a061317028a35f7f288824c856":["2ffe681f212e5073c69955b4ad22946794c84940"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}