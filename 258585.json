{"path":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","commits":[{"id":"98287baa2c8d136e801f366a73e27a23285b7b98","date":1427241813,"type":1,"author":"Ramkumar Aiyengar","isMerge":false,"pathNew":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","pathOld":"solr/test-framework/src/java/org/apache/solr/cloud/StopableIndexingThread#run().mjava","sourceNew":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.currentThread().sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","sourceOld":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.currentThread().sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a0d1e2aaf870d9d4f740ed0aaaf5824ccd9394ae","date":1427779360,"type":0,"author":"Ryan Ernst","isMerge":true,"pathNew":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","pathOld":"/dev/null","sourceNew":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.currentThread().sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"61c45e99cf6676da48f19d7511c73712ad39402b","date":1495508331,"type":3,"author":"Tomas Fernandez Lobbe","isMerge":false,"pathNew":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","pathOld":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","sourceNew":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","sourceOld":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.currentThread().sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"e9017cf144952056066919f1ebc7897ff9bd71b1","date":1496757600,"type":3,"author":"Shalin Shekhar Mangar","isMerge":true,"pathNew":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","pathOld":"solr/test-framework/src/java/org/apache/solr/cloud/StoppableIndexingThread#run().mjava","sourceNew":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","sourceOld":"  @Override\n  public void run() {\n    int i = 0;\n    int numDone = 0;\n    numDeletes = 0;\n    numAdds = 0;\n    \n    while (true && !stop) {\n      if (numCycles != -1) {\n        if (numDone > numCycles) {\n          break;\n        }\n      }\n      ++numDone;\n      String id = this.id + \"-\" + i;\n      ++i;\n      boolean addFailed = false;\n      \n      if (doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean() && deletes.size() > 0) {\n        String deleteId = deletes.remove(0);\n        try {\n          numDeletes++;\n          if (controlClient != null) {\n            UpdateRequest req = new UpdateRequest();\n            req.deleteById(deleteId);\n            req.setParam(\"CONTROL\", \"TRUE\");\n            req.process(controlClient);\n          }\n          \n          cloudClient.deleteById(deleteId);\n        } catch (Exception e) {\n          System.err.println(\"REQUEST FAILED for id=\" + deleteId);\n          e.printStackTrace();\n          if (e instanceof SolrServerException) {\n            System.err.println(\"ROOT CAUSE for id=\" + deleteId);\n            ((SolrServerException) e).getRootCause().printStackTrace();\n          }\n          deleteFails.add(deleteId);\n        }\n      }\n      \n      try {\n        numAdds++;\n        SolrInputDocument doc = new SolrInputDocument();\n        addFields(doc, \"id\", id, i1, 50, t1,\n            \"to come to the aid of their country.\");\n        addFields(doc, \"rnd_b\", true);\n        \n        docs.add(doc);\n        \n        if (docs.size() >= batchSize)  {\n          indexDocs(docs);\n          docs.clear();\n        }\n      } catch (Exception e) {\n        addFailed = true;\n        System.err.println(\"REQUEST FAILED for id=\" + id);\n        e.printStackTrace();\n        if (e instanceof SolrServerException) {\n          System.err.println(\"ROOT CAUSE for id=\" + id);\n          ((SolrServerException) e).getRootCause().printStackTrace();\n        }\n        addFails.add(id);\n      }\n      \n      if (!addFailed && doDeletes && AbstractFullDistribZkTestBase.random().nextBoolean()) {\n        deletes.add(id);\n      }\n      \n      if (docs.size() > 0 && pauseBetweenUpdates) {\n        try {\n          Thread.currentThread().sleep(AbstractFullDistribZkTestBase.random().nextInt(500) + 50);\n        } catch (InterruptedException e) {\n          Thread.currentThread().interrupt();\n        }\n      }\n    }\n    \n    System.err.println(\"added docs:\" + numAdds + \" with \" + (addFails.size() + deleteFails.size()) + \" fails\"\n        + \" deletes:\" + numDeletes);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"e9017cf144952056066919f1ebc7897ff9bd71b1":["98287baa2c8d136e801f366a73e27a23285b7b98","61c45e99cf6676da48f19d7511c73712ad39402b"],"a0d1e2aaf870d9d4f740ed0aaaf5824ccd9394ae":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","98287baa2c8d136e801f366a73e27a23285b7b98"],"61c45e99cf6676da48f19d7511c73712ad39402b":["98287baa2c8d136e801f366a73e27a23285b7b98"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"98287baa2c8d136e801f366a73e27a23285b7b98":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["61c45e99cf6676da48f19d7511c73712ad39402b"]},"commit2Childs":{"e9017cf144952056066919f1ebc7897ff9bd71b1":[],"a0d1e2aaf870d9d4f740ed0aaaf5824ccd9394ae":[],"61c45e99cf6676da48f19d7511c73712ad39402b":["e9017cf144952056066919f1ebc7897ff9bd71b1","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["a0d1e2aaf870d9d4f740ed0aaaf5824ccd9394ae","98287baa2c8d136e801f366a73e27a23285b7b98"],"98287baa2c8d136e801f366a73e27a23285b7b98":["e9017cf144952056066919f1ebc7897ff9bd71b1","a0d1e2aaf870d9d4f740ed0aaaf5824ccd9394ae","61c45e99cf6676da48f19d7511c73712ad39402b"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["e9017cf144952056066919f1ebc7897ff9bd71b1","a0d1e2aaf870d9d4f740ed0aaaf5824ccd9394ae","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}