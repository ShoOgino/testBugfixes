{"path":"solr/solrj/src/java/org/apache/solr/common/util/ByteUtils#calcUTF16toUTF8Length(CharSequence,int,int).mjava","commits":[{"id":"22d9fc178be3022bbd023370506ccb3b2fded03d","date":1441309358,"type":0,"author":"Shalin Shekhar Mangar","isMerge":false,"pathNew":"solr/solrj/src/java/org/apache/solr/common/util/ByteUtils#calcUTF16toUTF8Length(CharSequence,int,int).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Calculates the number of UTF8 bytes necessary to write a UTF16 string.\n   *\n   * @return the number of bytes written\n   */\n  public static int calcUTF16toUTF8Length(CharSequence s, int offset, int len) {\n    final int end = offset + len;\n\n    int res = 0;\n    for (int i = offset; i < end; i++) {\n      final int code = (int) s.charAt(i);\n\n      if (code < 0x80)\n        res++;\n      else if (code < 0x800) {\n        res += 2;\n      } else if (code < 0xD800 || code > 0xDFFF) {\n        res += 3;\n      } else {\n        // surrogate pair\n        // confirm valid high surrogate\n        if (code < 0xDC00 && (i < end - 1)) {\n          int utf32 = (int) s.charAt(i + 1);\n          // confirm valid low surrogate and write pair\n          if (utf32 >= 0xDC00 && utf32 <= 0xDFFF) {\n            i++;\n            res += 4;\n            continue;\n          }\n        }\n        res += 3;\n      }\n    }\n\n    return res;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"22d9fc178be3022bbd023370506ccb3b2fded03d":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["22d9fc178be3022bbd023370506ccb3b2fded03d"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["22d9fc178be3022bbd023370506ccb3b2fded03d"],"22d9fc178be3022bbd023370506ccb3b2fded03d":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}