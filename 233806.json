{"path":"solr/core/src/test/org/apache/solr/cloud/HttpPartitionOnCommitTest#sendCommitWithRetry(Replica).mjava","commits":[{"id":"84f20f331d8001864545c7021812d8c6509c7593","date":1517216128,"type":1,"author":"Cao Manh Dat","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/HttpPartitionOnCommitTest#sendCommitWithRetry(Replica).mjava","pathOld":"solr/core/src/test/org/apache/solr/cloud/LeaderInitiatedRecoveryOnCommitTest#sendCommitWithRetry(Replica).mjava","sourceNew":"  protected void sendCommitWithRetry(Replica replica) throws Exception {\n    String replicaCoreUrl = replica.getCoreUrl();\n    log.info(\"Sending commit request to: \"+replicaCoreUrl);\n    final RTimer timer = new RTimer();\n    try (HttpSolrClient client = getHttpSolrClient(replicaCoreUrl)) {\n      try {\n        client.commit();\n\n        log.info(\"Sent commit request to {} OK, took {}ms\", replicaCoreUrl, timer.getTime());\n      } catch (Exception exc) {\n        Throwable rootCause = SolrException.getRootCause(exc);\n        if (rootCause instanceof NoHttpResponseException) {\n          log.warn(\"No HTTP response from sending commit request to \"+replicaCoreUrl+\n              \"; will re-try after waiting 3 seconds\");\n          Thread.sleep(3000);\n          client.commit();\n          log.info(\"Second attempt at sending commit to \"+replicaCoreUrl+\" succeeded.\");\n        } else {\n          throw exc;\n        }\n      }\n    }\n  }\n\n","sourceOld":"  protected void sendCommitWithRetry(Replica replica) throws Exception {\n    String replicaCoreUrl = replica.getCoreUrl();\n    log.info(\"Sending commit request to: \"+replicaCoreUrl);\n    final RTimer timer = new RTimer();\n    try (HttpSolrClient client = getHttpSolrClient(replicaCoreUrl)) {\n      try {\n        client.commit();\n\n        log.info(\"Sent commit request to {} OK, took {}ms\", replicaCoreUrl, timer.getTime());\n      } catch (Exception exc) {\n        Throwable rootCause = SolrException.getRootCause(exc);\n        if (rootCause instanceof NoHttpResponseException) {\n          log.warn(\"No HTTP response from sending commit request to \"+replicaCoreUrl+\n              \"; will re-try after waiting 3 seconds\");\n          Thread.sleep(3000);\n          client.commit();\n          log.info(\"Second attempt at sending commit to \"+replicaCoreUrl+\" succeeded.\");\n        } else {\n          throw exc;\n        }\n      }\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a966532d92cf9ba2856f15a8140151bb6b518e4b","date":1588290631,"type":3,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/HttpPartitionOnCommitTest#sendCommitWithRetry(Replica).mjava","pathOld":"solr/core/src/test/org/apache/solr/cloud/HttpPartitionOnCommitTest#sendCommitWithRetry(Replica).mjava","sourceNew":"  protected void sendCommitWithRetry(Replica replica) throws Exception {\n    String replicaCoreUrl = replica.getCoreUrl();\n    log.info(\"Sending commit request to: {}\", replicaCoreUrl);\n    final RTimer timer = new RTimer();\n    try (HttpSolrClient client = getHttpSolrClient(replicaCoreUrl)) {\n      try {\n        client.commit();\n\n        if (log.isInfoEnabled()) {\n          log.info(\"Sent commit request to {} OK, took {}ms\", replicaCoreUrl, timer.getTime());\n        }\n      } catch (Exception exc) {\n        Throwable rootCause = SolrException.getRootCause(exc);\n        if (rootCause instanceof NoHttpResponseException) {\n          log.warn(\"No HTTP response from sending commit request to {}; will re-try after waiting 3 seconds\", replicaCoreUrl);\n          Thread.sleep(3000);\n          client.commit();\n          log.info(\"Second attempt at sending commit to {} succeeded\", replicaCoreUrl);\n        } else {\n          throw exc;\n        }\n      }\n    }\n  }\n\n","sourceOld":"  protected void sendCommitWithRetry(Replica replica) throws Exception {\n    String replicaCoreUrl = replica.getCoreUrl();\n    log.info(\"Sending commit request to: \"+replicaCoreUrl);\n    final RTimer timer = new RTimer();\n    try (HttpSolrClient client = getHttpSolrClient(replicaCoreUrl)) {\n      try {\n        client.commit();\n\n        log.info(\"Sent commit request to {} OK, took {}ms\", replicaCoreUrl, timer.getTime());\n      } catch (Exception exc) {\n        Throwable rootCause = SolrException.getRootCause(exc);\n        if (rootCause instanceof NoHttpResponseException) {\n          log.warn(\"No HTTP response from sending commit request to \"+replicaCoreUrl+\n              \"; will re-try after waiting 3 seconds\");\n          Thread.sleep(3000);\n          client.commit();\n          log.info(\"Second attempt at sending commit to \"+replicaCoreUrl+\" succeeded.\");\n        } else {\n          throw exc;\n        }\n      }\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"84f20f331d8001864545c7021812d8c6509c7593":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a966532d92cf9ba2856f15a8140151bb6b518e4b":["84f20f331d8001864545c7021812d8c6509c7593"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a966532d92cf9ba2856f15a8140151bb6b518e4b"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["84f20f331d8001864545c7021812d8c6509c7593"],"84f20f331d8001864545c7021812d8c6509c7593":["a966532d92cf9ba2856f15a8140151bb6b518e4b"],"a966532d92cf9ba2856f15a8140151bb6b518e4b":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}