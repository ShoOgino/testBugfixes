{"path":"solr/core/src/java/org/apache/solr/security/JWTAuthPlugin#getPromptHeaders(BearerWwwAuthErrorCode,String).mjava","commits":[{"id":"f4581306d6bfea0c805da045fbab70c7ff759a99","date":1579787496,"type":0,"author":"Jan HÃ¸ydahl","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/security/JWTAuthPlugin#getPromptHeaders(BearerWwwAuthErrorCode,String).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Generate proper response prompt headers\n   * @param responseError standardized error code. Set to 'null' to generate WWW-Authenticate header with no error\n   * @param message custom message string to return in www-authenticate, or null if no error\n   * @return map of headers to add to response\n   */\n  private Map<String, String> getPromptHeaders(BearerWwwAuthErrorCode responseError, String message) {\n    Map<String,String> headers = new HashMap<>();\n    List<String> wwwAuthParams = new ArrayList<>();\n    wwwAuthParams.add(\"Bearer realm=\\\"\" + realm + \"\\\"\");\n    if (responseError != null) {\n      wwwAuthParams.add(\"error=\\\"\" + responseError + \"\\\"\");\n      wwwAuthParams.add(\"error_description=\\\"\" + message + \"\\\"\");\n    }\n    headers.put(HttpHeaders.WWW_AUTHENTICATE, String.join(\", \", wwwAuthParams));\n    headers.put(AuthenticationPlugin.HTTP_HEADER_X_SOLR_AUTHDATA, generateAuthDataHeader());\n    return headers;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"f4581306d6bfea0c805da045fbab70c7ff759a99":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["f4581306d6bfea0c805da045fbab70c7ff759a99"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["f4581306d6bfea0c805da045fbab70c7ff759a99"],"f4581306d6bfea0c805da045fbab70c7ff759a99":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}