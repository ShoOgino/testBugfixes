{"path":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnDelete().mjava","commits":[{"id":"818d704eaaf0fba0561d0d2752832e1015053482","date":1327419676,"type":0,"author":"Jan HÃ¸ydahl","isMerge":false,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnDelete().mjava","pathOld":"/dev/null","sourceNew":" @Test\n public void testCommitWithinOnDelete() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now add one document...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    server.add(doc3);\n    server.commit();\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // now test commitWithin on a delete\n    UpdateRequest up = new UpdateRequest();\n    up.setCommitWithin(1000);\n    up.deleteById(\"id3\");\n    up.process( server );\n    \n    // the document should still be there\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // check if the doc has been deleted every 250 ms for 30 seconds\n    long timeout = System.currentTimeMillis() + 30000;\n    do {\n      Thread.sleep( 250 ); // wait 250 ms\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n      if(rsp.getResults().getNumFound()==0) {\n        return;\n      }\n    } while(System.currentTimeMillis()<timeout);\n    \n    Assert.fail(\"commitWithin failed to commit\");\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d","date":1327523564,"type":0,"author":"Robert Muir","isMerge":true,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnDelete().mjava","pathOld":"/dev/null","sourceNew":" @Test\n public void testCommitWithinOnDelete() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now add one document...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    server.add(doc3);\n    server.commit();\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // now test commitWithin on a delete\n    UpdateRequest up = new UpdateRequest();\n    up.setCommitWithin(1000);\n    up.deleteById(\"id3\");\n    up.process( server );\n    \n    // the document should still be there\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // check if the doc has been deleted every 250 ms for 30 seconds\n    long timeout = System.currentTimeMillis() + 30000;\n    do {\n      Thread.sleep( 250 ); // wait 250 ms\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n      if(rsp.getResults().getNumFound()==0) {\n        return;\n      }\n    } while(System.currentTimeMillis()<timeout);\n    \n    Assert.fail(\"commitWithin failed to commit\");\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"0d22ac6a4146774c1bc8400160fc0b6150294e92","date":1327528604,"type":0,"author":"Uwe Schindler","isMerge":true,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnDelete().mjava","pathOld":"/dev/null","sourceNew":" @Test\n public void testCommitWithinOnDelete() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now add one document...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    server.add(doc3);\n    server.commit();\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // now test commitWithin on a delete\n    UpdateRequest up = new UpdateRequest();\n    up.setCommitWithin(1000);\n    up.deleteById(\"id3\");\n    up.process( server );\n    \n    // the document should still be there\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // check if the doc has been deleted every 250 ms for 30 seconds\n    long timeout = System.currentTimeMillis() + 30000;\n    do {\n      Thread.sleep( 250 ); // wait 250 ms\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n      if(rsp.getResults().getNumFound()==0) {\n        return;\n      }\n    } while(System.currentTimeMillis()<timeout);\n    \n    Assert.fail(\"commitWithin failed to commit\");\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"98a20a1a0f02e19e5121d1b5d95f5af857d609ef","date":1382205865,"type":5,"author":"Mark Robert Miller","isMerge":false,"pathNew":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTestsBase#testCommitWithinOnDelete().mjava","pathOld":"solr/solrj/src/test/org/apache/solr/client/solrj/SolrExampleTests#testCommitWithinOnDelete().mjava","sourceNew":"  @Test\n  public void testCommitWithinOnDelete() throws Exception {\n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery(\"*:*\");// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query(new SolrQuery(\"*:*\"));\n    Assert.assertEquals(0, rsp.getResults().getNumFound());\n    \n    // Now add one document...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField(\"id\", \"id3\", 1.0f);\n    doc3.addField(\"name\", \"doc3\", 1.0f);\n    doc3.addField(\"price\", 10);\n    server.add(doc3);\n    server.commit();\n    \n    // now check that it comes out...\n    rsp = server.query(new SolrQuery(\"id:id3\"));\n    Assert.assertEquals(1, rsp.getResults().getNumFound());\n    \n    // now test commitWithin on a delete\n    UpdateRequest up = new UpdateRequest();\n    up.setCommitWithin(1000);\n    up.deleteById(\"id3\");\n    up.process(server);\n    \n    // the document should still be there\n    rsp = server.query(new SolrQuery(\"id:id3\"));\n    Assert.assertEquals(1, rsp.getResults().getNumFound());\n    \n    // check if the doc has been deleted every 250 ms for 30 seconds\n    long timeout = System.currentTimeMillis() + 30000;\n    do {\n      Thread.sleep(250); // wait 250 ms\n      \n      rsp = server.query(new SolrQuery(\"id:id3\"));\n      if (rsp.getResults().getNumFound() == 0) {\n        return;\n      }\n    } while (System.currentTimeMillis() < timeout);\n    \n    Assert.fail(\"commitWithin failed to commit\");\n  }\n\n","sourceOld":" @Test\n public void testCommitWithinOnDelete() throws Exception\n  {    \n    // make sure it is empty...\n    SolrServer server = getSolrServer();\n    server.deleteByQuery( \"*:*\" );// delete everything!\n    server.commit();\n    QueryResponse rsp = server.query( new SolrQuery( \"*:*\") );\n    Assert.assertEquals( 0, rsp.getResults().getNumFound() );\n\n    // Now add one document...\n    SolrInputDocument doc3 = new SolrInputDocument();\n    doc3.addField( \"id\", \"id3\", 1.0f );\n    doc3.addField( \"name\", \"doc3\", 1.0f );\n    doc3.addField( \"price\", 10 );\n    server.add(doc3);\n    server.commit();\n\n    // now check that it comes out...\n    rsp = server.query( new SolrQuery( \"id:id3\") );    \n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // now test commitWithin on a delete\n    UpdateRequest up = new UpdateRequest();\n    up.setCommitWithin(1000);\n    up.deleteById(\"id3\");\n    up.process( server );\n    \n    // the document should still be there\n    rsp = server.query( new SolrQuery( \"id:id3\") );\n    Assert.assertEquals( 1, rsp.getResults().getNumFound() );\n    \n    // check if the doc has been deleted every 250 ms for 30 seconds\n    long timeout = System.currentTimeMillis() + 30000;\n    do {\n      Thread.sleep( 250 ); // wait 250 ms\n      \n      rsp = server.query( new SolrQuery( \"id:id3\") );\n      if(rsp.getResults().getNumFound()==0) {\n        return;\n      }\n    } while(System.currentTimeMillis()<timeout);\n    \n    Assert.fail(\"commitWithin failed to commit\");\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"98a20a1a0f02e19e5121d1b5d95f5af857d609ef":["818d704eaaf0fba0561d0d2752832e1015053482"],"0d22ac6a4146774c1bc8400160fc0b6150294e92":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","818d704eaaf0fba0561d0d2752832e1015053482"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","818d704eaaf0fba0561d0d2752832e1015053482"],"818d704eaaf0fba0561d0d2752832e1015053482":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["98a20a1a0f02e19e5121d1b5d95f5af857d609ef"]},"commit2Childs":{"98a20a1a0f02e19e5121d1b5d95f5af857d609ef":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"0d22ac6a4146774c1bc8400160fc0b6150294e92":[],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["0d22ac6a4146774c1bc8400160fc0b6150294e92","a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d","818d704eaaf0fba0561d0d2752832e1015053482"],"a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d":[],"818d704eaaf0fba0561d0d2752832e1015053482":["98a20a1a0f02e19e5121d1b5d95f5af857d609ef","0d22ac6a4146774c1bc8400160fc0b6150294e92","a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["0d22ac6a4146774c1bc8400160fc0b6150294e92","a3c68e20c73359a10cf3eb4a35c9fa7ab1f3c30d","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}