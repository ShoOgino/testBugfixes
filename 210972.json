{"path":"lucene/core/src/java/org/apache/lucene/index/MergeState#buildDeletionDocMaps(List[CodecReader]).mjava","commits":[{"id":"653128722fb3b4713ac331c621491a93f34a4a22","date":1479841816,"type":0,"author":"Mike McCandless","isMerge":false,"pathNew":"lucene/core/src/java/org/apache/lucene/index/MergeState#buildDeletionDocMaps(List[CodecReader]).mjava","pathOld":"/dev/null","sourceNew":"  // Remap docIDs around deletions\n  private DocMap[] buildDeletionDocMaps(List<CodecReader> readers) {\n\n    int totalDocs = 0;\n    int numReaders = readers.size();\n    DocMap[] docMaps = new DocMap[numReaders];\n\n    for (int i = 0; i < numReaders; i++) {\n      LeafReader reader = readers.get(i);\n      Bits liveDocs = reader.getLiveDocs();\n\n      final PackedLongValues delDocMap;\n      if (liveDocs != null) {\n        delDocMap = removeDeletes(reader.maxDoc(), liveDocs);\n      } else {\n        delDocMap = null;\n      }\n\n      final int docBase = totalDocs;\n      docMaps[i] = new DocMap() {\n        @Override\n        public int get(int docID) {\n          if (liveDocs == null) {\n            return docBase + docID;\n          } else if (liveDocs.get(docID)) {\n            return docBase + (int) delDocMap.get(docID);\n          } else {\n            return -1;\n          }\n        }\n      };\n      totalDocs += reader.numDocs();\n    }\n\n    return docMaps;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"727bb765ff2542275f6d31f67be18d7104bae148","date":1480353976,"type":0,"author":"Kevin Risden","isMerge":true,"pathNew":"lucene/core/src/java/org/apache/lucene/index/MergeState#buildDeletionDocMaps(List[CodecReader]).mjava","pathOld":"/dev/null","sourceNew":"  // Remap docIDs around deletions\n  private DocMap[] buildDeletionDocMaps(List<CodecReader> readers) {\n\n    int totalDocs = 0;\n    int numReaders = readers.size();\n    DocMap[] docMaps = new DocMap[numReaders];\n\n    for (int i = 0; i < numReaders; i++) {\n      LeafReader reader = readers.get(i);\n      Bits liveDocs = reader.getLiveDocs();\n\n      final PackedLongValues delDocMap;\n      if (liveDocs != null) {\n        delDocMap = removeDeletes(reader.maxDoc(), liveDocs);\n      } else {\n        delDocMap = null;\n      }\n\n      final int docBase = totalDocs;\n      docMaps[i] = new DocMap() {\n        @Override\n        public int get(int docID) {\n          if (liveDocs == null) {\n            return docBase + docID;\n          } else if (liveDocs.get(docID)) {\n            return docBase + (int) delDocMap.get(docID);\n          } else {\n            return -1;\n          }\n        }\n      };\n      totalDocs += reader.numDocs();\n    }\n\n    return docMaps;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"727bb765ff2542275f6d31f67be18d7104bae148":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","653128722fb3b4713ac331c621491a93f34a4a22"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"653128722fb3b4713ac331c621491a93f34a4a22":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["653128722fb3b4713ac331c621491a93f34a4a22"]},"commit2Childs":{"727bb765ff2542275f6d31f67be18d7104bae148":[],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["727bb765ff2542275f6d31f67be18d7104bae148","653128722fb3b4713ac331c621491a93f34a4a22"],"653128722fb3b4713ac331c621491a93f34a4a22":["727bb765ff2542275f6d31f67be18d7104bae148","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["727bb765ff2542275f6d31f67be18d7104bae148","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}