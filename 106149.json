{"path":"solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler#handleBalanceShardUnique(SolrQueryRequest,SolrQueryResponse).mjava","commits":[{"id":"cfb61c9baefa8681e40fca3c803f61bf485a9d8d","date":1414979559,"type":1,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler#handleBalanceShardUnique(SolrQueryRequest,SolrQueryResponse).mjava","pathOld":"solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler#handleBalanceSliceUnique(SolrQueryRequest,SolrQueryResponse).mjava","sourceNew":"  private void handleBalanceShardUnique(SolrQueryRequest req, SolrQueryResponse rsp) throws KeeperException, InterruptedException {\n    req.getParams().required().check(COLLECTION_PROP, PROPERTY_PROP);\n    Boolean shardUnique = Boolean.parseBoolean(req.getParams().get(SHARD_UNIQUE));\n    String prop = req.getParams().get(PROPERTY_PROP).toLowerCase(Locale.ROOT);\n    if (StringUtils.startsWith(prop, OverseerCollectionProcessor.COLL_PROP_PREFIX) == false) {\n      prop = OverseerCollectionProcessor.COLL_PROP_PREFIX + prop;\n    }\n\n    if (shardUnique == false &&\n        Overseer.sliceUniqueBooleanProperties.contains(prop) == false) {\n      throw new SolrException(ErrorCode.BAD_REQUEST, \"Balancing properties amongst replicas in a slice requires that\"\n      + \" the property be pre-defined as a unique property (e.g. 'preferredLeader') or that 'shardUnique' be set to 'true'. \" +\n      \" Property: \" + prop + \" shardUnique: \" + Boolean.toString(shardUnique));\n    }\n\n    Map<String, Object> map = ZkNodeProps.makeMap(Overseer.QUEUE_OPERATION, BALANCESHARDUNIQUE.toLower());\n    copyIfNotNull(req.getParams(), map, COLLECTION_PROP, PROPERTY_PROP, ONLY_ACTIVE_NODES, SHARD_UNIQUE);\n\n    handleResponse(BALANCESHARDUNIQUE.toLower(), new ZkNodeProps(map), rsp);\n  }\n\n","sourceOld":"  private void handleBalanceSliceUnique(SolrQueryRequest req, SolrQueryResponse rsp) throws KeeperException, InterruptedException {\n    req.getParams().required().check(COLLECTION_PROP, PROPERTY_PROP);\n    Boolean sliceUnique = Boolean.parseBoolean(req.getParams().get(SLICE_UNIQUE));\n    String prop = req.getParams().get(PROPERTY_PROP).toLowerCase(Locale.ROOT);\n    if (StringUtils.startsWith(prop, OverseerCollectionProcessor.COLL_PROP_PREFIX) == false) {\n      prop = OverseerCollectionProcessor.COLL_PROP_PREFIX + prop;\n    }\n\n    if (sliceUnique == false &&\n        Overseer.sliceUniqueBooleanProperties.contains(prop) == false) {\n      throw new SolrException(ErrorCode.BAD_REQUEST, \"Balancing properties amongst replicas in a slice requires that\"\n      + \" the property be pre-defined as a unique property (e.g. 'preferredLeader') or that 'sliceUnique' be set to 'true'. \" +\n      \" Property: \" + prop + \" sliceUnique: \" + Boolean.toString(sliceUnique));\n    }\n\n    Map<String, Object> map = ZkNodeProps.makeMap(Overseer.QUEUE_OPERATION, BALANCESLICEUNIQUE.toLower());\n    copyIfNotNull(req.getParams(), map, COLLECTION_PROP, PROPERTY_PROP, ONLY_ACTIVE_NODES, SLICE_UNIQUE);\n\n    handleResponse(BALANCESLICEUNIQUE.toLower(), new ZkNodeProps(map), rsp);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"24a5da2a0d397ff29f3de8f6cf451d3412c2509a","date":1417276391,"type":3,"author":"Shalin Shekhar Mangar","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler#handleBalanceShardUnique(SolrQueryRequest,SolrQueryResponse).mjava","pathOld":"solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler#handleBalanceShardUnique(SolrQueryRequest,SolrQueryResponse).mjava","sourceNew":"  private void handleBalanceShardUnique(SolrQueryRequest req, SolrQueryResponse rsp) throws KeeperException, InterruptedException {\n    req.getParams().required().check(COLLECTION_PROP, PROPERTY_PROP);\n    Boolean shardUnique = Boolean.parseBoolean(req.getParams().get(SHARD_UNIQUE));\n    String prop = req.getParams().get(PROPERTY_PROP).toLowerCase(Locale.ROOT);\n    if (StringUtils.startsWith(prop, OverseerCollectionProcessor.COLL_PROP_PREFIX) == false) {\n      prop = OverseerCollectionProcessor.COLL_PROP_PREFIX + prop;\n    }\n\n    if (shardUnique == false &&\n        SliceMutator.SLICE_UNIQUE_BOOLEAN_PROPERTIES.contains(prop) == false) {\n      throw new SolrException(ErrorCode.BAD_REQUEST, \"Balancing properties amongst replicas in a slice requires that\"\n      + \" the property be pre-defined as a unique property (e.g. 'preferredLeader') or that 'shardUnique' be set to 'true'. \" +\n      \" Property: \" + prop + \" shardUnique: \" + Boolean.toString(shardUnique));\n    }\n\n    Map<String, Object> map = ZkNodeProps.makeMap(Overseer.QUEUE_OPERATION, BALANCESHARDUNIQUE.toLower());\n    copyIfNotNull(req.getParams(), map, COLLECTION_PROP, PROPERTY_PROP, ONLY_ACTIVE_NODES, SHARD_UNIQUE);\n\n    handleResponse(BALANCESHARDUNIQUE.toLower(), new ZkNodeProps(map), rsp);\n  }\n\n","sourceOld":"  private void handleBalanceShardUnique(SolrQueryRequest req, SolrQueryResponse rsp) throws KeeperException, InterruptedException {\n    req.getParams().required().check(COLLECTION_PROP, PROPERTY_PROP);\n    Boolean shardUnique = Boolean.parseBoolean(req.getParams().get(SHARD_UNIQUE));\n    String prop = req.getParams().get(PROPERTY_PROP).toLowerCase(Locale.ROOT);\n    if (StringUtils.startsWith(prop, OverseerCollectionProcessor.COLL_PROP_PREFIX) == false) {\n      prop = OverseerCollectionProcessor.COLL_PROP_PREFIX + prop;\n    }\n\n    if (shardUnique == false &&\n        Overseer.sliceUniqueBooleanProperties.contains(prop) == false) {\n      throw new SolrException(ErrorCode.BAD_REQUEST, \"Balancing properties amongst replicas in a slice requires that\"\n      + \" the property be pre-defined as a unique property (e.g. 'preferredLeader') or that 'shardUnique' be set to 'true'. \" +\n      \" Property: \" + prop + \" shardUnique: \" + Boolean.toString(shardUnique));\n    }\n\n    Map<String, Object> map = ZkNodeProps.makeMap(Overseer.QUEUE_OPERATION, BALANCESHARDUNIQUE.toLower());\n    copyIfNotNull(req.getParams(), map, COLLECTION_PROP, PROPERTY_PROP, ONLY_ACTIVE_NODES, SHARD_UNIQUE);\n\n    handleResponse(BALANCESHARDUNIQUE.toLower(), new ZkNodeProps(map), rsp);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"9ebd3a557326ef3eab85b73a8cff781f7d801248","date":1431620752,"type":4,"author":"Noble Paul","isMerge":false,"pathNew":"/dev/null","pathOld":"solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler#handleBalanceShardUnique(SolrQueryRequest,SolrQueryResponse).mjava","sourceNew":null,"sourceOld":"  private void handleBalanceShardUnique(SolrQueryRequest req, SolrQueryResponse rsp) throws KeeperException, InterruptedException {\n    req.getParams().required().check(COLLECTION_PROP, PROPERTY_PROP);\n    Boolean shardUnique = Boolean.parseBoolean(req.getParams().get(SHARD_UNIQUE));\n    String prop = req.getParams().get(PROPERTY_PROP).toLowerCase(Locale.ROOT);\n    if (StringUtils.startsWith(prop, OverseerCollectionProcessor.COLL_PROP_PREFIX) == false) {\n      prop = OverseerCollectionProcessor.COLL_PROP_PREFIX + prop;\n    }\n\n    if (shardUnique == false &&\n        SliceMutator.SLICE_UNIQUE_BOOLEAN_PROPERTIES.contains(prop) == false) {\n      throw new SolrException(ErrorCode.BAD_REQUEST, \"Balancing properties amongst replicas in a slice requires that\"\n      + \" the property be pre-defined as a unique property (e.g. 'preferredLeader') or that 'shardUnique' be set to 'true'. \" +\n      \" Property: \" + prop + \" shardUnique: \" + Boolean.toString(shardUnique));\n    }\n\n    Map<String, Object> map = ZkNodeProps.makeMap(Overseer.QUEUE_OPERATION, BALANCESHARDUNIQUE.toLower());\n    copyIfNotNull(req.getParams(), map, COLLECTION_PROP, PROPERTY_PROP, ONLY_ACTIVE_NODES, SHARD_UNIQUE);\n\n    handleResponse(BALANCESHARDUNIQUE.toLower(), new ZkNodeProps(map), rsp);\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"24a5da2a0d397ff29f3de8f6cf451d3412c2509a":["cfb61c9baefa8681e40fca3c803f61bf485a9d8d"],"cfb61c9baefa8681e40fca3c803f61bf485a9d8d":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"9ebd3a557326ef3eab85b73a8cff781f7d801248":["24a5da2a0d397ff29f3de8f6cf451d3412c2509a"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["9ebd3a557326ef3eab85b73a8cff781f7d801248"]},"commit2Childs":{"24a5da2a0d397ff29f3de8f6cf451d3412c2509a":["9ebd3a557326ef3eab85b73a8cff781f7d801248"],"cfb61c9baefa8681e40fca3c803f61bf485a9d8d":["24a5da2a0d397ff29f3de8f6cf451d3412c2509a"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cfb61c9baefa8681e40fca3c803f61bf485a9d8d"],"9ebd3a557326ef3eab85b73a8cff781f7d801248":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}