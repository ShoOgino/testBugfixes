{"path":"contrib/benchmark/src/java/org/apache/lucene/benchmark/byTask/feeds/ReutersDocMaker#makeDocument().mjava","commits":[{"id":"b2e70b697d9f5a6130848741a4f0cdc08a1fe258","date":1168661303,"type":0,"author":"Grant Ingersoll","isMerge":false,"pathNew":"contrib/benchmark/src/java/org/apache/lucene/benchmark/byTask/feeds/ReutersDocMaker#makeDocument().mjava","pathOld":"/dev/null","sourceNew":"  /* (non-Javadoc)\r\n   * @see SimpleDocMaker#makeDocument()\r\n   */\r\n  public Document makeDocument() throws Exception {\r\n    File f = null;\r\n    String name = null;\r\n    synchronized (this) {\r\n      f = (File) txtFiles.get(nextFile++);\r\n      name = f.getCanonicalPath()+\"_\"+round;\r\n      if (nextFile >= txtFiles.size()) { \r\n        // exhausted files, start a new round\r\n        nextFile = 0;\r\n        round++;\r\n      }\r\n    }\r\n    \r\n    Document doc = new Document();\r\n    doc.add(new Field(\"name\",name,storeVal,indexVal,termVecVal));\r\n    BufferedReader reader = new BufferedReader(new FileReader(f));\r\n    String line = null;\r\n    //First line is the date, 3rd is the title, rest is body\r\n    String dateStr = reader.readLine();\r\n    reader.readLine();//skip an empty line\r\n    String title = reader.readLine();\r\n    reader.readLine();//skip an empty line\r\n    StringBuffer body = new StringBuffer(1024);\r\n    while ((line = reader.readLine()) != null) {\r\n      body.append(line).append(' ');\r\n    }\r\n    Date date = dateFormat.parse(dateStr.trim());\r\n    doc.add(new Field(\"date\", DateTools.dateToString(date, DateTools.Resolution.SECOND), \r\n        Field.Store.YES, Field.Index.UN_TOKENIZED));\r\n\r\n    if (title != null) {\r\n      doc.add(new Field(\"title\", title, storeVal,indexVal,termVecVal));\r\n    }\r\n    if (body.length() > 0) {\r\n        doc.add(new Field(\"body\", body.toString(), storeVal,indexVal,termVecVal));\r\n    }\r\n\r\n    count++;\r\n    addBytes(f.length());\r\n\r\n    return doc;\r\n  }\r\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"2c374fcdaaef447f786e6c8a1841c44b24ec178c","date":1171220362,"type":5,"author":"Grant Ingersoll","isMerge":false,"pathNew":"contrib/benchmark/src/java/org/apache/lucene/benchmark/byTask/feeds/ReutersDocMaker#getNextDocData().mjava","pathOld":"contrib/benchmark/src/java/org/apache/lucene/benchmark/byTask/feeds/ReutersDocMaker#makeDocument().mjava","sourceNew":"  protected DocData getNextDocData() throws Exception {\r\n    File f = null;\r\n    String name = null;\r\n    synchronized (this) {\r\n      f = (File) inputFiles.get(nextFile++);\r\n      name = f.getCanonicalPath()+\"_\"+iteration;\r\n      if (nextFile >= inputFiles.size()) { \r\n        // exhausted files, start a new round\r\n        nextFile = 0;\r\n        iteration++;\r\n      }\r\n    }\r\n    \r\n    BufferedReader reader = new BufferedReader(new FileReader(f));\r\n    String line = null;\r\n    //First line is the date, 3rd is the title, rest is body\r\n    String dateStr = reader.readLine();\r\n    reader.readLine();//skip an empty line\r\n    String title = reader.readLine();\r\n    reader.readLine();//skip an empty line\r\n    StringBuffer bodyBuf = new StringBuffer(1024);\r\n    while ((line = reader.readLine()) != null) {\r\n      bodyBuf.append(line).append(' ');\r\n    }\r\n    \r\n    addBytes(f.length());\r\n\r\n    DocData dd = new DocData();\r\n    \r\n    dd.date = dateFormat.parse(dateStr.trim());\r\n    dd.name = name;\r\n    dd.title = title;\r\n    dd.body = bodyBuf.toString();\r\n    return dd;\r\n  }\r\n\n","sourceOld":"  /* (non-Javadoc)\r\n   * @see SimpleDocMaker#makeDocument()\r\n   */\r\n  public Document makeDocument() throws Exception {\r\n    File f = null;\r\n    String name = null;\r\n    synchronized (this) {\r\n      f = (File) txtFiles.get(nextFile++);\r\n      name = f.getCanonicalPath()+\"_\"+round;\r\n      if (nextFile >= txtFiles.size()) { \r\n        // exhausted files, start a new round\r\n        nextFile = 0;\r\n        round++;\r\n      }\r\n    }\r\n    \r\n    Document doc = new Document();\r\n    doc.add(new Field(\"name\",name,storeVal,indexVal,termVecVal));\r\n    BufferedReader reader = new BufferedReader(new FileReader(f));\r\n    String line = null;\r\n    //First line is the date, 3rd is the title, rest is body\r\n    String dateStr = reader.readLine();\r\n    reader.readLine();//skip an empty line\r\n    String title = reader.readLine();\r\n    reader.readLine();//skip an empty line\r\n    StringBuffer body = new StringBuffer(1024);\r\n    while ((line = reader.readLine()) != null) {\r\n      body.append(line).append(' ');\r\n    }\r\n    Date date = dateFormat.parse(dateStr.trim());\r\n    doc.add(new Field(\"date\", DateTools.dateToString(date, DateTools.Resolution.SECOND), \r\n        Field.Store.YES, Field.Index.UN_TOKENIZED));\r\n\r\n    if (title != null) {\r\n      doc.add(new Field(\"title\", title, storeVal,indexVal,termVecVal));\r\n    }\r\n    if (body.length() > 0) {\r\n        doc.add(new Field(\"body\", body.toString(), storeVal,indexVal,termVecVal));\r\n    }\r\n\r\n    count++;\r\n    addBytes(f.length());\r\n\r\n    return doc;\r\n  }\r\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"b2e70b697d9f5a6130848741a4f0cdc08a1fe258":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"2c374fcdaaef447f786e6c8a1841c44b24ec178c":["b2e70b697d9f5a6130848741a4f0cdc08a1fe258"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["2c374fcdaaef447f786e6c8a1841c44b24ec178c"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b2e70b697d9f5a6130848741a4f0cdc08a1fe258"],"b2e70b697d9f5a6130848741a4f0cdc08a1fe258":["2c374fcdaaef447f786e6c8a1841c44b24ec178c"],"2c374fcdaaef447f786e6c8a1841c44b24ec178c":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}