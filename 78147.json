{"path":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","commits":[{"id":"e3602d5eab954caecc726ab136ad580ac1ceb917","date":1228676831,"type":1,"author":"Ryan McKinley","isMerge":false,"pathNew":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","pathOld":"client/java/solrj/src/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","sourceNew":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new HashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    for( Map.Entry<String, Integer> entry : fq ) {\n      _facetQuery.put( entry.getKey(), entry.getValue() );\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","sourceOld":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new HashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    for( Map.Entry<String, Integer> entry : fq ) {\n      _facetQuery.put( entry.getKey(), entry.getValue() );\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"afba064abda4c484940fa0bb2a533000d0f1e8c0","date":1253219333,"type":3,"author":"Yonik Seeley","isMerge":false,"pathNew":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","pathOld":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","sourceNew":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new HashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    if (fq != null) {\n      for( Map.Entry<String, Integer> entry : fq ) {\n        _facetQuery.put( entry.getKey(), entry.getValue() );\n      }\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","sourceOld":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new HashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    for( Map.Entry<String, Integer> entry : fq ) {\n      _facetQuery.put( entry.getKey(), entry.getValue() );\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"40e4729093c74b3fb3d80df1f26015a85fbe4cc9","date":1268546085,"type":3,"author":"Yonik Seeley","isMerge":false,"pathNew":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","pathOld":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","sourceNew":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new LinkedHashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    if (fq != null) {\n      for( Map.Entry<String, Integer> entry : fq ) {\n        _facetQuery.put( entry.getKey(), entry.getValue() );\n      }\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","sourceOld":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new HashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    if (fq != null) {\n      for( Map.Entry<String, Integer> entry : fq ) {\n        _facetQuery.put( entry.getKey(), entry.getValue() );\n      }\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","bugFix":["acdd729ace9db5d0803eea4849ddc3c2ba196127"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ad94625fb8d088209f46650c8097196fec67f00c","date":1453508319,"type":5,"author":"Dawid Weiss","isMerge":false,"pathNew":"solr/src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","pathOld":"src/solrj/org/apache/solr/client/solrj/response/QueryResponse#extractFacetInfo(NamedList[Object]).mjava","sourceNew":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new LinkedHashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    if (fq != null) {\n      for( Map.Entry<String, Integer> entry : fq ) {\n        _facetQuery.put( entry.getKey(), entry.getValue() );\n      }\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","sourceOld":"  private void extractFacetInfo( NamedList<Object> info )\n  {\n    // Parse the queries\n    _facetQuery = new LinkedHashMap<String, Integer>();\n    NamedList<Integer> fq = (NamedList<Integer>) info.get( \"facet_queries\" );\n    if (fq != null) {\n      for( Map.Entry<String, Integer> entry : fq ) {\n        _facetQuery.put( entry.getKey(), entry.getValue() );\n      }\n    }\n    \n    // Parse the facet info into fields\n    // TODO?? The list could be <int> or <long>?  If always <long> then we can switch to <Long>\n    NamedList<NamedList<Number>> ff = (NamedList<NamedList<Number>>) info.get( \"facet_fields\" );\n    if( ff != null ) {\n      _facetFields = new ArrayList<FacetField>( ff.size() );\n      _limitingFacets = new ArrayList<FacetField>( ff.size() );\n      \n      long minsize = _results.getNumFound();\n      for( Map.Entry<String,NamedList<Number>> facet : ff ) {\n        FacetField f = new FacetField( facet.getKey() );\n        for( Map.Entry<String, Number> entry : facet.getValue() ) {\n          f.add( entry.getKey(), entry.getValue().longValue() );\n        }\n        \n        _facetFields.add( f );\n        FacetField nl = f.getLimitingFields( minsize );\n        if( nl.getValueCount() > 0 ) {\n          _limitingFacets.add( nl );\n        }\n      }\n    }\n    \n    //Parse date facets\n    NamedList<NamedList<Object>> df = (NamedList<NamedList<Object>>) info.get(\"facet_dates\");\n    if (df != null) {\n      // System.out.println(df);\n      _facetDates = new ArrayList<FacetField>( df.size() );\n      for (Map.Entry<String, NamedList<Object>> facet : df) {\n        // System.out.println(\"Key: \" + facet.getKey() + \" Value: \" + facet.getValue());\n        NamedList<Object> values = facet.getValue();\n        String gap = (String) values.get(\"gap\");\n        Date end = (Date) values.get(\"end\");\n        FacetField f = new FacetField(facet.getKey(), gap, end);\n        \n        for (Map.Entry<String, Object> entry : values)   {\n          try {\n            f.add(entry.getKey(), Long.parseLong(entry.getValue().toString()));\n          } catch (NumberFormatException e) {\n            //Ignore for non-number responses which are already handled above\n          }\n        }\n        \n        _facetDates.add(f);\n      }\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"e3602d5eab954caecc726ab136ad580ac1ceb917":["3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":[],"ad94625fb8d088209f46650c8097196fec67f00c":["40e4729093c74b3fb3d80df1f26015a85fbe4cc9"],"afba064abda4c484940fa0bb2a533000d0f1e8c0":["e3602d5eab954caecc726ab136ad580ac1ceb917"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"40e4729093c74b3fb3d80df1f26015a85fbe4cc9":["afba064abda4c484940fa0bb2a533000d0f1e8c0"]},"commit2Childs":{"e3602d5eab954caecc726ab136ad580ac1ceb917":["afba064abda4c484940fa0bb2a533000d0f1e8c0"],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":["e3602d5eab954caecc726ab136ad580ac1ceb917"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"ad94625fb8d088209f46650c8097196fec67f00c":[],"afba064abda4c484940fa0bb2a533000d0f1e8c0":["40e4729093c74b3fb3d80df1f26015a85fbe4cc9"],"40e4729093c74b3fb3d80df1f26015a85fbe4cc9":["ad94625fb8d088209f46650c8097196fec67f00c"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["ad94625fb8d088209f46650c8097196fec67f00c","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b","a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}