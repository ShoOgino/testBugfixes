{"path":"solr/core/src/java/org/apache/solr/search/SolrDocumentFetcher.RetrieveFieldsOptimizer#getSolrDoc(int).mjava","commits":[{"id":"96ecd141e96e7a7a65822d7fada5ddc585b21149","date":1534786652,"type":0,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/search/SolrDocumentFetcher.RetrieveFieldsOptimizer#getSolrDoc(int).mjava","pathOld":"/dev/null","sourceNew":"    private SolrDocument getSolrDoc(int luceneDocId) {\n\n      SolrDocument sdoc = null;\n      try {\n        if (returnStoredFields()) {\n          Document doc = doc(luceneDocId, getStoredFields());\n          // make sure to use the schema from the searcher and not the request (cross-core)\n          sdoc = DocsStreamer.convertLuceneDocToSolrDoc(doc, searcher.getSchema(), getReturnFields());\n          if (returnDVFields() == false) {\n            solrReturnFields.setFieldSources(SolrReturnFields.FIELD_SOURCES.ALL_FROM_STORED);\n            return sdoc;\n          } else {\n            solrReturnFields.setFieldSources(SolrReturnFields.FIELD_SOURCES.MIXED_SOURCES);\n          }\n        } else {\n          // no need to get stored fields of the document, see SOLR-5968\n          sdoc = new SolrDocument();\n          solrReturnFields.setFieldSources(SolrReturnFields.FIELD_SOURCES.ALL_FROM_DV);\n        }\n\n        // decorate the document with non-stored docValues fields\n        if (returnDVFields()) {\n          decorateDocValueFields(sdoc, luceneDocId, getDvFields());\n        }\n      } catch (IOException e) {\n        throw new SolrException(SolrException.ErrorCode.SERVER_ERROR, \"Error reading document with docId \" + luceneDocId, e);\n      }\n      return sdoc;\n    }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"96ecd141e96e7a7a65822d7fada5ddc585b21149":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["96ecd141e96e7a7a65822d7fada5ddc585b21149"]},"commit2Childs":{"96ecd141e96e7a7a65822d7fada5ddc585b21149":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["96ecd141e96e7a7a65822d7fada5ddc585b21149"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}