{"path":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","commits":[{"id":"4ca20be81c9284c840498143264e583ccbb8525a","date":1438705932,"type":0,"author":"Timothy Potter","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"/dev/null","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName)) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          File postJarFile = new File(exampledocsDir, \"post.jar\");\n          if (postJarFile.isFile()) {\n            echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n            String javaHome = System.getProperty(\"java.home\");\n            String java = javaHome+\"/bin/java\";\n            String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n\n            String postCmd = String.format(Locale.ROOT, \"%s -Durl=\\\"%s\\\" -jar %s \\\"%s\\\"/*.xml\",\n                java, updateUrl, postJarFile.getAbsolutePath(), exampledocsDir.getAbsolutePath());\n\n            executor.execute(org.apache.commons.exec.CommandLine.parse(postCmd));\n          } else {\n            echo(\"example/exampledocs/post.jar not found, skipping indexing step for the techproducts example\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"4d4eec9d2975493cb4680224e247c516742fa1be","date":1438720069,"type":3,"author":"Timothy Potter","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName)) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          File postJarFile = new File(exampledocsDir, \"post.jar\");\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n          if (postJarFile.isFile()) {\n            String javaHome = System.getProperty(\"java.home\");\n            String java = javaHome+\"/bin/java\";\n            String postCmd = String.format(Locale.ROOT, \"%s -Durl=\\\"%s\\\" -jar %s \\\"%s\\\"/*.xml\",\n                java, updateUrl, postJarFile.getAbsolutePath(), exampledocsDir.getAbsolutePath());\n            executor.execute(org.apache.commons.exec.CommandLine.parse(postCmd));\n          } else {\n            // a bit hacky, but just use SimplePostTool directly\n            String currentPropVal = System.getProperty(\"url\");\n            System.setProperty(\"url\", updateUrl);\n            SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n            if (currentPropVal != null) {\n              System.setProperty(\"url\", currentPropVal); // reset\n            } else {\n              System.clearProperty(\"url\");\n            }\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName)) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          File postJarFile = new File(exampledocsDir, \"post.jar\");\n          if (postJarFile.isFile()) {\n            echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n            String javaHome = System.getProperty(\"java.home\");\n            String java = javaHome+\"/bin/java\";\n            String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n\n            String postCmd = String.format(Locale.ROOT, \"%s -Durl=\\\"%s\\\" -jar %s \\\"%s\\\"/*.xml\",\n                java, updateUrl, postJarFile.getAbsolutePath(), exampledocsDir.getAbsolutePath());\n\n            executor.execute(org.apache.commons.exec.CommandLine.parse(postCmd));\n          } else {\n            echo(\"example/exampledocs/post.jar not found, skipping indexing step for the techproducts example\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"b05c717b53c062b652733f85b2667f3422bd13ea","date":1439481135,"type":3,"author":"Timothy Potter","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName)) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName)) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          File postJarFile = new File(exampledocsDir, \"post.jar\");\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n          if (postJarFile.isFile()) {\n            String javaHome = System.getProperty(\"java.home\");\n            String java = javaHome+\"/bin/java\";\n            String postCmd = String.format(Locale.ROOT, \"%s -Durl=\\\"%s\\\" -jar %s \\\"%s\\\"/*.xml\",\n                java, updateUrl, postJarFile.getAbsolutePath(), exampledocsDir.getAbsolutePath());\n            executor.execute(org.apache.commons.exec.CommandLine.parse(postCmd));\n          } else {\n            // a bit hacky, but just use SimplePostTool directly\n            String currentPropVal = System.getProperty(\"url\");\n            System.setProperty(\"url\", updateUrl);\n            SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n            if (currentPropVal != null) {\n              System.setProperty(\"url\", currentPropVal); // reset\n            } else {\n              System.clearProperty(\"url\");\n            }\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf","date":1452801849,"type":3,"author":"Varun Thacker","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName)) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"6dac22e2c68188d3e5c96ca60febedc05a96f44f","date":1498433282,"type":3,"author":"Ishan Chattopadhyaya","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"fbedfa79ef95dc2b5b49f7d54d80e0b47867f9b4","date":1498540685,"type":3,"author":"Shalin Shekhar Mangar","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"28288370235ed02234a64753cdbf0c6ec096304a","date":1498726817,"type":3,"author":"Karl Wright","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"data_driven_schema_configs\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"b79a5db147a1c6f95d1625ddbc3561ef56955225","date":1528848080,"type":3,"author":"Steve Rowe","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"7eeaaea0106c7d6a2de50acfc8d357121ef8bd26","date":1531589977,"type":3,"author":"Michael Braun","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"0efc9f2cae117418f13ba9035f5e1d516ea7a2b5","date":1531905561,"type":3,"author":"Alessandro Benedetti","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/util/SolrCLI.RunExampleTool#runExample(CommandLine,String).mjava","sourceNew":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","sourceOld":"    protected void runExample(CommandLine cli, String exampleName) throws Exception {\n      File exDir = setupExampleDir(serverDir, exampleDir, exampleName);\n      String collectionName = \"schemaless\".equals(exampleName) ? \"gettingstarted\" : exampleName;\n      String configSet =\n          \"techproducts\".equals(exampleName) ? \"sample_techproducts_configs\" : \"_default\";\n\n      boolean isCloudMode = cli.hasOption('c');\n      String zkHost = cli.getOptionValue('z');\n      int port = Integer.parseInt(cli.getOptionValue('p', \"8983\"));\n      Map<String,Object> nodeStatus = startSolr(new File(exDir, \"solr\"), isCloudMode, cli, port, zkHost, 30);\n\n      // invoke the CreateTool\n      File configsetsDir = new File(serverDir, \"solr/configsets\");\n\n      String solrUrl = (String)nodeStatus.get(\"baseUrl\");\n\n      // safe check if core / collection already exists\n      boolean alreadyExists = false;\n      if (nodeStatus.get(\"cloud\") != null) {\n        String collectionListUrl = solrUrl+\"/admin/collections?action=list\";\n        if (safeCheckCollectionExists(collectionListUrl, collectionName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Collection '\"+collectionName+\n              \"' already exists!\\nChecked collection existence using Collections API command:\\n\"+collectionListUrl+\"\\n\");\n        }\n      } else {\n        String coreName = collectionName;\n        String coreStatusUrl = solrUrl+\"/admin/cores?action=STATUS&core=\"+coreName;\n        if (safeCheckCoreExists(coreStatusUrl, coreName)) {\n          alreadyExists = true;\n          echo(\"\\nWARNING: Core '\" + coreName +\n              \"' already exists!\\nChecked core existence using Core API command:\\n\" + coreStatusUrl+\"\\n\");\n        }\n      }\n\n      if (!alreadyExists) {\n        String[] createArgs = new String[] {\n            \"-name\", collectionName,\n            \"-shards\", \"1\",\n            \"-replicationFactor\", \"1\",\n            \"-confname\", collectionName,\n            \"-confdir\", configSet,\n            \"-configsetsDir\", configsetsDir.getAbsolutePath(),\n            \"-solrUrl\", solrUrl\n        };\n        CreateTool createTool = new CreateTool(stdout);\n        int createCode =\n            createTool.runTool(processCommandLineArgs(joinCommonAndToolOptions(createTool.getOptions()), createArgs));\n        if (createCode != 0)\n          throw new Exception(\"Failed to create \"+collectionName+\" using command: \"+ Arrays.asList(createArgs));\n      }\n\n      if (\"techproducts\".equals(exampleName) && !alreadyExists) {\n\n        File exampledocsDir = new File(exampleDir, \"exampledocs\");\n        if (!exampledocsDir.isDirectory()) {\n          File readOnlyExampleDir = new File(serverDir.getParentFile(), \"example\");\n          if (readOnlyExampleDir.isDirectory()) {\n            exampledocsDir = new File(readOnlyExampleDir, \"exampledocs\");\n          }\n        }\n\n        if (exampledocsDir.isDirectory()) {\n          String updateUrl = String.format(Locale.ROOT, \"%s/%s/update\", solrUrl, collectionName);\n          echo(\"Indexing tech product example docs from \"+exampledocsDir.getAbsolutePath());\n\n          String currentPropVal = System.getProperty(\"url\");\n          System.setProperty(\"url\", updateUrl);\n          SimplePostTool.main(new String[] {exampledocsDir.getAbsolutePath()+\"/*.xml\"});\n          if (currentPropVal != null) {\n            System.setProperty(\"url\", currentPropVal); // reset\n          } else {\n            System.clearProperty(\"url\");\n          }\n        } else {\n          echo(\"exampledocs directory not found, skipping indexing step for the techproducts example\");\n        }\n      }\n\n      echo(\"\\nSolr \"+exampleName+\" example launched successfully. Direct your Web browser to \"+solrUrl+\" to visit the Solr Admin UI\");\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"4ca20be81c9284c840498143264e583ccbb8525a":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"0efc9f2cae117418f13ba9035f5e1d516ea7a2b5":["28288370235ed02234a64753cdbf0c6ec096304a","b79a5db147a1c6f95d1625ddbc3561ef56955225"],"b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf":["b05c717b53c062b652733f85b2667f3422bd13ea"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"fbedfa79ef95dc2b5b49f7d54d80e0b47867f9b4":["b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf","6dac22e2c68188d3e5c96ca60febedc05a96f44f"],"b05c717b53c062b652733f85b2667f3422bd13ea":["4d4eec9d2975493cb4680224e247c516742fa1be"],"6dac22e2c68188d3e5c96ca60febedc05a96f44f":["b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf"],"4d4eec9d2975493cb4680224e247c516742fa1be":["4ca20be81c9284c840498143264e583ccbb8525a"],"28288370235ed02234a64753cdbf0c6ec096304a":["b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf","6dac22e2c68188d3e5c96ca60febedc05a96f44f"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["b79a5db147a1c6f95d1625ddbc3561ef56955225"],"b79a5db147a1c6f95d1625ddbc3561ef56955225":["28288370235ed02234a64753cdbf0c6ec096304a"],"7eeaaea0106c7d6a2de50acfc8d357121ef8bd26":["28288370235ed02234a64753cdbf0c6ec096304a","b79a5db147a1c6f95d1625ddbc3561ef56955225"]},"commit2Childs":{"4ca20be81c9284c840498143264e583ccbb8525a":["4d4eec9d2975493cb4680224e247c516742fa1be"],"0efc9f2cae117418f13ba9035f5e1d516ea7a2b5":[],"b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf":["fbedfa79ef95dc2b5b49f7d54d80e0b47867f9b4","6dac22e2c68188d3e5c96ca60febedc05a96f44f","28288370235ed02234a64753cdbf0c6ec096304a"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["4ca20be81c9284c840498143264e583ccbb8525a"],"fbedfa79ef95dc2b5b49f7d54d80e0b47867f9b4":[],"b05c717b53c062b652733f85b2667f3422bd13ea":["b09d7cb8f3c2bf07ec3bc7a33ed04054deff20cf"],"6dac22e2c68188d3e5c96ca60febedc05a96f44f":["fbedfa79ef95dc2b5b49f7d54d80e0b47867f9b4","28288370235ed02234a64753cdbf0c6ec096304a"],"4d4eec9d2975493cb4680224e247c516742fa1be":["b05c717b53c062b652733f85b2667f3422bd13ea"],"28288370235ed02234a64753cdbf0c6ec096304a":["0efc9f2cae117418f13ba9035f5e1d516ea7a2b5","b79a5db147a1c6f95d1625ddbc3561ef56955225","7eeaaea0106c7d6a2de50acfc8d357121ef8bd26"],"b79a5db147a1c6f95d1625ddbc3561ef56955225":["0efc9f2cae117418f13ba9035f5e1d516ea7a2b5","cd5edd1f2b162a5cfa08efd17851a07373a96817","7eeaaea0106c7d6a2de50acfc8d357121ef8bd26"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[],"7eeaaea0106c7d6a2de50acfc8d357121ef8bd26":[]},"heads":["0efc9f2cae117418f13ba9035f5e1d516ea7a2b5","fbedfa79ef95dc2b5b49f7d54d80e0b47867f9b4","cd5edd1f2b162a5cfa08efd17851a07373a96817","7eeaaea0106c7d6a2de50acfc8d357121ef8bd26"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}