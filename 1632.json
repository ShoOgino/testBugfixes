{"path":"solr/core/src/java/org/apache/solr/search/JoinQuery.JoinQueryWeight#getDocSet().mjava","commits":[{"id":"1e1491db4de13536b70146fc5a8f03101f0f84de","date":1593014806,"type":1,"author":"Atri Sharma","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/search/JoinQuery.JoinQueryWeight#getDocSet().mjava","pathOld":"solr/core/src/java/org/apache/solr/search/JoinQuery[JoinQParserPlugin].JoinQueryWeight#getDocSet().mjava","sourceNew":"    public DocSet getDocSet() throws IOException {\n      SchemaField fromSchemaField = fromSearcher.getSchema().getField(fromField);\n      SchemaField toSchemaField = toSearcher.getSchema().getField(toField);\n\n      boolean usePoints = false;\n      if (toSchemaField.getType().isPointField()) {\n        if (!fromSchemaField.hasDocValues()) {\n          throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, \"join from field \" + fromSchemaField + \" should have docValues to join with points field \" + toSchemaField);\n        }\n        usePoints = true;\n      }\n\n      if (!usePoints) {\n        return getDocSetEnumerate();\n      }\n\n      // point fields\n      GraphPointsCollector collector = new GraphPointsCollector(fromSchemaField, null, null);\n      fromSearcher.search(q, collector);\n      Query resultQ = collector.getResultQuery(toSchemaField, false);\n      // don't cache the resulting docSet... the query may be very large.  Better to cache the results of the join query itself\n      DocSet result = resultQ==null ? DocSet.empty() : toSearcher.getDocSetNC(resultQ, null);\n      return result;\n    }\n\n","sourceOld":"    public DocSet getDocSet() throws IOException {\n      SchemaField fromSchemaField = fromSearcher.getSchema().getField(fromField);\n      SchemaField toSchemaField = toSearcher.getSchema().getField(toField);\n\n      boolean usePoints = false;\n      if (toSchemaField.getType().isPointField()) {\n        if (!fromSchemaField.hasDocValues()) {\n          throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, \"join from field \" + fromSchemaField + \" should have docValues to join with points field \" + toSchemaField);\n        }\n        usePoints = true;\n      }\n\n      if (!usePoints) {\n        return getDocSetEnumerate();\n      }\n\n      // point fields\n      GraphPointsCollector collector = new GraphPointsCollector(fromSchemaField, null, null);\n      fromSearcher.search(q, collector);\n      Query resultQ = collector.getResultQuery(toSchemaField, false);\n      // don't cache the resulting docSet... the query may be very large.  Better to cache the results of the join query itself\n      DocSet result = resultQ==null ? DocSet.empty() : toSearcher.getDocSetNC(resultQ, null);\n      return result;\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"1e1491db4de13536b70146fc5a8f03101f0f84de":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["1e1491db4de13536b70146fc5a8f03101f0f84de"]},"commit2Childs":{"1e1491db4de13536b70146fc5a8f03101f0f84de":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["1e1491db4de13536b70146fc5a8f03101f0f84de"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}