{"path":"solr/core/src/test/org/apache/solr/cloud/TestRSAKeyPair#testRoundTrip(CryptoKeys.RSAKeyPair).mjava","commits":[{"id":"b409047f69fb85704c506753bc23a37d7ad37b54","date":1582574830,"type":0,"author":"Mike","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/TestRSAKeyPair#testRoundTrip(CryptoKeys.RSAKeyPair).mjava","pathOld":"/dev/null","sourceNew":"    private void testRoundTrip(CryptoKeys.RSAKeyPair kp) throws Exception {\n        final byte[] plaintext = new byte[random().nextInt(64)];\n        random().nextBytes(plaintext);\n\n        byte[] encrypted = kp.encrypt(ByteBuffer.wrap(plaintext));\n        assertThat(plaintext, not(equalTo(encrypted)));\n\n        byte[] decrypted = CryptoKeys.decryptRSA(encrypted, kp.getPublicKey());\n\n        assertTrue(\"Decrypted text is shorter than original text.\", decrypted.length >= plaintext.length);\n\n        // Pad with null bytes because RSAKeyPair uses RSA/ECB/NoPadding\n        int pad = decrypted.length - plaintext.length;\n        final byte[] padded = new byte[decrypted.length];\n        System.arraycopy(plaintext, 0, padded, pad, plaintext.length);\n        assertArrayEquals(padded, decrypted);\n    }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"b409047f69fb85704c506753bc23a37d7ad37b54":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["b409047f69fb85704c506753bc23a37d7ad37b54"]},"commit2Childs":{"b409047f69fb85704c506753bc23a37d7ad37b54":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b409047f69fb85704c506753bc23a37d7ad37b54"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}