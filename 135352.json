{"path":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int,TermVectorOffsetInfo).mjava","commits":[{"id":"6177f0f28ace66d1538b1e6ac5f1773e5449a0b0","date":1096997448,"type":1,"author":"Christoph Goller","isMerge":false,"pathNew":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int,TermVectorOffsetInfo).mjava","pathOld":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int).mjava","sourceNew":"  private final void addPosition(String field, String text, int position, TermVectorOffsetInfo offset) {\n    termBuffer.set(field, text);\n    //System.out.println(\"Offset: \" + offset);\n    Posting ti = (Posting) postingTable.get(termBuffer);\n    if (ti != null) {\t\t\t\t  // word seen before\n      int freq = ti.freq;\n      if (ti.positions.length == freq) {\t  // positions array is full\n        int[] newPositions = new int[freq * 2];\t  // double size\n        int[] positions = ti.positions;\n        for (int i = 0; i < freq; i++)\t\t  // copy old positions to new\n          newPositions[i] = positions[i];\n        ti.positions = newPositions;\n      }\n      ti.positions[freq] = position;\t\t  // add new position\n\n      if (offset != null) {\n        if (ti.offsets.length == freq){\n          TermVectorOffsetInfo [] newOffsets = new TermVectorOffsetInfo[freq*2];\n          TermVectorOffsetInfo [] offsets = ti.offsets;\n          for (int i = 0; i < freq; i++)\n          {\n            newOffsets[i] = offsets[i];\n          }\n          ti.offsets = newOffsets;\n        }\n        ti.offsets[freq] = offset;\n      }\n      ti.freq = freq + 1;\t\t\t  // update frequency\n    } else {\t\t\t\t\t  // word not seen before\n      Term term = new Term(field, text, false);\n      postingTable.put(term, new Posting(term, position, offset));\n    }\n  }\n\n","sourceOld":"  private final void addPosition(String field, String text, int position) {\n    termBuffer.set(field, text);\n    Posting ti = (Posting) postingTable.get(termBuffer);\n    if (ti != null) {\t\t\t\t  // word seen before\n      int freq = ti.freq;\n      if (ti.positions.length == freq) {\t  // positions array is full\n        int[] newPositions = new int[freq * 2];\t  // double size\n        int[] positions = ti.positions;\n        for (int i = 0; i < freq; i++)\t\t  // copy old positions to new\n          newPositions[i] = positions[i];\n        ti.positions = newPositions;\n      }\n      ti.positions[freq] = position;\t\t  // add new position\n      ti.freq = freq + 1;\t\t\t  // update frequency\n    } else {\t\t\t\t\t  // word not seen before\n      Term term = new Term(field, text, false);\n      postingTable.put(term, new Posting(term, position));\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"cab38a09ae21af22e5395a71f4a5ee93f0af7448","date":1163762291,"type":3,"author":"Michael McCandless","isMerge":false,"pathNew":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int,TermVectorOffsetInfo).mjava","pathOld":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int,TermVectorOffsetInfo).mjava","sourceNew":"  private final void addPosition(String field, String text, int position, TermVectorOffsetInfo offset) {\n    termBuffer.set(field, text);\n    //System.out.println(\"Offset: \" + offset);\n    Posting ti = (Posting) postingTable.get(termBuffer);\n    if (ti != null) {\t\t\t\t  // word seen before\n      int freq = ti.freq;\n      if (ti.positions.length == freq) {\t  // positions array is full\n        int[] newPositions = new int[freq * 2];\t  // double size\n        int[] positions = ti.positions;\n        System.arraycopy(positions, 0, newPositions, 0, freq);\n        ti.positions = newPositions;\n      }\n      ti.positions[freq] = position;\t\t  // add new position\n\n      if (offset != null) {\n        if (ti.offsets.length == freq){\n          TermVectorOffsetInfo [] newOffsets = new TermVectorOffsetInfo[freq*2];\n          TermVectorOffsetInfo [] offsets = ti.offsets;\n          System.arraycopy(offsets, 0, newOffsets, 0, freq);\n          ti.offsets = newOffsets;\n        }\n        ti.offsets[freq] = offset;\n      }\n      ti.freq = freq + 1;\t\t\t  // update frequency\n    } else {\t\t\t\t\t  // word not seen before\n      Term term = new Term(field, text, false);\n      postingTable.put(term, new Posting(term, position, offset));\n    }\n  }\n\n","sourceOld":"  private final void addPosition(String field, String text, int position, TermVectorOffsetInfo offset) {\n    termBuffer.set(field, text);\n    //System.out.println(\"Offset: \" + offset);\n    Posting ti = (Posting) postingTable.get(termBuffer);\n    if (ti != null) {\t\t\t\t  // word seen before\n      int freq = ti.freq;\n      if (ti.positions.length == freq) {\t  // positions array is full\n        int[] newPositions = new int[freq * 2];\t  // double size\n        int[] positions = ti.positions;\n        for (int i = 0; i < freq; i++)\t\t  // copy old positions to new\n          newPositions[i] = positions[i];\n        ti.positions = newPositions;\n      }\n      ti.positions[freq] = position;\t\t  // add new position\n\n      if (offset != null) {\n        if (ti.offsets.length == freq){\n          TermVectorOffsetInfo [] newOffsets = new TermVectorOffsetInfo[freq*2];\n          TermVectorOffsetInfo [] offsets = ti.offsets;\n          for (int i = 0; i < freq; i++)\n          {\n            newOffsets[i] = offsets[i];\n          }\n          ti.offsets = newOffsets;\n        }\n        ti.offsets[freq] = offset;\n      }\n      ti.freq = freq + 1;\t\t\t  // update frequency\n    } else {\t\t\t\t\t  // word not seen before\n      Term term = new Term(field, text, false);\n      postingTable.put(term, new Posting(term, position, offset));\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"8522ae207a56c6db28ca06fe6cc33e70911c3600","date":1173935743,"type":5,"author":"Michael Busch","isMerge":false,"pathNew":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int,Payload,TermVectorOffsetInfo).mjava","pathOld":"src/java/org/apache/lucene/index/DocumentWriter#addPosition(String,String,int,TermVectorOffsetInfo).mjava","sourceNew":"  private final void addPosition(String field, String text, int position, Payload payload, TermVectorOffsetInfo offset) {\n    termBuffer.set(field, text);\n    //System.out.println(\"Offset: \" + offset);\n    Posting ti = (Posting) postingTable.get(termBuffer);\n    if (ti != null) {\t\t\t\t  // word seen before\n      int freq = ti.freq;\n      if (ti.positions.length == freq) {\t  // positions array is full\n        int[] newPositions = new int[freq * 2];\t  // double size\n        int[] positions = ti.positions;\n        System.arraycopy(positions, 0, newPositions, 0, freq);\n        ti.positions = newPositions;\n        \n        if (ti.payloads != null) {\n          // the current field stores payloads\n          Payload[] newPayloads = new Payload[freq * 2];  // grow payloads array\n          Payload[] payloads = ti.payloads;\n          System.arraycopy(payloads, 0, newPayloads, 0, payloads.length);\n          ti.payloads = newPayloads;\n        }\n      }\n      ti.positions[freq] = position;\t\t  // add new position\n\n      if (payload != null) {\n        if (ti.payloads == null) {\n          // lazily allocate payload array\n          ti.payloads = new Payload[ti.positions.length];\n        }\n        ti.payloads[freq] = payload;\n      }\n      \n      if (offset != null) {\n        if (ti.offsets.length == freq){\n          TermVectorOffsetInfo [] newOffsets = new TermVectorOffsetInfo[freq*2];\n          TermVectorOffsetInfo [] offsets = ti.offsets;\n          System.arraycopy(offsets, 0, newOffsets, 0, freq);\n          ti.offsets = newOffsets;\n        }\n        ti.offsets[freq] = offset;\n      }\n      ti.freq = freq + 1;\t\t\t  // update frequency\n    } else {\t\t\t\t\t  // word not seen before\n      Term term = new Term(field, text, false);\n      postingTable.put(term, new Posting(term, position, payload, offset));\n    }\n  }\n\n","sourceOld":"  private final void addPosition(String field, String text, int position, TermVectorOffsetInfo offset) {\n    termBuffer.set(field, text);\n    //System.out.println(\"Offset: \" + offset);\n    Posting ti = (Posting) postingTable.get(termBuffer);\n    if (ti != null) {\t\t\t\t  // word seen before\n      int freq = ti.freq;\n      if (ti.positions.length == freq) {\t  // positions array is full\n        int[] newPositions = new int[freq * 2];\t  // double size\n        int[] positions = ti.positions;\n        System.arraycopy(positions, 0, newPositions, 0, freq);\n        ti.positions = newPositions;\n      }\n      ti.positions[freq] = position;\t\t  // add new position\n\n      if (offset != null) {\n        if (ti.offsets.length == freq){\n          TermVectorOffsetInfo [] newOffsets = new TermVectorOffsetInfo[freq*2];\n          TermVectorOffsetInfo [] offsets = ti.offsets;\n          System.arraycopy(offsets, 0, newOffsets, 0, freq);\n          ti.offsets = newOffsets;\n        }\n        ti.offsets[freq] = offset;\n      }\n      ti.freq = freq + 1;\t\t\t  // update frequency\n    } else {\t\t\t\t\t  // word not seen before\n      Term term = new Term(field, text, false);\n      postingTable.put(term, new Posting(term, position, offset));\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"cab38a09ae21af22e5395a71f4a5ee93f0af7448":["6177f0f28ace66d1538b1e6ac5f1773e5449a0b0"],"8522ae207a56c6db28ca06fe6cc33e70911c3600":["cab38a09ae21af22e5395a71f4a5ee93f0af7448"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"6177f0f28ace66d1538b1e6ac5f1773e5449a0b0":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["8522ae207a56c6db28ca06fe6cc33e70911c3600"]},"commit2Childs":{"cab38a09ae21af22e5395a71f4a5ee93f0af7448":["8522ae207a56c6db28ca06fe6cc33e70911c3600"],"8522ae207a56c6db28ca06fe6cc33e70911c3600":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["6177f0f28ace66d1538b1e6ac5f1773e5449a0b0"],"6177f0f28ace66d1538b1e6ac5f1773e5449a0b0":["cab38a09ae21af22e5395a71f4a5ee93f0af7448"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}