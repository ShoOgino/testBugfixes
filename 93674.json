{"path":"solr/core/src/test/org/apache/solr/handler/component/DistributedFacetPivotWhiteBoxTest#doShardTestTopStats().mjava","commits":[{"id":"4c18a95e9168a30be855f5d5e7d61a863186fdc5","date":1415142581,"type":0,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/handler/component/DistributedFacetPivotWhiteBoxTest#doShardTestTopStats().mjava","pathOld":"/dev/null","sourceNew":"  /** \n   * recreates the initial request to a shard in a distributed query\n   * confirming that both top level stats, and per-pivot stats are returned.\n   */\n  private void doShardTestTopStats() throws Exception {\n\n    SolrParams params = params(\"facet\", \"true\", \n                               \"q\", \"*:*\", \n                               // \"wt\", \"javabin\", \n                               \"facet.pivot\", \"{!stats=s1}place_t,company_t\", \n                               // \"version\", \"2\", \n                               \"start\", \"0\", \"rows\", \"0\", \n                               \"fsv\", \"true\", \n                               \"fl\", \"id,score\",\n                               \"stats\", \"true\", \n                               \"stats.field\", \"{!key=avg_price tag=s1}price_ti\",\n                               \"f.place_t.facet.limit\", \"160\", \n                               \"f.place_t.facet.pivot.mincount\", \"0\", \n                               \"f.company_t.facet.limit\", \"160\", \n                               \"f.company_t.facet.pivot.mincount\", \"0\", \n                               \"isShard\", \"true\", \"distrib\", \"false\");\n    QueryResponse rsp = queryServer(new ModifiableSolrParams(params));\n\n    assertNotNull(\"initial shard request should include non-null top level stats\", \n                  rsp.getFieldStatsInfo());\n    assertFalse(\"initial shard request should include top level stats\", \n                rsp.getFieldStatsInfo().isEmpty());\n\n    List<PivotField> placePivots = rsp.getFacetPivot().get(\"place_t,company_t\");\n    for (PivotField pivotField : placePivots) {\n      assertFalse(\"pivot stats should not be empty in initial request\",\n                  pivotField.getFieldStatsInfo().isEmpty());\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"4c18a95e9168a30be855f5d5e7d61a863186fdc5":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["4c18a95e9168a30be855f5d5e7d61a863186fdc5"]},"commit2Childs":{"4c18a95e9168a30be855f5d5e7d61a863186fdc5":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["4c18a95e9168a30be855f5d5e7d61a863186fdc5"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}