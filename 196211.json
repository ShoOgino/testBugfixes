{"path":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","commits":[{"id":"edf5b262a72d10530eb2f01dc8f19060355b213e","date":1557765866,"type":1,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","pathOld":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,TimeSource).mjava","sourceNew":"  public static SimCloudManager createCluster(SolrCloudManager other, AutoScalingConfig config, TimeSource timeSource) throws Exception {\n    SimDistribStateManager distribStateManager = new SimDistribStateManager(SimDistribStateManager.createNewRootNode());\n    distribStateManager.copyFrom(other.getDistribStateManager(), false);\n    SimCloudManager cloudManager = new SimCloudManager(timeSource, distribStateManager);\n    if (config != null) {\n      cloudManager.getSimDistribStateManager().simSetAutoScalingConfig(config);\n    } else {\n      config = cloudManager.getDistribStateManager().getAutoScalingConfig();\n    }\n    Set<String> nodeTags = new HashSet<>(SimUtils.COMMON_NODE_TAGS);\n    nodeTags.addAll(config.getPolicy().getParams());\n    Set<String> replicaTags = new HashSet<>(SimUtils.COMMON_REPLICA_TAGS);\n    replicaTags.addAll(config.getPolicy().getPerReplicaAttributes());\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<ReplicaInfo>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    SimUtils.checkConsistency(cloudManager, config);\n    return cloudManager;\n  }\n\n","sourceOld":"  public static SimCloudManager createCluster(SolrCloudManager other, TimeSource timeSource) throws Exception {\n    SimCloudManager cloudManager = new SimCloudManager(timeSource);\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    List<String> replicaTags = Arrays.asList(\n        Variable.Type.CORE_IDX.metricsAttribute,\n        \"QUERY./select.requests\",\n        \"UPDATE./update.requests\"\n    );\n    Set<String> nodeTags = createNodeValues(\"unused:1234_solr\").keySet();\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<ReplicaInfo>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    cloudManager.getSimDistribStateManager().copyFrom(other.getDistribStateManager(), false);\n    return cloudManager;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"e5028c6838e2e49cb9da1cf70269851c049f107a","date":1584984100,"type":3,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","pathOld":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","sourceNew":"  public static SimCloudManager createCluster(SolrCloudManager other, AutoScalingConfig config, TimeSource timeSource) throws Exception {\n    SimDistribStateManager distribStateManager = new SimDistribStateManager(SimDistribStateManager.createNewRootNode());\n    distribStateManager.copyFrom(other.getDistribStateManager(), false);\n    SimCloudManager cloudManager = new SimCloudManager(timeSource, distribStateManager);\n    if (config != null) {\n      cloudManager.getSimDistribStateManager().simSetAutoScalingConfig(config);\n    } else {\n      config = cloudManager.getDistribStateManager().getAutoScalingConfig();\n    }\n    Set<String> nodeTags = new HashSet<>(SimUtils.COMMON_NODE_TAGS);\n    nodeTags.addAll(config.getPolicy().getParamNames());\n    Set<String> replicaTags = new HashSet<>(SimUtils.COMMON_REPLICA_TAGS);\n    replicaTags.addAll(config.getPolicy().getPerReplicaAttributes());\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<ReplicaInfo>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    SimUtils.checkConsistency(cloudManager, config);\n    return cloudManager;\n  }\n\n","sourceOld":"  public static SimCloudManager createCluster(SolrCloudManager other, AutoScalingConfig config, TimeSource timeSource) throws Exception {\n    SimDistribStateManager distribStateManager = new SimDistribStateManager(SimDistribStateManager.createNewRootNode());\n    distribStateManager.copyFrom(other.getDistribStateManager(), false);\n    SimCloudManager cloudManager = new SimCloudManager(timeSource, distribStateManager);\n    if (config != null) {\n      cloudManager.getSimDistribStateManager().simSetAutoScalingConfig(config);\n    } else {\n      config = cloudManager.getDistribStateManager().getAutoScalingConfig();\n    }\n    Set<String> nodeTags = new HashSet<>(SimUtils.COMMON_NODE_TAGS);\n    nodeTags.addAll(config.getPolicy().getParams());\n    Set<String> replicaTags = new HashSet<>(SimUtils.COMMON_REPLICA_TAGS);\n    replicaTags.addAll(config.getPolicy().getPerReplicaAttributes());\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<ReplicaInfo>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    SimUtils.checkConsistency(cloudManager, config);\n    return cloudManager;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"7e8ce2f9d2ddfcf5cfa7e73b8b2af287a2a276fd","date":1594731683,"type":3,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","pathOld":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","sourceNew":"  public static SimCloudManager createCluster(SolrCloudManager other, AutoScalingConfig config, TimeSource timeSource) throws Exception {\n    SimDistribStateManager distribStateManager = new SimDistribStateManager(SimDistribStateManager.createNewRootNode());\n    distribStateManager.copyFrom(other.getDistribStateManager(), false);\n    SimCloudManager cloudManager = new SimCloudManager(timeSource, distribStateManager);\n    if (config != null) {\n      cloudManager.getSimDistribStateManager().simSetAutoScalingConfig(config);\n    } else {\n      config = cloudManager.getDistribStateManager().getAutoScalingConfig();\n    }\n    Set<String> nodeTags = new HashSet<>(SimUtils.COMMON_NODE_TAGS);\n    nodeTags.addAll(config.getPolicy().getParamNames());\n    Set<String> replicaTags = new HashSet<>(SimUtils.COMMON_REPLICA_TAGS);\n    replicaTags.addAll(config.getPolicy().getPerReplicaAttributes());\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<Replica>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    SimUtils.checkConsistency(cloudManager, config);\n    return cloudManager;\n  }\n\n","sourceOld":"  public static SimCloudManager createCluster(SolrCloudManager other, AutoScalingConfig config, TimeSource timeSource) throws Exception {\n    SimDistribStateManager distribStateManager = new SimDistribStateManager(SimDistribStateManager.createNewRootNode());\n    distribStateManager.copyFrom(other.getDistribStateManager(), false);\n    SimCloudManager cloudManager = new SimCloudManager(timeSource, distribStateManager);\n    if (config != null) {\n      cloudManager.getSimDistribStateManager().simSetAutoScalingConfig(config);\n    } else {\n      config = cloudManager.getDistribStateManager().getAutoScalingConfig();\n    }\n    Set<String> nodeTags = new HashSet<>(SimUtils.COMMON_NODE_TAGS);\n    nodeTags.addAll(config.getPolicy().getParamNames());\n    Set<String> replicaTags = new HashSet<>(SimUtils.COMMON_REPLICA_TAGS);\n    replicaTags.addAll(config.getPolicy().getPerReplicaAttributes());\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<ReplicaInfo>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    SimUtils.checkConsistency(cloudManager, config);\n    return cloudManager;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"3f504512a03d978990cbff30db0522b354e846db","date":1595247421,"type":4,"author":"Ishan Chattopadhyaya","isMerge":false,"pathNew":"/dev/null","pathOld":"solr/core/src/java/org/apache/solr/cloud/autoscaling/sim/SimCloudManager#createCluster(SolrCloudManager,AutoScalingConfig,TimeSource).mjava","sourceNew":null,"sourceOld":"  public static SimCloudManager createCluster(SolrCloudManager other, AutoScalingConfig config, TimeSource timeSource) throws Exception {\n    SimDistribStateManager distribStateManager = new SimDistribStateManager(SimDistribStateManager.createNewRootNode());\n    distribStateManager.copyFrom(other.getDistribStateManager(), false);\n    SimCloudManager cloudManager = new SimCloudManager(timeSource, distribStateManager);\n    if (config != null) {\n      cloudManager.getSimDistribStateManager().simSetAutoScalingConfig(config);\n    } else {\n      config = cloudManager.getDistribStateManager().getAutoScalingConfig();\n    }\n    Set<String> nodeTags = new HashSet<>(SimUtils.COMMON_NODE_TAGS);\n    nodeTags.addAll(config.getPolicy().getParamNames());\n    Set<String> replicaTags = new HashSet<>(SimUtils.COMMON_REPLICA_TAGS);\n    replicaTags.addAll(config.getPolicy().getPerReplicaAttributes());\n    cloudManager.getSimClusterStateProvider().copyFrom(other.getClusterStateProvider());\n    for (String node : other.getClusterStateProvider().getLiveNodes()) {\n      SimClusterStateProvider simClusterStateProvider = cloudManager.getSimClusterStateProvider();\n      cloudManager.getSimNodeStateProvider().simSetNodeValues(node, other.getNodeStateProvider().getNodeValues(node, nodeTags));\n      Map<String, Map<String, List<Replica>>> infos = other.getNodeStateProvider().getReplicaInfo(node, replicaTags);\n      simClusterStateProvider.simSetReplicaValues(node, infos, true);\n    }\n    SimUtils.checkConsistency(cloudManager, config);\n    return cloudManager;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"7e8ce2f9d2ddfcf5cfa7e73b8b2af287a2a276fd":["e5028c6838e2e49cb9da1cf70269851c049f107a"],"3f504512a03d978990cbff30db0522b354e846db":["7e8ce2f9d2ddfcf5cfa7e73b8b2af287a2a276fd"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"edf5b262a72d10530eb2f01dc8f19060355b213e":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"e5028c6838e2e49cb9da1cf70269851c049f107a":["edf5b262a72d10530eb2f01dc8f19060355b213e"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["3f504512a03d978990cbff30db0522b354e846db"]},"commit2Childs":{"7e8ce2f9d2ddfcf5cfa7e73b8b2af287a2a276fd":["3f504512a03d978990cbff30db0522b354e846db"],"3f504512a03d978990cbff30db0522b354e846db":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["edf5b262a72d10530eb2f01dc8f19060355b213e"],"edf5b262a72d10530eb2f01dc8f19060355b213e":["e5028c6838e2e49cb9da1cf70269851c049f107a"],"e5028c6838e2e49cb9da1cf70269851c049f107a":["7e8ce2f9d2ddfcf5cfa7e73b8b2af287a2a276fd"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}