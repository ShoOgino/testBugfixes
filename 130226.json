{"path":"solr/core/src/test/org/apache/solr/search/RankQueryTest#testPluggableCollector().mjava","commits":[{"id":"6c70567cc1ae757045c80cb458b0b2a2ffcf0141","date":1400098332,"type":0,"author":"Joel Bernstein","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/RankQueryTest#testPluggableCollector().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void testPluggableCollector() throws Exception {\n\n    String[] doc = {\"id\",\"1\", \"sort_i\", \"100\"};\n    assertU(adoc(doc));\n    assertU(commit());\n    String[] doc1 = {\"id\",\"2\", \"sort_i\", \"50\"};\n    assertU(adoc(doc1));\n\n\n\n    String[] doc2 = {\"id\",\"3\", \"sort_i\", \"1000\"};\n    assertU(adoc(doc2));\n    assertU(commit());\n    String[] doc3 = {\"id\",\"4\", \"sort_i\", \"2000\"};\n    assertU(adoc(doc3));\n\n\n    String[] doc4 = {\"id\",\"5\", \"sort_i\", \"2\"};\n    assertU(adoc(doc4));\n    assertU(commit());\n    String[] doc5 = {\"id\",\"6\", \"sort_i\",\"11\"};\n    assertU(adoc(doc5));\n    assertU(commit());\n\n\n    ModifiableSolrParams params = new ModifiableSolrParams();\n\n    params.add(\"qq\", \"*:*\");\n    params.add(\"q\", \"{!rank q=$qq}\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[1]/str[@name='id'][.='4']\",\n        \"//result/doc[2]/str[@name='id'][.='3']\",\n        \"//result/doc[3]/str[@name='id'][.='1']\",\n        \"//result/doc[4]/str[@name='id'][.='2']\",\n        \"//result/doc[5]/str[@name='id'][.='6']\",\n        \"//result/doc[6]/str[@name='id'][.='5']\"\n    );\n\n    params = new ModifiableSolrParams();\n    params.add(\"qq\", \"{!edismax bf=$bff}*:*\");\n    params.add(\"bff\", \"field(sort_i)\");\n    params.add(\"q\", \"{!rank q=$qq collector=1}\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n\n    params = new ModifiableSolrParams();\n    params.add(\"q\", \"*:*\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ccc69a67d5c846a04c7f71e28cb1914e3af895f3","date":1400252660,"type":0,"author":"Robert Muir","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/search/RankQueryTest#testPluggableCollector().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void testPluggableCollector() throws Exception {\n\n    String[] doc = {\"id\",\"1\", \"sort_i\", \"100\"};\n    assertU(adoc(doc));\n    assertU(commit());\n    String[] doc1 = {\"id\",\"2\", \"sort_i\", \"50\"};\n    assertU(adoc(doc1));\n\n\n\n    String[] doc2 = {\"id\",\"3\", \"sort_i\", \"1000\"};\n    assertU(adoc(doc2));\n    assertU(commit());\n    String[] doc3 = {\"id\",\"4\", \"sort_i\", \"2000\"};\n    assertU(adoc(doc3));\n\n\n    String[] doc4 = {\"id\",\"5\", \"sort_i\", \"2\"};\n    assertU(adoc(doc4));\n    assertU(commit());\n    String[] doc5 = {\"id\",\"6\", \"sort_i\",\"11\"};\n    assertU(adoc(doc5));\n    assertU(commit());\n\n\n    ModifiableSolrParams params = new ModifiableSolrParams();\n\n    params.add(\"qq\", \"*:*\");\n    params.add(\"q\", \"{!rank q=$qq}\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[1]/str[@name='id'][.='4']\",\n        \"//result/doc[2]/str[@name='id'][.='3']\",\n        \"//result/doc[3]/str[@name='id'][.='1']\",\n        \"//result/doc[4]/str[@name='id'][.='2']\",\n        \"//result/doc[5]/str[@name='id'][.='6']\",\n        \"//result/doc[6]/str[@name='id'][.='5']\"\n    );\n\n    params = new ModifiableSolrParams();\n    params.add(\"qq\", \"{!edismax bf=$bff}*:*\");\n    params.add(\"bff\", \"field(sort_i)\");\n    params.add(\"q\", \"{!rank q=$qq collector=1}\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n\n    params = new ModifiableSolrParams();\n    params.add(\"q\", \"*:*\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"c218ef5584c663e78bdaf8391f826546f5bc73c1","date":1401196755,"type":3,"author":"Joel Bernstein","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/RankQueryTest#testPluggableCollector().mjava","pathOld":"solr/core/src/test/org/apache/solr/search/RankQueryTest#testPluggableCollector().mjava","sourceNew":"  @Test\n  public void testPluggableCollector() throws Exception {\n\n    String[] doc = {\"id\",\"1\", \"sort_i\", \"100\"};\n    assertU(adoc(doc));\n    assertU(commit());\n    String[] doc1 = {\"id\",\"2\", \"sort_i\", \"50\"};\n    assertU(adoc(doc1));\n\n\n\n    String[] doc2 = {\"id\",\"3\", \"sort_i\", \"1000\"};\n    assertU(adoc(doc2));\n    assertU(commit());\n    String[] doc3 = {\"id\",\"4\", \"sort_i\", \"2000\"};\n    assertU(adoc(doc3));\n\n\n    String[] doc4 = {\"id\",\"5\", \"sort_i\", \"2\"};\n    assertU(adoc(doc4));\n    assertU(commit());\n    String[] doc5 = {\"id\",\"6\", \"sort_i\",\"11\"};\n    assertU(adoc(doc5));\n    assertU(commit());\n\n\n    ModifiableSolrParams params = new ModifiableSolrParams();\n\n    params.add(\"q\", \"*:*\");\n    params.add(\"rq\", \"{!rank}\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[1]/str[@name='id'][.='4']\",\n        \"//result/doc[2]/str[@name='id'][.='3']\",\n        \"//result/doc[3]/str[@name='id'][.='1']\",\n        \"//result/doc[4]/str[@name='id'][.='2']\",\n        \"//result/doc[5]/str[@name='id'][.='6']\",\n        \"//result/doc[6]/str[@name='id'][.='5']\"\n    );\n\n    params = new ModifiableSolrParams();\n    params.add(\"q\", \"{!edismax bf=$bff}*:*\");\n    params.add(\"bff\", \"field(sort_i)\");\n    params.add(\"rq\", \"{!rank collector=1}\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n\n    params = new ModifiableSolrParams();\n    params.add(\"q\", \"*:*\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n  }\n\n","sourceOld":"  @Test\n  public void testPluggableCollector() throws Exception {\n\n    String[] doc = {\"id\",\"1\", \"sort_i\", \"100\"};\n    assertU(adoc(doc));\n    assertU(commit());\n    String[] doc1 = {\"id\",\"2\", \"sort_i\", \"50\"};\n    assertU(adoc(doc1));\n\n\n\n    String[] doc2 = {\"id\",\"3\", \"sort_i\", \"1000\"};\n    assertU(adoc(doc2));\n    assertU(commit());\n    String[] doc3 = {\"id\",\"4\", \"sort_i\", \"2000\"};\n    assertU(adoc(doc3));\n\n\n    String[] doc4 = {\"id\",\"5\", \"sort_i\", \"2\"};\n    assertU(adoc(doc4));\n    assertU(commit());\n    String[] doc5 = {\"id\",\"6\", \"sort_i\",\"11\"};\n    assertU(adoc(doc5));\n    assertU(commit());\n\n\n    ModifiableSolrParams params = new ModifiableSolrParams();\n\n    params.add(\"qq\", \"*:*\");\n    params.add(\"q\", \"{!rank q=$qq}\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[1]/str[@name='id'][.='4']\",\n        \"//result/doc[2]/str[@name='id'][.='3']\",\n        \"//result/doc[3]/str[@name='id'][.='1']\",\n        \"//result/doc[4]/str[@name='id'][.='2']\",\n        \"//result/doc[5]/str[@name='id'][.='6']\",\n        \"//result/doc[6]/str[@name='id'][.='5']\"\n    );\n\n    params = new ModifiableSolrParams();\n    params.add(\"qq\", \"{!edismax bf=$bff}*:*\");\n    params.add(\"bff\", \"field(sort_i)\");\n    params.add(\"q\", \"{!rank q=$qq collector=1}\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n\n    params = new ModifiableSolrParams();\n    params.add(\"q\", \"*:*\");\n    params.add(\"sort\",\"sort_i asc\");\n\n    assertQ(req(params), \"*[count(//doc)=6]\",\n        \"//result/doc[6]/str[@name='id'][.='4']\",\n        \"//result/doc[5]/str[@name='id'][.='3']\",\n        \"//result/doc[4]/str[@name='id'][.='1']\",\n        \"//result/doc[3]/str[@name='id'][.='2']\",\n        \"//result/doc[2]/str[@name='id'][.='6']\",\n        \"//result/doc[1]/str[@name='id'][.='5']\"\n    );\n\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"6c70567cc1ae757045c80cb458b0b2a2ffcf0141":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"c218ef5584c663e78bdaf8391f826546f5bc73c1":["6c70567cc1ae757045c80cb458b0b2a2ffcf0141"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["c218ef5584c663e78bdaf8391f826546f5bc73c1"],"ccc69a67d5c846a04c7f71e28cb1914e3af895f3":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","6c70567cc1ae757045c80cb458b0b2a2ffcf0141"]},"commit2Childs":{"6c70567cc1ae757045c80cb458b0b2a2ffcf0141":["c218ef5584c663e78bdaf8391f826546f5bc73c1","ccc69a67d5c846a04c7f71e28cb1914e3af895f3"],"c218ef5584c663e78bdaf8391f826546f5bc73c1":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["6c70567cc1ae757045c80cb458b0b2a2ffcf0141","ccc69a67d5c846a04c7f71e28cb1914e3af895f3"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[],"ccc69a67d5c846a04c7f71e28cb1914e3af895f3":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817","ccc69a67d5c846a04c7f71e28cb1914e3af895f3"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}