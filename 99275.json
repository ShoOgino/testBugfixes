{"path":"solr/core/src/java/org/apache/solr/servlet/SolrRequestParsers#cleanupMultipartFiles(HttpServletRequest).mjava","commits":[{"id":"ac5c4637fb06d45efdeaf0f2d262b133ab2de181","date":1590122088,"type":0,"author":"David Smiley","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/SolrRequestParsers#cleanupMultipartFiles(HttpServletRequest).mjava","pathOld":"/dev/null","sourceNew":"  /** Clean up any tmp files created by MultiPartInputStream. */\n  static void cleanupMultipartFiles(HttpServletRequest request) {\n    // See Jetty MultiPartCleanerListener from which we drew inspiration\n    MultiParts multiParts = (MultiParts) request.getAttribute(Request.MULTIPARTS);\n    if (multiParts == null || multiParts.getContext() != request.getServletContext()) {\n      return;\n    }\n\n    log.debug(\"Deleting multipart files\");\n\n    Collection<Part> parts;\n    try {\n      parts = multiParts.getParts();\n    } catch (IOException e) {\n      log.warn(\"Errors deleting multipart tmp files\", e);\n      return;\n    }\n\n    for (Part part : parts) {\n      try {\n        part.delete();\n      } catch (IOException e) {\n        log.warn(\"Errors deleting multipart tmp files\", e);\n      }\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":["cff9a1253bcbc24e064decfe816f4c724029de8a"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"cff9a1253bcbc24e064decfe816f4c724029de8a","date":1600810938,"type":3,"author":"David Smiley","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/SolrRequestParsers#cleanupMultipartFiles(HttpServletRequest).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/SolrRequestParsers#cleanupMultipartFiles(HttpServletRequest).mjava","sourceNew":"  /** Clean up any files created by MultiPartInputStream. */\n  static void cleanupMultipartFiles(HttpServletRequest request) {\n    if (!MultipartRequestParser.isMultipart(request)) {\n      return;\n    }\n\n    log.debug(\"Deleting multipart files\");\n\n    Collection<Part> parts;\n    try {\n      parts = request.getParts();\n    } catch (Exception e) {\n      assert false : e.toString();\n      log.error(\"Couldn't get multipart parts in order to delete them\", e);\n      return;\n    }\n\n    for (Part part : parts) {\n      try {\n        part.delete();\n      } catch (IOException e) {\n        log.warn(\"Errors deleting multipart tmp files\", e);\n      }\n    }\n  }\n\n","sourceOld":"  /** Clean up any tmp files created by MultiPartInputStream. */\n  static void cleanupMultipartFiles(HttpServletRequest request) {\n    // See Jetty MultiPartCleanerListener from which we drew inspiration\n    MultiParts multiParts = (MultiParts) request.getAttribute(Request.MULTIPARTS);\n    if (multiParts == null || multiParts.getContext() != request.getServletContext()) {\n      return;\n    }\n\n    log.debug(\"Deleting multipart files\");\n\n    Collection<Part> parts;\n    try {\n      parts = multiParts.getParts();\n    } catch (IOException e) {\n      log.warn(\"Errors deleting multipart tmp files\", e);\n      return;\n    }\n\n    for (Part part : parts) {\n      try {\n        part.delete();\n      } catch (IOException e) {\n        log.warn(\"Errors deleting multipart tmp files\", e);\n      }\n    }\n  }\n\n","bugFix":["ac5c4637fb06d45efdeaf0f2d262b133ab2de181"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"ac5c4637fb06d45efdeaf0f2d262b133ab2de181":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cff9a1253bcbc24e064decfe816f4c724029de8a":["ac5c4637fb06d45efdeaf0f2d262b133ab2de181"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["cff9a1253bcbc24e064decfe816f4c724029de8a"]},"commit2Childs":{"ac5c4637fb06d45efdeaf0f2d262b133ab2de181":["cff9a1253bcbc24e064decfe816f4c724029de8a"],"cff9a1253bcbc24e064decfe816f4c724029de8a":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["ac5c4637fb06d45efdeaf0f2d262b133ab2de181"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}