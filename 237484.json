{"path":"solr/core/src/java/org/apache/solr/handler/loader/JsonLoader.SingleThreadedJsonLoader#handleSplitMode(String).mjava","commits":[{"id":"caf7f9acfdff984e59be68054cc1e0048b8ee030","date":1407766058,"type":0,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/loader/JsonLoader.SingleThreadedJsonLoader#handleSplitMode(String).mjava","pathOld":"/dev/null","sourceNew":"    private void handleSplitMode(String split) throws IOException {\n      String[] fields = req.getParams().getParams(\"f\");\n      req.getCore().getLatestSchema().getDefaultSearchFieldName();\n      final boolean echo = \"true\".equals( req.getParams().get(\"echo\"));\n      JsonRecordReader jsonRecordReader = JsonRecordReader.getInst(split, Arrays.asList(fields));\n      jsonRecordReader.streamRecords(parser,new JsonRecordReader.Handler() {\n        ArrayList docs =null;\n        @Override\n        public void handle(Map<String, Object> record, String path) {\n          if(echo){\n            if(docs ==null) {\n              docs = new ArrayList();\n              rsp.add(\"docs\",docs);\n            }\n            docs.add(record);\n          } else {\n            AddUpdateCommand cmd = new AddUpdateCommand(req);\n            cmd.commitWithin = commitWithin;\n            cmd.overwrite = overwrite;\n            cmd.solrDoc =  new SolrInputDocument();\n            for (Map.Entry<String, Object> entry : record.entrySet()) {\n              cmd.solrDoc.setField(entry.getKey(),entry.getValue());\n            }\n            try {\n              processor.processAdd(cmd);\n            } catch (IOException e) {\n              throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, \"error inserting doc\",e);\n            }\n          }\n        }\n      });\n    }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"c47b98f9e0b212b7e9199de318865d94147c6afa","date":1409789791,"type":5,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/loader/JsonLoader.SingleThreadedJsonLoader#handleSplitMode(String,String[]).mjava","pathOld":"solr/core/src/java/org/apache/solr/handler/loader/JsonLoader.SingleThreadedJsonLoader#handleSplitMode(String).mjava","sourceNew":"    private void handleSplitMode(String split, String[] fields) throws IOException {\n      if(split == null) split = \"/\";\n      if(fields == null || fields.length ==0) fields = new String[]{\"/*\"};\n      final boolean echo = \"true\".equals( req.getParams().get(\"echo\"));\n      JsonRecordReader jsonRecordReader = JsonRecordReader.getInst(split, Arrays.asList(fields));\n      jsonRecordReader.streamRecords(parser,new JsonRecordReader.Handler() {\n        ArrayList docs =null;\n        @Override\n        public void handle(Map<String, Object> record, String path) {\n          if(echo){\n            if(docs ==null) {\n              docs = new ArrayList();\n              rsp.add(\"docs\",docs);\n            }\n            docs.add(record);\n          } else {\n            AddUpdateCommand cmd = new AddUpdateCommand(req);\n            cmd.commitWithin = commitWithin;\n            cmd.overwrite = overwrite;\n            cmd.solrDoc =  new SolrInputDocument();\n            for (Map.Entry<String, Object> entry : record.entrySet()) {\n              cmd.solrDoc.setField(entry.getKey(),entry.getValue());\n            }\n            try {\n              processor.processAdd(cmd);\n            } catch (IOException e) {\n              throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, \"error inserting doc\",e);\n            }\n          }\n        }\n      });\n    }\n\n","sourceOld":"    private void handleSplitMode(String split) throws IOException {\n      String[] fields = req.getParams().getParams(\"f\");\n      req.getCore().getLatestSchema().getDefaultSearchFieldName();\n      final boolean echo = \"true\".equals( req.getParams().get(\"echo\"));\n      JsonRecordReader jsonRecordReader = JsonRecordReader.getInst(split, Arrays.asList(fields));\n      jsonRecordReader.streamRecords(parser,new JsonRecordReader.Handler() {\n        ArrayList docs =null;\n        @Override\n        public void handle(Map<String, Object> record, String path) {\n          if(echo){\n            if(docs ==null) {\n              docs = new ArrayList();\n              rsp.add(\"docs\",docs);\n            }\n            docs.add(record);\n          } else {\n            AddUpdateCommand cmd = new AddUpdateCommand(req);\n            cmd.commitWithin = commitWithin;\n            cmd.overwrite = overwrite;\n            cmd.solrDoc =  new SolrInputDocument();\n            for (Map.Entry<String, Object> entry : record.entrySet()) {\n              cmd.solrDoc.setField(entry.getKey(),entry.getValue());\n            }\n            try {\n              processor.processAdd(cmd);\n            } catch (IOException e) {\n              throw new SolrException(SolrException.ErrorCode.BAD_REQUEST, \"error inserting doc\",e);\n            }\n          }\n        }\n      });\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"c47b98f9e0b212b7e9199de318865d94147c6afa":["caf7f9acfdff984e59be68054cc1e0048b8ee030"],"caf7f9acfdff984e59be68054cc1e0048b8ee030":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["c47b98f9e0b212b7e9199de318865d94147c6afa"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["caf7f9acfdff984e59be68054cc1e0048b8ee030"],"c47b98f9e0b212b7e9199de318865d94147c6afa":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"caf7f9acfdff984e59be68054cc1e0048b8ee030":["c47b98f9e0b212b7e9199de318865d94147c6afa"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}