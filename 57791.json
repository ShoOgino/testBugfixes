{"path":"solr/core/src/test/org/apache/solr/cloud/TestTolerantUpdateProcessorRandomCloud#randomUnsetBit(Random,BitSet,int).mjava","commits":[{"id":"f57cf082c4d2ee975c6a2034fcf3c13f9514e6ef","date":1458928975,"type":0,"author":"Chris Hostetter","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/TestTolerantUpdateProcessorRandomCloud#randomUnsetBit(Random,BitSet,int).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Given a BitSet, returns a random bit that is currently false, or -1 if all bits are true.\n   * NOTE: this method is not fair.\n   */\n  public static final int randomUnsetBit(Random r, BitSet bits, final int max) {\n    // NOTE: don't forget, BitSet will grow automatically if not careful\n    if (bits.cardinality() == max+1) {\n      return -1;\n    }\n    final int candidate = TestUtil.nextInt(r, 0, max);\n    if (bits.get(candidate)) {\n      final int lo = bits.previousClearBit(candidate);\n      final int hi = bits.nextClearBit(candidate);\n      if (lo < 0 && max < hi) {\n        fail(\"how the hell did we not short circut out? card=\"+bits.cardinality()+\"/size=\"+bits.size());\n      } else if (lo < 0) {\n        return hi;\n      } else if (max < hi) {\n        return lo;\n      } // else...\n      return ((candidate - lo) < (hi - candidate)) ? lo : hi;\n    }\n    return candidate;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"f57cf082c4d2ee975c6a2034fcf3c13f9514e6ef":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["f57cf082c4d2ee975c6a2034fcf3c13f9514e6ef"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["f57cf082c4d2ee975c6a2034fcf3c13f9514e6ef"],"f57cf082c4d2ee975c6a2034fcf3c13f9514e6ef":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}