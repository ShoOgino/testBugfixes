{"path":"lucene/analysis/icu/src/test/org/apache/lucene/analysis/icu/segmentation/TestICUTokenizer#testICUConcurrency().mjava","commits":[{"id":"cb5fc2e0daad723d570c054e2acc8848013de44d","date":1400091811,"type":0,"author":"Robert Muir","isMerge":false,"pathNew":"lucene/analysis/icu/src/test/org/apache/lucene/analysis/icu/segmentation/TestICUTokenizer#testICUConcurrency().mjava","pathOld":"/dev/null","sourceNew":"  /** test for bugs like http://bugs.icu-project.org/trac/ticket/10767 */\n  public void testICUConcurrency() throws Exception {\n    int numThreads = 8;\n    final CountDownLatch startingGun = new CountDownLatch(1);\n    Thread threads[] = new Thread[numThreads];\n    for (int i = 0; i < threads.length; i++) {\n      threads[i] = new Thread() {\n        @Override\n        public void run() {\n          try {\n            startingGun.await();\n            long tokenCount = 0;\n            final String contents = \"英 เบียร์ ビール ເບຍ abc\";\n            for (int i = 0; i < 1000; i++) {\n              try (Tokenizer tokenizer = new ICUTokenizer()) {\n                tokenizer.setReader(new StringReader(contents));\n                tokenizer.reset();\n                while (tokenizer.incrementToken()) {\n                  tokenCount++;\n                }\n                tokenizer.end();\n              }\n            }\n            if (VERBOSE) {\n              System.out.println(tokenCount);\n            }\n          } catch (Exception e) {\n            throw new RuntimeException(e);\n          }\n        } \n      };\n      threads[i].start();\n    }\n    startingGun.countDown();\n    for (int i = 0; i < threads.length; i++) {\n      threads[i].join();\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"ccc69a67d5c846a04c7f71e28cb1914e3af895f3","date":1400252660,"type":0,"author":"Robert Muir","isMerge":true,"pathNew":"lucene/analysis/icu/src/test/org/apache/lucene/analysis/icu/segmentation/TestICUTokenizer#testICUConcurrency().mjava","pathOld":"/dev/null","sourceNew":"  /** test for bugs like http://bugs.icu-project.org/trac/ticket/10767 */\n  public void testICUConcurrency() throws Exception {\n    int numThreads = 8;\n    final CountDownLatch startingGun = new CountDownLatch(1);\n    Thread threads[] = new Thread[numThreads];\n    for (int i = 0; i < threads.length; i++) {\n      threads[i] = new Thread() {\n        @Override\n        public void run() {\n          try {\n            startingGun.await();\n            long tokenCount = 0;\n            final String contents = \"英 เบียร์ ビール ເບຍ abc\";\n            for (int i = 0; i < 1000; i++) {\n              try (Tokenizer tokenizer = new ICUTokenizer()) {\n                tokenizer.setReader(new StringReader(contents));\n                tokenizer.reset();\n                while (tokenizer.incrementToken()) {\n                  tokenCount++;\n                }\n                tokenizer.end();\n              }\n            }\n            if (VERBOSE) {\n              System.out.println(tokenCount);\n            }\n          } catch (Exception e) {\n            throw new RuntimeException(e);\n          }\n        } \n      };\n      threads[i].start();\n    }\n    startingGun.countDown();\n    for (int i = 0; i < threads.length; i++) {\n      threads[i].join();\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"cb5fc2e0daad723d570c054e2acc8848013de44d":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["cb5fc2e0daad723d570c054e2acc8848013de44d"],"ccc69a67d5c846a04c7f71e28cb1914e3af895f3":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","cb5fc2e0daad723d570c054e2acc8848013de44d"]},"commit2Childs":{"cb5fc2e0daad723d570c054e2acc8848013de44d":["cd5edd1f2b162a5cfa08efd17851a07373a96817","ccc69a67d5c846a04c7f71e28cb1914e3af895f3"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cb5fc2e0daad723d570c054e2acc8848013de44d","ccc69a67d5c846a04c7f71e28cb1914e3af895f3"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[],"ccc69a67d5c846a04c7f71e28cb1914e3af895f3":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817","ccc69a67d5c846a04c7f71e28cb1914e3af895f3"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}