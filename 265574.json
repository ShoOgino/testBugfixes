{"path":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","commits":[{"id":"a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0","date":1446511397,"type":1,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/FieldMutatingUpdateProcessorTest#testCloneField().mjava","sourceNew":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivilent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivilent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivilent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","sourceOld":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d = null;\n\n    // regardless of chain, all of these should be equivilent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-multi\", \n                                      \"clone-array\",\"clone-selector\" )) {\n\n      // simple clone\n      d = processAdd(chain,       \n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"), \n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"), \n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,       \n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"), \n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\", \n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivilent for any chain matching source1_s and source2_s\n    for (String chain : Arrays.asList(\"clone-multi\",\n                                      \"clone-array\",\"clone-selector\" )) {\n\n      // simple clone\n      d = processAdd(chain,       \n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"), \n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999), \n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,       \n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"), \n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\", \n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"0158ced21948b6626f733c1c42c1e18d94449789","date":1462994341,"type":3,"author":"Bartosz Krasi≈Ñski","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","sourceNew":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivalent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivalent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivalent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","sourceOld":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivilent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivilent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivilent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"d470c8182e92b264680e34081b75e70a9f2b3c89","date":1463985353,"type":3,"author":"Noble Paul","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","sourceNew":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivalent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivalent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivalent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","sourceOld":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivilent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivilent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivilent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"4cce5816ef15a48a0bc11e5d400497ee4301dd3b","date":1476991456,"type":3,"author":"Kevin Risden","isMerge":true,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","sourceNew":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivalent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivalent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivalent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","sourceOld":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivilent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivilent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivilent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"acd9883560fd89e6448b2b447302fe543040cd4f","date":1488478696,"type":3,"author":"Adrien Grand","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","pathOld":"solr/core/src/test/org/apache/solr/update/processor/CloneFieldUpdateProcessorFactoryTest#testCloneField().mjava","sourceNew":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivalent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n    }\n\n    // should be equivalent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivalent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n    }\n  }\n\n","sourceOld":"  public void testCloneField() throws Exception {\n\n    SolrInputDocument d;\n\n    // regardless of chain, all of these checks should be equivalent\n    for (String chain : Arrays.asList(\"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n      \n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n\n    // should be equivalent for any chain matching source1_s and source2_s (but not source0_s)\n    for (String chain : Arrays.asList(\"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\", \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source0_s\", \"NOT COPIED\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\"),\n                         f(\"source2_s\", \"xxx\", 999)));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"xxx\", 999),\n                   d.getFieldValues(\"source2_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\",\n                                 \"123456789\", \"\", 42, \"abcd\",\n                                 \"xxx\", 999),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n    \n    // any chain that copies source1_s to dest_s should be equivalent for these assertions\n    for (String chain : Arrays.asList(\"clone-simple-regex-syntax\",\n                                      \"clone-single\", \"clone-single-regex\",\n                                      \"clone-multi\", \"clone-multi-regex\",\n                                      \"clone-array\", \"clone-array-regex\", \n                                      \"clone-selector\", \"clone-selector-regex\")) {\n\n      // simple clone\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n\n      // append to existing values, preserve boost\n      d = processAdd(chain,\n                     doc(f(\"id\", \"1111\"),\n                         field(\"dest_s\", 2.3f, \"orig1\", \"orig2\"),\n                         f(\"source1_s\", \"123456789\", \"\", 42, \"abcd\")));\n      assertNotNull(chain, d);\n      assertEquals(chain,\n                   Arrays.asList(\"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"source1_s\"));\n      assertEquals(chain,\n                   Arrays.asList(\"orig1\", \"orig2\", \"123456789\", \"\", 42, \"abcd\"),\n                   d.getFieldValues(\"dest_s\"));\n      assertEquals(chain + \": dest boost changed\",\n                   2.3f, d.getField(\"dest_s\").getBoost(), 0.0f);\n    }\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"acd9883560fd89e6448b2b447302fe543040cd4f":["d470c8182e92b264680e34081b75e70a9f2b3c89"],"4cce5816ef15a48a0bc11e5d400497ee4301dd3b":["a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0","d470c8182e92b264680e34081b75e70a9f2b3c89"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["acd9883560fd89e6448b2b447302fe543040cd4f"],"d470c8182e92b264680e34081b75e70a9f2b3c89":["a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0","0158ced21948b6626f733c1c42c1e18d94449789"],"0158ced21948b6626f733c1c42c1e18d94449789":["a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0"]},"commit2Childs":{"a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0":["4cce5816ef15a48a0bc11e5d400497ee4301dd3b","d470c8182e92b264680e34081b75e70a9f2b3c89","0158ced21948b6626f733c1c42c1e18d94449789"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["a82f17a4aec53026c4ca0f2fa62ad8eaed017bb0"],"acd9883560fd89e6448b2b447302fe543040cd4f":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"4cce5816ef15a48a0bc11e5d400497ee4301dd3b":[],"d470c8182e92b264680e34081b75e70a9f2b3c89":["acd9883560fd89e6448b2b447302fe543040cd4f","4cce5816ef15a48a0bc11e5d400497ee4301dd3b"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[],"0158ced21948b6626f733c1c42c1e18d94449789":["d470c8182e92b264680e34081b75e70a9f2b3c89"]},"heads":["4cce5816ef15a48a0bc11e5d400497ee4301dd3b","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}