{"path":"solr/core/src/test/org/apache/solr/search/TestMinHashQParser#test().mjava","commits":[{"id":"4aa0efbef5fa4f0afe72d46d14d2f859cd953139","date":1540016882,"type":0,"author":"Tommaso Teofili","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/search/TestMinHashQParser#test().mjava","pathOld":"/dev/null","sourceNew":"  @Test\n  public void test() {\n\n    String[] parts = new String[]{\"one\", \"two\", \"three\", \"four\", \"five\", \"six\", \"seven\", \"eight\", \"nine\", \"ten\"};\n\n    for (int i = 0; i < parts.length; i++) {\n      StringBuilder builder = new StringBuilder();\n      for (int j = 0; j < parts.length - i; j++) {\n        if (builder.length() > 0) {\n          builder.append(\" \");\n        }\n        builder.append(parts[i + j]);\n        if (j >= 5 - 1) {\n          assertU(adoc(\"id\", \"doc_\" + i + \"_\" + j, \"min_hash_analysed\", builder.toString()));\n        }\n      }\n    }\n\n    assertU(commit());\n\n    String gQuery = \"*:*\";\n    SolrQueryRequest qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='21']\");\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}one two three four five\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='6']\");\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}two three four five six\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='10']\");\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}three four five six seven\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='12']\");\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}four five six seven eight\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='12']\");\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}five six seven eight nine\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='10']\");\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}six seven eight nine ten\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='6']\");\n\n\n    gQuery = \"{!minhash field=\\\"min_hash_analysed\\\"}one two three four five six seven eight nine ten\";\n    qr = createRequest(gQuery);\n    assertQ(qr, \"//*[@numFound='21']\",\n        \"//result/doc[1]/str[@name='id'][.='doc_0_9']\",\n        \"//result/doc[1]/float[@name='score'][.=512.0]\",\n        \"//result/doc[2]/str[@name='id'][.='doc_1_8']\",\n        \"//result/doc[2]/float[@name='score'][.=425.0]\",\n        \"//result/doc[3]/str[@name='id'][.='doc_0_8']\",\n        \"//result/doc[3]/float[@name='score'][.=341.0]\",\n        \"//result/doc[4]/str[@name='id'][.='doc_2_7']\",\n        \"//result/doc[4]/float[@name='score'][.=331.0]\",\n        \"//result/doc[5]/str[@name='id'][.='doc_0_7']\",\n        \"//result/doc[5]/float[@name='score'][.=305.0]\",\n        \"//result/doc[6]/str[@name='id'][.='doc_3_6']\",\n        \"//result/doc[6]/float[@name='score'][.=274.0]\",\n        \"//result/doc[7]/str[@name='id'][.='doc_1_7']\",\n        \"//result/doc[7]/float[@name='score'][.=254.0]\",\n        \"//result/doc[8]/str[@name='id'][.='doc_0_6']\",\n        \"//result/doc[8]/float[@name='score'][.=238.0]\",\n        \"//result/doc[9]/str[@name='id'][.='doc_1_6']\",\n        \"//result/doc[9]/float[@name='score'][.=218.0]\",\n        \"//result/doc[10]/str[@name='id'][.='doc_4_5']\",\n        \"//result/doc[10]/float[@name='score'][.=207.0]\",\n        \"//result/doc[11]/str[@name='id'][.='doc_0_5']\",\n        \"//result/doc[11]/float[@name='score'][.=181.0]\",\n\n        \"//result/doc[12]/str[@name='id'][.='doc_5_4']\",\n        \"//result/doc[12]/float[@name='score'][.=171.0]\",\n        \"//result/doc[13]/str[@name='id'][.='doc_2_6']\",\n        \"//result/doc[13]/float[@name='score'][.=160.0]\",\n        \"//result/doc[14]/str[@name='id'][.='doc_1_5']\",\n        \"//result/doc[14]/float[@name='score'][.=151.0]\",\n        \"//result/doc[15]/str[@name='id'][.='doc_2_5']\",\n        \"//result/doc[15]/float[@name='score'][.=124.0]\",\n        \"//result/doc[16]/str[@name='id'][.='doc_3_5']\",\n        \"//result/doc[16]/float[@name='score'][.=103.0]\",\n        \"//result/doc[17]/str[@name='id'][.='doc_1_4']\",\n        \"//result/doc[17]/float[@name='score'][.=94.0]\",\n        \"//result/doc[18]/str[@name='id'][.='doc_0_4']\",\n        \"//result/doc[18]/float[@name='score'][.=87.0]\",\n        \"//result/doc[19]/str[@name='id'][.='doc_3_4']\",\n        \"//result/doc[19]/float[@name='score'][.=67.0]\",\n        \"//result/doc[20]/str[@name='id'][.='doc_2_4']\",\n        \"//result/doc[20]/float[@name='score'][.=57.0]\"\n        //     \"//result/doc[21]/str[@name='id'][.='doc_0_8']\",\n        //     \"//result/doc[21]/float[@name='score'][.=341.0]\"\n    );\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"4aa0efbef5fa4f0afe72d46d14d2f859cd953139":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["4aa0efbef5fa4f0afe72d46d14d2f859cd953139"]},"commit2Childs":{"4aa0efbef5fa4f0afe72d46d14d2f859cd953139":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["4aa0efbef5fa4f0afe72d46d14d2f859cd953139"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}