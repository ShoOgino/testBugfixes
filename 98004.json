{"path":"solr/core/src/java/org/apache/solr/handler/export/ExportBuffers#run(Callable[Boolean]).mjava","commits":[{"id":"1d810b19e2ed4ec2e2b3d79844c7d5dea82794ee","date":1593704090,"type":0,"author":"Andrzej Bialecki","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/export/ExportBuffers#run(Callable[Boolean]).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Start processing and block until complete or Exception is thrown.\n   *\n   * @param writer writer that exchanges and processes buffers received from a producer.\n   * @throws IOException on errors\n   */\n  public void run(Callable<Boolean> writer) throws IOException {\n    service = ExecutorUtil.newMDCAwareFixedThreadPool(1, new SolrNamedThreadFactory(\"ExportBuffers\"));\n    try {\n      CompletableFuture.runAsync(filler, service);\n      writer.call();\n\n      // alternatively we could run the writer in a separate thread:\n//        CompletableFuture<Void> allDone = CompletableFuture.allOf(\n//            CompletableFuture.runAsync(filler, service),\n//            CompletableFuture.runAsync(() -> {\n//              try {\n//                writer.call();\n//              } catch (Exception e) {\n//                log.error(\"writer\", e);\n//                shutdownNow();\n//              }\n//            }, service)\n//        );\n//        allDone.join();\n      log.debug(\"-- finished.\");\n    } catch (Exception e) {\n      log.error(\"Exception running filler / writer\", e);\n      error(e);\n      //\n    } finally {\n      log.debug(\"--- all done, shutting down buffers\");\n      shutdownNow();\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"1d810b19e2ed4ec2e2b3d79844c7d5dea82794ee":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["1d810b19e2ed4ec2e2b3d79844c7d5dea82794ee"]},"commit2Childs":{"1d810b19e2ed4ec2e2b3d79844c7d5dea82794ee":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["1d810b19e2ed4ec2e2b3d79844c7d5dea82794ee"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}