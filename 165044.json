{"path":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","commits":[{"id":"dd6ddd3da533988676f6ec21e7e4651a2b2e8345","date":1330043299,"type":1,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (data != null)\r\n        if (stat.getDataLength() != 0) {\r\n          String str;\r\n          try {\r\n            str = new String(data, \"UTF-8\");\r\n            str = str.replaceAll(\"\\\\\\\"\", \"\\\\\\\\\\\"\");\r\n\r\n            //writeKeyValue(json, \"content\", str, false );\r\n          } catch (UnsupportedEncodingException e) {\r\n            // not UTF8\r\n            StringBuilder sb = new StringBuilder(\"BIN(\");\r\n            sb.append(\"len=\" + data.length);\r\n            sb.append(\"hex=\");\r\n            int limit = Math.min(data.length, maxData / 2);\r\n            for (int i = 0; i < limit; i++) {\r\n              byte b = data[i];\r\n              sb.append(StrUtils.HEX_DIGITS[(b >> 4) & 0xf]);\r\n              sb.append(StrUtils.HEX_DIGITS[b & 0xf]);\r\n            }\r\n            if (limit != data.length) {\r\n              sb.append(\"...\");\r\n            }\r\n            sb.append(\")\");\r\n            str = sb.toString();\r\n            //?? writeKeyValue(json, \"content\", str, false );\r\n          }\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","sourceOld":"    void printTree(String path) throws IOException\r\n    {\r\n      String label = path;\r\n      if (!fullpath)\r\n      {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n  \r\n      //url(label, path, true);\r\n      out.println(\"{\");\r\n      out.println(\"\\\"data\\\" : \\\"\" + label + \"\\\"\");\r\n  \r\n      Stat stat = new Stat();\r\n      try\r\n      {\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n  \r\n        if( stat.getEphemeralOwner() != 0 )\r\n        {\r\n          out.println(\", \\\"ephemeral\\\" : true\");\r\n          out.println(\", \\\"version\\\" : \\\"\" + stat.getVersion() + \"\\\"\");\r\n        }\r\n        \r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n  \r\n        //if (data != null)\r\n        if( stat.getDataLength() != 0 )\r\n        {\r\n          String str;\r\n          try\r\n          {\r\n            str = new String(data, \"UTF-8\");\r\n            str = str.replaceAll(\"\\\\\\\"\", \"\\\\\\\\\\\"\");\r\n  \r\n            out.print(\", \\\"content\\\" : \\\"\");\r\n            //xmlescape(compress(str));\r\n            out.print(compress(str));\r\n            out.println(\"\\\"\");\r\n          }\r\n          catch (UnsupportedEncodingException e)\r\n          {\r\n            // not UTF8\r\n            StringBuilder sb = new StringBuilder(\"BIN(\");\r\n            sb.append(\"len=\" + data.length);\r\n            sb.append(\"hex=\");\r\n            int limit = Math.min(data.length, maxData / 2);\r\n            for (int i = 0; i < limit; i++)\r\n            {\r\n              byte b = data[i];\r\n              sb.append(StrUtils.HEX_DIGITS[(b >> 4) & 0xf]);\r\n              sb.append(StrUtils.HEX_DIGITS[b & 0xf]);\r\n            }\r\n            if (limit != data.length)\r\n            {\r\n              sb.append(\"...\");\r\n            }\r\n            sb.append(\")\");\r\n            str = sb.toString();\r\n            //out.print(str);\r\n          }\r\n        }\r\n      }\r\n      catch (IllegalArgumentException e)\r\n      {\r\n        // path doesn't exist (must have been removed)\r\n        out.println(\"(path gone)\");\r\n      }\r\n      catch (KeeperException e)\r\n      {\r\n        e.printStackTrace();\r\n      }\r\n      catch (InterruptedException e)\r\n      {\r\n        e.printStackTrace();\r\n      }\r\n  \r\n      if( stat.getNumChildren() > 0 )\r\n      {\r\n        out.print(\", \\\"children\\\" : [\");\r\n  \r\n        List<String> children = null;\r\n        try\r\n        {\r\n          children = zkClient.getChildren(path, null, true);\r\n        }\r\n        catch (KeeperException e)\r\n        {\r\n          exception(e);\r\n          return;\r\n        }\r\n        catch (InterruptedException e)\r\n        {\r\n          exception(e);\r\n        }\r\n        catch (IllegalArgumentException e)\r\n        {\r\n          // path doesn't exist (must have been removed)\r\n          out.println(\"(children gone)\");\r\n        }\r\n  \r\n        Integer i = 0;\r\n        for( String child : children )\r\n        {\r\n          if( 0 != i )\r\n          {\r\n            out.print(\", \");\r\n          }\r\n  \r\n          String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n          printTree( childPath );\r\n  \r\n          i++;\r\n        }\r\n  \r\n        out.println(\"]\");\r\n      }\r\n  \r\n      out.println(\"}\");\r\n    }\r\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"9946ea6d8ddf0b8c20b2ca6a816b7168b023a6ab","date":1331075828,"type":0,"author":"Ryan McKinley","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"/dev/null","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (data != null)\r\n        if (stat.getDataLength() != 0) {\r\n          String str;\r\n          try {\r\n            str = new String(data, \"UTF-8\");\r\n            str = str.replaceAll(\"\\\\\\\"\", \"\\\\\\\\\\\"\");\r\n\r\n            //writeKeyValue(json, \"content\", str, false );\r\n          } catch (UnsupportedEncodingException e) {\r\n            // not UTF8\r\n            StringBuilder sb = new StringBuilder(\"BIN(\");\r\n            sb.append(\"len=\" + data.length);\r\n            sb.append(\"hex=\");\r\n            int limit = Math.min(data.length, maxData / 2);\r\n            for (int i = 0; i < limit; i++) {\r\n              byte b = data[i];\r\n              sb.append(StrUtils.HEX_DIGITS[(b >> 4) & 0xf]);\r\n              sb.append(StrUtils.HEX_DIGITS[b & 0xf]);\r\n            }\r\n            if (limit != data.length) {\r\n              sb.append(\"...\");\r\n            }\r\n            sb.append(\")\");\r\n            str = sb.toString();\r\n            //?? writeKeyValue(json, \"content\", str, false );\r\n          }\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"dccd36091d3547bf3a42b32aa932bb6082269048","date":1331137820,"type":3,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        // Trickily, the call to zkClient.getData fills in the stat variable\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        if (dump) {\r\n          json.writeValueSeparator();\r\n          printZnode(json, path);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (stat.getDataLength() != 0)\r\n        if (data != null) {\r\n          String str = new BytesRef(data).utf8ToString();\r\n          //?? writeKeyValue(json, \"content\", str, false );\r\n          // Does nothing now, but on the assumption this will be used later we'll leave it in. If it comes out\r\n          // the catches below need to be restructured.\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (data != null)\r\n        if (stat.getDataLength() != 0) {\r\n          String str;\r\n          try {\r\n            str = new String(data, \"UTF-8\");\r\n            str = str.replaceAll(\"\\\\\\\"\", \"\\\\\\\\\\\"\");\r\n\r\n            //writeKeyValue(json, \"content\", str, false );\r\n          } catch (UnsupportedEncodingException e) {\r\n            // not UTF8\r\n            StringBuilder sb = new StringBuilder(\"BIN(\");\r\n            sb.append(\"len=\" + data.length);\r\n            sb.append(\"hex=\");\r\n            int limit = Math.min(data.length, maxData / 2);\r\n            for (int i = 0; i < limit; i++) {\r\n              byte b = data[i];\r\n              sb.append(StrUtils.HEX_DIGITS[(b >> 4) & 0xf]);\r\n              sb.append(StrUtils.HEX_DIGITS[b & 0xf]);\r\n            }\r\n            if (limit != data.length) {\r\n              sb.append(\"...\");\r\n            }\r\n            sb.append(\")\");\r\n            str = sb.toString();\r\n            //?? writeKeyValue(json, \"content\", str, false );\r\n          }\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"38e3b736c7ca086d61b7dbb841c905ee115490da","date":1331657018,"type":3,"author":"Ryan McKinley","isMerge":true,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        // Trickily, the call to zkClient.getData fills in the stat variable\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        if (dump) {\r\n          json.writeValueSeparator();\r\n          printZnode(json, path);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (stat.getDataLength() != 0)\r\n        if (data != null) {\r\n          String str = new BytesRef(data).utf8ToString();\r\n          //?? writeKeyValue(json, \"content\", str, false );\r\n          // Does nothing now, but on the assumption this will be used later we'll leave it in. If it comes out\r\n          // the catches below need to be restructured.\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (data != null)\r\n        if (stat.getDataLength() != 0) {\r\n          String str;\r\n          try {\r\n            str = new String(data, \"UTF-8\");\r\n            str = str.replaceAll(\"\\\\\\\"\", \"\\\\\\\\\\\"\");\r\n\r\n            //writeKeyValue(json, \"content\", str, false );\r\n          } catch (UnsupportedEncodingException e) {\r\n            // not UTF8\r\n            StringBuilder sb = new StringBuilder(\"BIN(\");\r\n            sb.append(\"len=\" + data.length);\r\n            sb.append(\"hex=\");\r\n            int limit = Math.min(data.length, maxData / 2);\r\n            for (int i = 0; i < limit; i++) {\r\n              byte b = data[i];\r\n              sb.append(StrUtils.HEX_DIGITS[(b >> 4) & 0xf]);\r\n              sb.append(StrUtils.HEX_DIGITS[b & 0xf]);\r\n            }\r\n            if (limit != data.length) {\r\n              sb.append(\"...\");\r\n            }\r\n            sb.append(\")\");\r\n            str = sb.toString();\r\n            //?? writeKeyValue(json, \"content\", str, false );\r\n          }\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"5a002afd8b1e0d1bbf0debb2ff740b5e77ed8b23","date":1332766738,"type":3,"author":"Robert Muir","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n        /*\n        if (stat.getNumChildren() != 0)\n        {\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\n        }\n        */\n\n        //if (stat.getDataLength() != 0)\n        if (data != null) {\n          String str = new BytesRef(data).utf8ToString();\n          //?? writeKeyValue(json, \"content\", str, false );\n          // Does nothing now, but on the assumption this will be used later we'll leave it in. If it comes out\n          // the catches below need to be restructured.\n        }\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\r\n      String label = path;\r\n      if (!fullpath) {\r\n        int idx = path.lastIndexOf('/');\r\n        label = idx > 0 ? path.substring(idx + 1) : path;\r\n      }\r\n      json.startObject();\r\n      //writeKeyValue(json, \"data\", label, true );\r\n      json.writeString(\"data\");\r\n      json.writeNameSeparator();\r\n\r\n      json.startObject();\r\n      writeKeyValue(json, \"title\", label, true);\r\n      json.writeValueSeparator();\r\n      json.writeString(\"attr\");\r\n      json.writeNameSeparator();\r\n      json.startObject();\r\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\r\n      json.endObject();\r\n      json.endObject();\r\n\r\n      Stat stat = new Stat();\r\n      try {\r\n        // Trickily, the call to zkClient.getData fills in the stat variable\r\n        byte[] data = zkClient.getData(path, null, stat, true);\r\n\r\n        if (stat.getEphemeralOwner() != 0) {\r\n          writeKeyValue(json, \"ephemeral\", true, false);\r\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\r\n        }\r\n\r\n        if (dump) {\r\n          json.writeValueSeparator();\r\n          printZnode(json, path);\r\n        }\r\n\r\n        /*\r\n        if (stat.getNumChildren() != 0)\r\n        {\r\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\r\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\r\n        }\r\n        */\r\n\r\n        //if (stat.getDataLength() != 0)\r\n        if (data != null) {\r\n          String str = new BytesRef(data).utf8ToString();\r\n          //?? writeKeyValue(json, \"content\", str, false );\r\n          // Does nothing now, but on the assumption this will be used later we'll leave it in. If it comes out\r\n          // the catches below need to be restructured.\r\n        }\r\n      } catch (IllegalArgumentException e) {\r\n        // path doesn't exist (must have been removed)\r\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\r\n      } catch (KeeperException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"Keeper Exception\", e);\r\n      } catch (InterruptedException e) {\r\n        writeKeyValue(json, \"warning\", e.toString(), false);\r\n        log.warn(\"InterruptedException\", e);\r\n      }\r\n\r\n      if (stat.getNumChildren() > 0) {\r\n        json.writeValueSeparator();\r\n        if (indent) {\r\n          json.indent();\r\n        }\r\n        json.writeString(\"children\");\r\n        json.writeNameSeparator();\r\n        json.startArray();\r\n\r\n        try {\r\n          List<String> children = zkClient.getChildren(path, null, true);\r\n          java.util.Collections.sort(children);\r\n\r\n          boolean first = true;\r\n          for (String child : children) {\r\n            if (!first) {\r\n              json.writeValueSeparator();\r\n            }\r\n\r\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\r\n            if (!printTree(json, childPath)) {\r\n              return false;\r\n            }\r\n            first = false;\r\n          }\r\n        } catch (KeeperException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (InterruptedException e) {\r\n          writeError(500, e.toString());\r\n          return false;\r\n        } catch (IllegalArgumentException e) {\r\n          // path doesn't exist (must have been removed)\r\n          json.writeString(\"(children gone)\");\r\n        }\r\n\r\n        json.endArray();\r\n      }\r\n\r\n      json.endObject();\r\n      return true;\r\n    }\r\n\n","bugFix":null,"bugIntro":["49603a0e95f2e91a45eaedf0db2d6b734b41611d"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"49603a0e95f2e91a45eaedf0db2d6b734b41611d","date":1378229389,"type":3,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n        /*\n        if (stat.getNumChildren() != 0)\n        {\n          writeKeyValue(json, \"children_count\",  stat.getNumChildren(), false );\n          out.println(\", \\\"children_count\\\" : \\\"\" + stat.getNumChildren() + \"\\\"\");\n        }\n        */\n\n        //if (stat.getDataLength() != 0)\n        if (data != null) {\n          String str = new BytesRef(data).utf8ToString();\n          //?? writeKeyValue(json, \"content\", str, false );\n          // Does nothing now, but on the assumption this will be used later we'll leave it in. If it comes out\n          // the catches below need to be restructured.\n        }\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","bugFix":["5a002afd8b1e0d1bbf0debb2ff740b5e77ed8b23"],"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"0622fbd990643ae4cacb693db6a0c82cf8916ae2","date":1397637446,"type":3,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path, false);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"a5a233896b7f16ac9b4ed601ef8207d98f1f0500","date":1398857046,"type":3,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path, false);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null},{"id":"80ebe5b1d946f7c2ed9c46206b0c7254dc21206a","date":1443442239,"type":5,"author":"Noble Paul","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/handler/admin/ZookeeperInfoHandler.ZKPrinter#printTree(JSONWriter,String).mjava","pathOld":"solr/core/src/java/org/apache/solr/servlet/ZookeeperInfoServlet.ZKPrinter#printTree(JSONWriter,String).mjava","sourceNew":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"admin/zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","sourceOld":"    boolean printTree(JSONWriter json, String path) throws IOException {\n      String label = path;\n      if (!fullpath) {\n        int idx = path.lastIndexOf('/');\n        label = idx > 0 ? path.substring(idx + 1) : path;\n      }\n      json.startObject();\n      //writeKeyValue(json, \"data\", label, true );\n      json.writeString(\"data\");\n      json.writeNameSeparator();\n\n      json.startObject();\n      writeKeyValue(json, \"title\", label, true);\n      json.writeValueSeparator();\n      json.writeString(\"attr\");\n      json.writeNameSeparator();\n      json.startObject();\n      writeKeyValue(json, \"href\", \"zookeeper?detail=true&path=\" + URLEncoder.encode(path, \"UTF-8\"), true);\n      json.endObject();\n      json.endObject();\n\n      Stat stat = new Stat();\n      try {\n        // Trickily, the call to zkClient.getData fills in the stat variable\n        byte[] data = zkClient.getData(path, null, stat, true);\n\n        if (stat.getEphemeralOwner() != 0) {\n          writeKeyValue(json, \"ephemeral\", true, false);\n          writeKeyValue(json, \"version\", stat.getVersion(), false);\n        }\n\n        if (dump) {\n          json.writeValueSeparator();\n          printZnode(json, path);\n        }\n\n      } catch (IllegalArgumentException e) {\n        // path doesn't exist (must have been removed)\n        writeKeyValue(json, \"warning\", \"(path gone)\", false);\n      } catch (KeeperException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"Keeper Exception\", e);\n      } catch (InterruptedException e) {\n        writeKeyValue(json, \"warning\", e.toString(), false);\n        log.warn(\"InterruptedException\", e);\n      }\n\n      if (stat.getNumChildren() > 0) {\n        json.writeValueSeparator();\n        if (indent) {\n          json.indent();\n        }\n        json.writeString(\"children\");\n        json.writeNameSeparator();\n        json.startArray();\n\n        try {\n          List<String> children = zkClient.getChildren(path, null, true);\n          java.util.Collections.sort(children);\n\n          boolean first = true;\n          for (String child : children) {\n            if (!first) {\n              json.writeValueSeparator();\n            }\n\n            String childPath = path + (path.endsWith(\"/\") ? \"\" : \"/\") + child;\n            if (!printTree(json, childPath)) {\n              return false;\n            }\n            first = false;\n          }\n        } catch (KeeperException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (InterruptedException e) {\n          writeError(500, e.toString());\n          return false;\n        } catch (IllegalArgumentException e) {\n          // path doesn't exist (must have been removed)\n          json.writeString(\"(children gone)\");\n        }\n\n        json.endArray();\n      }\n\n      json.endObject();\n      return true;\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"38e3b736c7ca086d61b7dbb841c905ee115490da":["9946ea6d8ddf0b8c20b2ca6a816b7168b023a6ab","dccd36091d3547bf3a42b32aa932bb6082269048"],"5a002afd8b1e0d1bbf0debb2ff740b5e77ed8b23":["dccd36091d3547bf3a42b32aa932bb6082269048"],"9946ea6d8ddf0b8c20b2ca6a816b7168b023a6ab":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","dd6ddd3da533988676f6ec21e7e4651a2b2e8345"],"80ebe5b1d946f7c2ed9c46206b0c7254dc21206a":["a5a233896b7f16ac9b4ed601ef8207d98f1f0500"],"dd6ddd3da533988676f6ec21e7e4651a2b2e8345":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"a5a233896b7f16ac9b4ed601ef8207d98f1f0500":["0622fbd990643ae4cacb693db6a0c82cf8916ae2"],"dccd36091d3547bf3a42b32aa932bb6082269048":["dd6ddd3da533988676f6ec21e7e4651a2b2e8345"],"0622fbd990643ae4cacb693db6a0c82cf8916ae2":["49603a0e95f2e91a45eaedf0db2d6b734b41611d"],"49603a0e95f2e91a45eaedf0db2d6b734b41611d":["5a002afd8b1e0d1bbf0debb2ff740b5e77ed8b23"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["80ebe5b1d946f7c2ed9c46206b0c7254dc21206a"]},"commit2Childs":{"38e3b736c7ca086d61b7dbb841c905ee115490da":[],"9946ea6d8ddf0b8c20b2ca6a816b7168b023a6ab":["38e3b736c7ca086d61b7dbb841c905ee115490da"],"5a002afd8b1e0d1bbf0debb2ff740b5e77ed8b23":["49603a0e95f2e91a45eaedf0db2d6b734b41611d"],"80ebe5b1d946f7c2ed9c46206b0c7254dc21206a":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"dd6ddd3da533988676f6ec21e7e4651a2b2e8345":["9946ea6d8ddf0b8c20b2ca6a816b7168b023a6ab","dccd36091d3547bf3a42b32aa932bb6082269048"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["9946ea6d8ddf0b8c20b2ca6a816b7168b023a6ab","dd6ddd3da533988676f6ec21e7e4651a2b2e8345"],"a5a233896b7f16ac9b4ed601ef8207d98f1f0500":["80ebe5b1d946f7c2ed9c46206b0c7254dc21206a"],"dccd36091d3547bf3a42b32aa932bb6082269048":["38e3b736c7ca086d61b7dbb841c905ee115490da","5a002afd8b1e0d1bbf0debb2ff740b5e77ed8b23"],"0622fbd990643ae4cacb693db6a0c82cf8916ae2":["a5a233896b7f16ac9b4ed601ef8207d98f1f0500"],"49603a0e95f2e91a45eaedf0db2d6b734b41611d":["0622fbd990643ae4cacb693db6a0c82cf8916ae2"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["38e3b736c7ca086d61b7dbb841c905ee115490da","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}