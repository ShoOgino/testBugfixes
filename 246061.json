{"path":"lucene/suggest/src/java/org/apache/lucene/search/spell/JaroWinklerDistance#matches(String,String).mjava","commits":[{"id":"b89678825b68eccaf09e6ab71675fc0b0af1e099","date":1334669779,"type":1,"author":"Robert Muir","isMerge":false,"pathNew":"lucene/suggest/src/java/org/apache/lucene/search/spell/JaroWinklerDistance#matches(String,String).mjava","pathOld":"modules/suggest/src/java/org/apache/lucene/search/spell/JaroWinklerDistance#matches(String,String).mjava","sourceNew":"  private int[] matches(String s1, String s2) {\n    String max, min;\n    if (s1.length() > s2.length()) {\n      max = s1;\n      min = s2;\n    } else {\n      max = s2;\n      min = s1;\n    }\n    int range = Math.max(max.length() / 2 - 1, 0);\n    int[] matchIndexes = new int[min.length()];\n    Arrays.fill(matchIndexes, -1);\n    boolean[] matchFlags = new boolean[max.length()];\n    int matches = 0;\n    for (int mi = 0; mi < min.length(); mi++) {\n      char c1 = min.charAt(mi);\n      for (int xi = Math.max(mi - range, 0), xn = Math.min(mi + range + 1, max\n          .length()); xi < xn; xi++) {\n        if (!matchFlags[xi] && c1 == max.charAt(xi)) {\n          matchIndexes[mi] = xi;\n          matchFlags[xi] = true;\n          matches++;\n          break;\n        }\n      }\n    }\n    char[] ms1 = new char[matches];\n    char[] ms2 = new char[matches];\n    for (int i = 0, si = 0; i < min.length(); i++) {\n      if (matchIndexes[i] != -1) {\n        ms1[si] = min.charAt(i);\n        si++;\n      }\n    }\n    for (int i = 0, si = 0; i < max.length(); i++) {\n      if (matchFlags[i]) {\n        ms2[si] = max.charAt(i);\n        si++;\n      }\n    }\n    int transpositions = 0;\n    for (int mi = 0; mi < ms1.length; mi++) {\n      if (ms1[mi] != ms2[mi]) {\n        transpositions++;\n      }\n    }\n    int prefix = 0;\n    for (int mi = 0; mi < min.length(); mi++) {\n      if (s1.charAt(mi) == s2.charAt(mi)) {\n        prefix++;\n      } else {\n        break;\n      }\n    }\n    return new int[] { matches, transpositions / 2, prefix, max.length() };\n  }\n\n","sourceOld":"  private int[] matches(String s1, String s2) {\n    String max, min;\n    if (s1.length() > s2.length()) {\n      max = s1;\n      min = s2;\n    } else {\n      max = s2;\n      min = s1;\n    }\n    int range = Math.max(max.length() / 2 - 1, 0);\n    int[] matchIndexes = new int[min.length()];\n    Arrays.fill(matchIndexes, -1);\n    boolean[] matchFlags = new boolean[max.length()];\n    int matches = 0;\n    for (int mi = 0; mi < min.length(); mi++) {\n      char c1 = min.charAt(mi);\n      for (int xi = Math.max(mi - range, 0), xn = Math.min(mi + range + 1, max\n          .length()); xi < xn; xi++) {\n        if (!matchFlags[xi] && c1 == max.charAt(xi)) {\n          matchIndexes[mi] = xi;\n          matchFlags[xi] = true;\n          matches++;\n          break;\n        }\n      }\n    }\n    char[] ms1 = new char[matches];\n    char[] ms2 = new char[matches];\n    for (int i = 0, si = 0; i < min.length(); i++) {\n      if (matchIndexes[i] != -1) {\n        ms1[si] = min.charAt(i);\n        si++;\n      }\n    }\n    for (int i = 0, si = 0; i < max.length(); i++) {\n      if (matchFlags[i]) {\n        ms2[si] = max.charAt(i);\n        si++;\n      }\n    }\n    int transpositions = 0;\n    for (int mi = 0; mi < ms1.length; mi++) {\n      if (ms1[mi] != ms2[mi]) {\n        transpositions++;\n      }\n    }\n    int prefix = 0;\n    for (int mi = 0; mi < min.length(); mi++) {\n      if (s1.charAt(mi) == s2.charAt(mi)) {\n        prefix++;\n      } else {\n        break;\n      }\n    }\n    return new int[] { matches, transpositions / 2, prefix, max.length() };\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"b89678825b68eccaf09e6ab71675fc0b0af1e099":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["b89678825b68eccaf09e6ab71675fc0b0af1e099"]},"commit2Childs":{"b89678825b68eccaf09e6ab71675fc0b0af1e099":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["b89678825b68eccaf09e6ab71675fc0b0af1e099"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}