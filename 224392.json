{"path":"src/webapp/src/org/apache/solr/servlet/cache/HttpCacheHeaderUtil#doCacheHeaderValidation(SolrQueryRequest,HttpServletRequest,HttpServletResponse).mjava","commits":[{"id":"b920ba0b6285c3aaa7a64d1677f5b4ee58b0779d","date":1203633859,"type":0,"author":"Chris M. Hostetter","isMerge":false,"pathNew":"src/webapp/src/org/apache/solr/servlet/cache/HttpCacheHeaderUtil#doCacheHeaderValidation(SolrQueryRequest,HttpServletRequest,HttpServletResponse).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Sets HTTP Response cache validator headers appropriately and\n   * validates the HTTP Request against these using any conditional\n   * request headers.\n   *\n   * If the request contains conditional headers, and those headers\n   * indicate a match with the current known state of the system, this\n   * method will return \"true\" indicating that a 304 Status code can be\n   * returned, and no further processing is needed.\n   *\n   * \n   * @return true if the request contains conditional headers, and those\n   *         headers indicate a match with the current known state of the\n   *         system -- indicating that a 304 Status code can be returned to\n   *         the client, and no further request processing is needed.  \n   */\n  public static boolean doCacheHeaderValidation(final SolrQueryRequest solrReq,\n                                                final HttpServletRequest req,\n                                                final HttpServletResponse resp)\n    throws IOException {\n\n    final Method reqMethod=Method.getMethod(req.getMethod());\n    \n    final long lastMod = HttpCacheHeaderUtil.calcLastModified(solrReq);\n    final String etag = HttpCacheHeaderUtil.calcEtag(solrReq);\n    \n    resp.setDateHeader(\"Last-Modified\", lastMod);\n    resp.setHeader(\"ETag\", etag);\n\n    if (checkETagValidators(req, resp, reqMethod, etag)) {\n      return true;\n    }\n\n    if (checkLastModValidators(req, resp, lastMod)) {\n      return true;\n    }\n\n    return false;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":["4d3e8520fd031bab31fd0e4d480e55958bc45efe","4d3e8520fd031bab31fd0e4d480e55958bc45efe","4d3e8520fd031bab31fd0e4d480e55958bc45efe"],"isBuggy":true,"nexts":[],"revCommit":null},{"id":"5ff676ea3919c34f30df120b9fa469cd439203ec","date":1211576148,"type":5,"author":"Otis Gospodnetic","isMerge":false,"pathNew":"src/webapp/src/org/apache/solr/servlet/cache/HttpCacheHeaderUtil#doCacheHeaderValidation(SolrQueryRequest,HttpServletRequest,Method,HttpServletResponse).mjava","pathOld":"src/webapp/src/org/apache/solr/servlet/cache/HttpCacheHeaderUtil#doCacheHeaderValidation(SolrQueryRequest,HttpServletRequest,HttpServletResponse).mjava","sourceNew":"  /**\n   * Sets HTTP Response cache validator headers appropriately and\n   * validates the HTTP Request against these using any conditional\n   * request headers.\n   *\n   * If the request contains conditional headers, and those headers\n   * indicate a match with the current known state of the system, this\n   * method will return \"true\" indicating that a 304 Status code can be\n   * returned, and no further processing is needed.\n   *\n   * \n   * @return true if the request contains conditional headers, and those\n   *         headers indicate a match with the current known state of the\n   *         system -- indicating that a 304 Status code can be returned to\n   *         the client, and no further request processing is needed.  \n   */\n  public static boolean doCacheHeaderValidation(final SolrQueryRequest solrReq,\n                                                final HttpServletRequest req,\n                                                final Method reqMethod,\n                                                final HttpServletResponse resp)\n    throws IOException {\n    \n    if (Method.POST==reqMethod || Method.OTHER==reqMethod) {\n      return false;\n    }\n    \n    final long lastMod = HttpCacheHeaderUtil.calcLastModified(solrReq);\n    final String etag = HttpCacheHeaderUtil.calcEtag(solrReq);\n    \n    resp.setDateHeader(\"Last-Modified\", lastMod);\n    resp.setHeader(\"ETag\", etag);\n\n    if (checkETagValidators(req, resp, reqMethod, etag)) {\n      return true;\n    }\n\n    if (checkLastModValidators(req, resp, lastMod)) {\n      return true;\n    }\n\n    return false;\n  }\n\n","sourceOld":"  /**\n   * Sets HTTP Response cache validator headers appropriately and\n   * validates the HTTP Request against these using any conditional\n   * request headers.\n   *\n   * If the request contains conditional headers, and those headers\n   * indicate a match with the current known state of the system, this\n   * method will return \"true\" indicating that a 304 Status code can be\n   * returned, and no further processing is needed.\n   *\n   * \n   * @return true if the request contains conditional headers, and those\n   *         headers indicate a match with the current known state of the\n   *         system -- indicating that a 304 Status code can be returned to\n   *         the client, and no further request processing is needed.  \n   */\n  public static boolean doCacheHeaderValidation(final SolrQueryRequest solrReq,\n                                                final HttpServletRequest req,\n                                                final HttpServletResponse resp)\n    throws IOException {\n\n    final Method reqMethod=Method.getMethod(req.getMethod());\n    \n    final long lastMod = HttpCacheHeaderUtil.calcLastModified(solrReq);\n    final String etag = HttpCacheHeaderUtil.calcEtag(solrReq);\n    \n    resp.setDateHeader(\"Last-Modified\", lastMod);\n    resp.setHeader(\"ETag\", etag);\n\n    if (checkETagValidators(req, resp, reqMethod, etag)) {\n      return true;\n    }\n\n    if (checkLastModValidators(req, resp, lastMod)) {\n      return true;\n    }\n\n    return false;\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":true,"nexts":[],"revCommit":null}],"commit2Parents":{"5ff676ea3919c34f30df120b9fa469cd439203ec":["b920ba0b6285c3aaa7a64d1677f5b4ee58b0779d"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":[],"b920ba0b6285c3aaa7a64d1677f5b4ee58b0779d":["3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"]},"commit2Childs":{"5ff676ea3919c34f30df120b9fa469cd439203ec":[],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b":["b920ba0b6285c3aaa7a64d1677f5b4ee58b0779d"],"b920ba0b6285c3aaa7a64d1677f5b4ee58b0779d":["5ff676ea3919c34f30df120b9fa469cd439203ec"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["5ff676ea3919c34f30df120b9fa469cd439203ec","cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85","3cdb369a6112bacd5f5fc1d4e022bed2f8bffb9b"],"pathCommit":null}