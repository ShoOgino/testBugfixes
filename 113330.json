{"path":"lucene/core/src/test/org/apache/lucene/store/TestLockFactory#testDirectoryNoLocking().mjava","commits":[{"id":"d77dafd89756a5161d244985903e3487ca109182","date":1548679743,"type":1,"author":"Dawid Weiss","isMerge":false,"pathNew":"lucene/core/src/test/org/apache/lucene/store/TestLockFactory#testDirectoryNoLocking().mjava","pathOld":"lucene/core/src/test/org/apache/lucene/store/TestLockFactory#testRAMDirectoryNoLocking().mjava","sourceNew":"    // Verify: we can use the NoLockFactory w/ no exceptions raised.\n    // Verify: NoLockFactory allows two IndexWriters\n    public void testDirectoryNoLocking() throws IOException {\n        MockDirectoryWrapper dir = new MockDirectoryWrapper(random(), new ByteBuffersDirectory(NoLockFactory.INSTANCE));\n\n        IndexWriter writer = new IndexWriter(dir, new IndexWriterConfig(new MockAnalyzer(random())));\n        writer.commit(); // required so the second open succeed\n\n        // Create a 2nd IndexWriter.  This is normally not allowed but it should run through since we're not\n        // using any locks:\n        IndexWriter writer2 = null;\n        try {\n            writer2 = new IndexWriter(dir, new IndexWriterConfig(new MockAnalyzer(random())).setOpenMode(OpenMode.APPEND));\n        } catch (Exception e) {\n            e.printStackTrace(System.out);\n            fail(\"Should not have hit an IOException with no locking\");\n        }\n\n        writer.close();\n        if (writer2 != null) {\n            writer2.close();\n        }\n    }\n\n","sourceOld":"    // Verify: we can use the NoLockFactory with RAMDirectory w/ no\n    // exceptions raised:\n    // Verify: NoLockFactory allows two IndexWriters\n    public void testRAMDirectoryNoLocking() throws IOException {\n        MockDirectoryWrapper dir = new MockDirectoryWrapper(random(), new RAMDirectory(NoLockFactory.INSTANCE));\n\n        IndexWriter writer = new IndexWriter(dir, new IndexWriterConfig(new MockAnalyzer(random())));\n        writer.commit(); // required so the second open succeed \n        // Create a 2nd IndexWriter.  This is normally not allowed but it should run through since we're not\n        // using any locks:\n        IndexWriter writer2 = null;\n        try {\n            writer2 = new IndexWriter(dir, new IndexWriterConfig(new MockAnalyzer(random())).setOpenMode(OpenMode.APPEND));\n        } catch (Exception e) {\n            e.printStackTrace(System.out);\n            fail(\"Should not have hit an IOException with no locking\");\n        }\n\n        writer.close();\n        if (writer2 != null) {\n            writer2.close();\n        }\n    }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"d77dafd89756a5161d244985903e3487ca109182":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["d77dafd89756a5161d244985903e3487ca109182"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["d77dafd89756a5161d244985903e3487ca109182"],"d77dafd89756a5161d244985903e3487ca109182":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}