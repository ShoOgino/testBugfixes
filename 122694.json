{"path":"lucene/core/src/java/org/apache/lucene/index/IndexWriter#maybeReopenMergedNRTReader(Map[String,SegmentReader],Map[String,SegmentReader],SegmentInfos,boolean,boolean).mjava","commits":[{"id":"3f354ba79a5a3e8491ec2953f14f365a02c058ac","date":1598293148,"type":0,"author":"Simon Willnauer","isMerge":false,"pathNew":"lucene/core/src/java/org/apache/lucene/index/IndexWriter#maybeReopenMergedNRTReader(Map[String,SegmentReader],Map[String,SegmentReader],SegmentInfos,boolean,boolean).mjava","pathOld":"/dev/null","sourceNew":"  private StandardDirectoryReader maybeReopenMergedNRTReader(Map<String, SegmentReader> mergedReaders,\n                                                             Map<String, SegmentReader> openedReadOnlyClones, SegmentInfos openingSegmentInfos,\n                                                             boolean applyAllDeletes, boolean writeAllDeletes) throws IOException {\n    assert Thread.holdsLock(this);\n    if (mergedReaders.isEmpty() == false) {\n      Collection<String> files = new ArrayList<>();\n      try {\n        return StandardDirectoryReader.open(this,\n            sci -> {\n              // as soon as we remove the reader and return it the StandardDirectoryReader#open\n              // will take care of closing it. We only need to handle the readers that remain in the\n              // mergedReaders map and close them.\n              SegmentReader remove = mergedReaders.remove(sci.info.name);\n              if (remove == null) {\n                remove = openedReadOnlyClones.remove(sci.info.name);\n                assert remove != null;\n                // each of the readers we reuse from the previous reader needs to be incRef'd\n                // since we reuse them but don't have an implicit incRef in the SDR:open call\n                remove.incRef();\n              } else {\n                files.addAll(remove.getSegmentInfo().files());\n              }\n              return remove;\n            }, openingSegmentInfos, applyAllDeletes, writeAllDeletes);\n      } finally {\n        // now the SDR#open call has incRef'd the files so we can let them go\n        deleter.decRef(files);\n      }\n    }\n    return null;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"3f354ba79a5a3e8491ec2953f14f365a02c058ac":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["3f354ba79a5a3e8491ec2953f14f365a02c058ac"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["3f354ba79a5a3e8491ec2953f14f365a02c058ac"],"3f354ba79a5a3e8491ec2953f14f365a02c058ac":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}