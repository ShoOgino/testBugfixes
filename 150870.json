{"path":"solr/core/src/test/org/apache/solr/cloud/RouteFieldTest#compareShardDocs(String,String).mjava","commits":[{"id":"25726728867b518829d762aa00b696cbfa96818c","date":1595801885,"type":0,"author":"Erick Erickson","isMerge":false,"pathNew":"solr/core/src/test/org/apache/solr/cloud/RouteFieldTest#compareShardDocs(String,String).mjava","pathOld":"/dev/null","sourceNew":"  private void compareShardDocs(String urlId, String urlRoute) throws IOException, SolrServerException {\n    ModifiableSolrParams params = new ModifiableSolrParams();\n    QueryRequest request = new QueryRequest(params);\n    params.add(\"distrib\", \"false\");\n    params.add(CommonParams.Q, \"*:*\");\n    params.add(CommonParams.SORT, \"sorter asc\");\n    params.add(CommonParams.ROWS, \"1000\");\n\n    HttpSolrClient httpSC = new HttpSolrClient.Builder(urlId).build();\n    SolrDocumentList docsId = (SolrDocumentList) httpSC.request(request).get(\"response\");\n    httpSC.close();\n\n    httpSC = new HttpSolrClient.Builder(urlRoute).build();\n    SolrDocumentList docsRoute = (SolrDocumentList) httpSC.request(request).get(\"response\");\n    httpSC.close();\n\n    assertEquals(\"We should have the exact same number of docs on each shard\", docsId.getNumFound(), docsRoute.getNumFound());\n    for (int idx = 0; idx < docsId.getNumFound(); ++idx) {\n      int idId = Integer.parseInt((String) docsId.get(idx).getFieldValue(\"id\"));\n      int idRoute = Integer.parseInt((String) docsRoute.get(idx).getFieldValue(\"id\"));\n      assertEquals(\"Docs with Ids 1.5M different should be on exactly the same shard and in the same order when sorted\",\n          idId, idRoute - 1_500_000);\n    }\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"25726728867b518829d762aa00b696cbfa96818c":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["25726728867b518829d762aa00b696cbfa96818c"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["25726728867b518829d762aa00b696cbfa96818c"],"25726728867b518829d762aa00b696cbfa96818c":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}