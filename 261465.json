{"path":"lucene/core/src/java/org/apache/lucene/util/UnicodeUtil#calcUTF16toUTF8Length(CharSequence,int,int).mjava","commits":[{"id":"bfde954cd162c74a48f6b035e596f252c9939a73","date":1442329231,"type":0,"author":"Shalin Shekhar Mangar","isMerge":false,"pathNew":"lucene/core/src/java/org/apache/lucene/util/UnicodeUtil#calcUTF16toUTF8Length(CharSequence,int,int).mjava","pathOld":"/dev/null","sourceNew":"  /**\n   * Calculates the number of UTF8 bytes necessary to write a UTF16 string.\n   *\n   * @return the number of bytes written\n   */\n  public static int calcUTF16toUTF8Length(final CharSequence s, final int offset, final int len) {\n    final int end = offset + len;\n\n    int res = 0;\n    for (int i = offset; i < end; i++) {\n      final int code = (int) s.charAt(i);\n\n      if (code < 0x80)\n        res++;\n      else if (code < 0x800) {\n        res += 2;\n      } else if (code < 0xD800 || code > 0xDFFF) {\n        res += 3;\n      } else {\n        // surrogate pair\n        // confirm valid high surrogate\n        if (code < 0xDC00 && (i < end - 1)) {\n          int utf32 = (int) s.charAt(i + 1);\n          // confirm valid low surrogate and write pair\n          if (utf32 >= 0xDC00 && utf32 <= 0xDFFF) {\n            i++;\n            res += 4;\n            continue;\n          }\n        }\n        res += 3;\n      }\n    }\n\n    return res;\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"bfde954cd162c74a48f6b035e596f252c9939a73":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["bfde954cd162c74a48f6b035e596f252c9939a73"]},"commit2Childs":{"bfde954cd162c74a48f6b035e596f252c9939a73":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["bfde954cd162c74a48f6b035e596f252c9939a73"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}