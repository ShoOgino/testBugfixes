{"path":"lucene/queries/src/test/org/apache/lucene/queries/function/TestFunctionScoreQuery#testAccessToValueSource().mjava","commits":[{"id":"55c2c0f29a6f559546cb20cc79852bbe2fea985b","date":1549359975,"type":0,"author":"Alan Woodward","isMerge":false,"pathNew":"lucene/queries/src/test/org/apache/lucene/queries/function/TestFunctionScoreQuery#testAccessToValueSource().mjava","pathOld":"/dev/null","sourceNew":"  // check access to the score source of a functionScoreQuery\n  public void testAccessToValueSource() throws Exception {\n\n    FunctionScoreQuery q1 = new FunctionScoreQuery(new TermQuery(new Term(TEXT_FIELD, \"a\")), DoubleValuesSource.constant(31));\n    Query q2 = new FunctionScoreQuery(q1.getWrappedQuery(), q1.getSource());\n    QueryUtils.check(q2);\n    QueryUtils.checkEqual(q2, q1);\n\n    FunctionScoreQuery q3 = new FunctionScoreQuery(new TermQuery(new Term(TEXT_FIELD, \"first\")),\n            DoubleValuesSource.fromIntField(INT_FIELD));\n    Query q4 = new FunctionScoreQuery(q3.getWrappedQuery(), q3.getSource());\n    QueryUtils.checkEqual(q3, q4);\n\n    SimpleBindings bindings = new SimpleBindings();\n    bindings.add(\"score\", DoubleValuesSource.SCORES);\n    Expression expr = JavascriptCompiler.compile(\"ln(score + 4)\");\n    FunctionScoreQuery q5 = new FunctionScoreQuery(new TermQuery(new Term(TEXT_FIELD, \"text\")), expr.getDoubleValuesSource(bindings));\n    Query q6 = new FunctionScoreQuery(q5.getWrappedQuery(), q5.getSource());\n    QueryUtils.checkEqual(q5, q6);\n\n\n  }\n\n","sourceOld":null,"bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"55c2c0f29a6f559546cb20cc79852bbe2fea985b":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["55c2c0f29a6f559546cb20cc79852bbe2fea985b"]},"commit2Childs":{"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["55c2c0f29a6f559546cb20cc79852bbe2fea985b"],"55c2c0f29a6f559546cb20cc79852bbe2fea985b":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}