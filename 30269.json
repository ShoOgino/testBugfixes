{"path":"solr/core/src/java/org/apache/solr/store/blockcache/BlockCache#releaseLocation(BlockCacheKey,BlockCacheLocation,RemovalCause).mjava","commits":[{"id":"2aeae9008caa3439c2f8b209183da208994812d1","date":1488562773,"type":1,"author":"yonik","isMerge":false,"pathNew":"solr/core/src/java/org/apache/solr/store/blockcache/BlockCache#releaseLocation(BlockCacheKey,BlockCacheLocation,RemovalCause).mjava","pathOld":"solr/core/src/java/org/apache/solr/store/blockcache/BlockCache#releaseLocation(BlockCacheKey,BlockCacheLocation).mjava","sourceNew":"  private void releaseLocation(BlockCacheKey blockCacheKey, BlockCacheLocation location, RemovalCause removalCause) {\n    if (location == null) {\n      return;\n    }\n    int bankId = location.getBankId();\n    int block = location.getBlock();\n\n    // mark the block removed before we release the lock to allow it to be reused\n    location.setRemoved(true);\n\n    locks[bankId].clear(block);\n    lockCounters[bankId].decrementAndGet();\n    for (OnRelease onRelease : onReleases) {\n      onRelease.release(blockCacheKey);\n    }\n    if (removalCause.wasEvicted()) {\n      metrics.blockCacheEviction.incrementAndGet();\n    }\n    metrics.blockCacheSize.decrementAndGet();\n  }\n\n","sourceOld":"  private void releaseLocation(BlockCacheKey blockCacheKey, BlockCacheLocation location) {\n    if (location == null) {\n      return;\n    }\n    int bankId = location.getBankId();\n    int block = location.getBlock();\n\n    // mark the block removed before we release the lock to allow it to be reused\n    location.setRemoved(true);\n\n    locks[bankId].clear(block);\n    lockCounters[bankId].decrementAndGet();\n    for (OnRelease onRelease : onReleases) {\n      onRelease.release(blockCacheKey);\n    }\n    metrics.blockCacheEviction.incrementAndGet();\n    metrics.blockCacheSize.decrementAndGet();\n  }\n\n","bugFix":null,"bugIntro":[],"isBuggy":false,"nexts":[],"revCommit":null}],"commit2Parents":{"2aeae9008caa3439c2f8b209183da208994812d1":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":[],"cd5edd1f2b162a5cfa08efd17851a07373a96817":["2aeae9008caa3439c2f8b209183da208994812d1"]},"commit2Childs":{"2aeae9008caa3439c2f8b209183da208994812d1":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85":["2aeae9008caa3439c2f8b209183da208994812d1"],"cd5edd1f2b162a5cfa08efd17851a07373a96817":[]},"heads":["cd5edd1f2b162a5cfa08efd17851a07373a96817"],"roots":["a0e7ee9d0d12370e8d2b5ae0a23b6e687e018d85"],"pathCommit":null}